<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>AWS EC2实例迁移</title>
      <link href="/AWSEC2.html"/>
      <url>/AWSEC2.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h3 id="选择区域"><a href="#选择区域" class="headerlink" title="选择区域"></a>选择区域</h3><ol><li>打开<a href="https://aws.amazon.com/cn/">AWS官网</a>，点击右上角的<b>登录控制台</b> <!-- ss202207 --></li><li>登录成功点击右上角-Account进入到账号主页</li><li>向下滑动到<b>AWS 区域</b>部分，确认目标区域状态已开启</li><li>点击页面左上角的<b>Services</b>，选择<b>计算</b>-<b>EC2</b></li><li>点击右上角的“地区名”切换服务器地区</li></ol><h3 id="创建EC2实例"><a href="#创建EC2实例" class="headerlink" title="创建EC2实例"></a>创建EC2实例</h3><h3 id="Windows-Server-2012-R2"><a href="#Windows-Server-2012-R2" class="headerlink" title="Windows Server 2012 R2"></a>Windows Server 2012 R2</h3><p>创建实例:</p><ol><li>按照以上操作选择好EC2的区域，例如：Services-计算-EC2，右上角地区选择香港</li><li>点击左侧菜单的<b>实例</b>-<b>实例</b></li><li>点击右上角的<b>启动新实例</b></li><li>快速启动中选择<b>Windows - Microsoft Windows Server 2012 R2 Base</b>，</li><li>确认有明显的<b>“支持免费套餐”</b>字样后并点击右侧的<b>启动实例</b></li><li>创建密钥对，选择创建新密钥对并输入名称，模式使用默认的.pem，然后点击<b>创建密钥对</b>自动下载（获取Administer密码时需要）</li><li>最后再次点击<b>启动实例</b></li></ol><p>调整安全组：</p><ol><li>Services-计算-EC2，右上角地区选择香港</li><li>点击左边菜单<b>实例-实例</b>，并点击实例ID，如: i-01ab02cd03ef04gh</li><li>实例摘要中切换至<b>安全</b>标签，并点击安全组ID，如：sg-00cd03ef04gh(launch-xxxx-x)</li><li>安全组详细信息页面点击<b>入站规则-编辑入站规则</b></li><li>添加规则：<table><thead><tr><th align="left">类型</th><th align="center">协议</th><th align="right">端口范围</th><th align="right">源</th></tr></thead><tbody><tr><td align="left">RDP</td><td align="center">TCP</td><td align="right">3389</td><td align="right">0.0.0.0/0</td></tr><tr><td align="left">HTTPS</td><td align="center">TCP</td><td align="right">443</td><td align="right">0.0.0.0/0</td></tr><tr><td align="left">自定义TCP</td><td align="center">TCP</td><td align="right">80</td><td align="right">0.0.0.0/0</td></tr><tr><td align="left">自定义TCP</td><td align="center">TCP</td><td align="right">6612</td><td align="right">0.0.0.0/0</td></tr><tr><td align="left">自定义TCP</td><td align="center">TCP</td><td align="right">8000</td><td align="right">0.0.0.0/0</td></tr><tr><td align="left">自定义TCP</td><td align="center">TCP</td><td align="right">8191</td><td align="right">0.0.0.0/0</td></tr><tr><td align="left">自定义TCP</td><td align="center">TCP</td><td align="right">8192</td><td align="right">0.0.0.0/0</td></tr><tr><td align="left">自定义TCP</td><td align="center">TCP</td><td align="right">8388</td><td align="right">0.0.0.0/0</td></tr><tr><td align="left">自定义TCP</td><td align="center">TCP</td><td align="right">9000</td><td align="right">0.0.0.0/0</td></tr></tbody></table></li></ol><span id="more"></span><p>远程桌面连接：</p><blockquote><p>MacOS下载<a href="https://apps.apple.com/cn/app/parallels-client/id600925318?mt=12">Parallels Client</a></p></blockquote><ol><li>Services-计算-EC2，右上角地区选择香港</li><li>点击左边菜单<b>实例-实例</b>，并点击实例ID，如: i-01ab02cd03ef04gh</li><li>点击右上角的<b>连接</b></li><li>切换至 <b>RDP 客户端</b>，并点击下面的<b>获取密码</b>，操作浏览密钥对（创建实例时下载的.pem文件）获取Windows密码</li><li>打开软件Parallels Client，新建连接-改为创建RDP连接：<ul><li>服务器：Public DNS <!-- ec2-18-166-176-42.ap-east-1.compute.amazonaws.com --></li><li>密码：查询后的密码 <!--*mz25r5%49% --></li></ul></li></ol><p>服务器设置：</p><ol><li><p>设置IE浏览器</p><ul><li>信任站点：设置 - Internet options - Security - Trusted sites - Sites - Add</li><li>下载文件：设置 - Internet options - Security - Internet - Custom Level - Downloads - File download</li></ul></li><li><p>阿里云盘下载Nginx、MySQL、PHP，安装至<code>C:\Program Files</code>，并设置环境变量</p></li><li><p>设置防火墙(添加安全组对应的端口号)：</p><ol><li>打开防火墙界面：Windows - Control Panel - System and Security - Windows Firewall</li><li>进入设置访问端口界面：Advanced settings - Inbound Rules - New Rule…</li><li>设置入站端口：Port - TCP &amp; Specific local ports: <code>80,443,8000,6612,8000,8191,8192,8388,9000</code> - Allow the connection - 勾选Domain、Private、Public - 输入名称和描述 - Finish</li></ol></li><li><p>安装数据库（MySQL）</p><ol><li>安装<code>mysql-5.5.62-winx64</code></li><li>配置向导，选择<code>Detailed Configuration</code> - <code>Server Machine</code> - <code>Multifuncational Database</code> - <code>Next</code> - <code>Decision Support(DSS)/OLAP</code> - <code>调整端口号</code> - <code>Standard Character Set</code> - <code>设置root密码</code> - <code>Excute</code> - <code>Finish</code></li><li>安装<code>mysql-workbench-community-8.0.28-winx64</code></li></ol></li><li><p>部署应用程序</p></li><li><p>安装SSServer</p><ol><li><p>下载<a href="https://nodejs.org/en">NodeJS</a>并安装</p></li><li><p>执行<code>npm install -g shadowsocks</code>安装SSServer</p></li><li><p>更新<code>C:\Users\USERNAME\AppData\Roaming\np m\node_modules\shadowsocks\config.json</code></p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;server&quot;:&quot;0.0.0.0&quot;,</span><br><span class="line">    &quot;server_port&quot;:8388,</span><br><span class="line">    &quot;local_address&quot;:&quot;127.0.0.1&quot;,</span><br><span class="line">    &quot;local_port&quot;:1080,</span><br><span class="line">    &quot;password&quot;:&quot;Ss@8388&quot;,</span><br><span class="line">    &quot;timeout&quot;:600,</span><br><span class="line">    &quot;method&quot;:&quot;aes-256-cfb&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>EC2安全组和防火墙添加端口号</p></li><li><p>执行<code>ssserver</code>运行服务</p></li></ol></li></ol>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>检查断网重启Mac</title>
      <link href="/RebootWithoutNet.html"/>
      <url>/RebootWithoutNet.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>用Python脚本来检查Mac联网状态，在达到条件后重启Mac</p></blockquote><h2 id="Python-脚本"><a href="#Python-脚本" class="headerlink" title="Python 脚本"></a>Python 脚本</h2><pre><code># -*- coding: utf-8 -*-import osimport asyncioimport timefrom enum import Enum# 策略enum：1-重启电脑 2-启动网卡class RunActionType(Enum):    reboot = 1    restart_net = 2    # root密码root_pwd = &#39;&#39;# 策略run_action_type = RunActionType.restart_net.value# 退出循环标记allow_loop = True# 时间间隔tiem_sleep_interval = 3# 失败次数failed_count = 0# 失败最大次数failed_max_count = 2# 终端命令command_reboot = &#39;echo %s | sudo -S reboot&#39; % root_pwdcommand_network_down = &#39;echo %s | sudo -S ifconfig en0 down&#39; % root_pwdcommand_network_up = &#39;echo %s | sudo -S ifconfig en0 up&#39; % root_pwd# 检查网络状态async def loop_ping():    global allow_loop, failed_count        while allow_loop:        result = os.system(&#39;curl baidu.com&#39;)        if result:            failed_count += 1            print(result)        else:            failed_count = 0                    if failed_count &gt;= failed_max_count:            allow_loop = False            failed_count = 0            run_action()        else:            time.sleep(tiem_sleep_interval)        # 策略def run_action():    if run_action_type == RunActionType.reboot.value:        reboot_action()    elif run_action_type == RunActionType.restart_net.value:        restart_net_action()# 启动电脑def reboot_action():    print(&quot;启动电脑&quot;)    os.system(command_reboot)    # 启动网卡def restart_net_action():    print(&quot;重启网卡&quot;)    os.system(command_network_down)    time.sleep(5)    os.system(command_network_up)    print(&quot;网卡重启结束&quot;)if __name__ == &#39;__main__&#39;:    print(&quot;开始监听网络连接&quot;)    loop = asyncio.get_event_loop()    loop.run_until_complete(loop_ping())</code></pre><h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><ol><li>将整个文件夹放到当前用户目录下，即<code>cd ~</code>目录下</li><li>制作启动程序，参考链接<a href="https://jingyan.baidu.com/article/9c69d48fe7a2c913c9024eb6.html">https://jingyan.baidu.com/article/9c69d48fe7a2c913c9024eb6.html</a> <ol><li>打开    <code>自动操作.app</code>-&gt;新建文稿-&gt;应用程序-&gt;选取，或者文件-&gt;新建-&gt;应用程序-&gt;选取</li><li>搜索<code>shell</code>,将<code>运行Shell脚本</code>拖动到右边的</li><li>运行Shell脚本的Shell路径选择<code>/bin/bash</code></li><li>内容输入 <code>pythonBinPath pyFilePath</code>，例如：<code>/usr/bin/python3 ~/Script/reboot.py</code><ul><li>pythonBinPath：python命令路径，终端执行<code>which python</code>查看</li><li>pyFilePath：python脚本路径</li></ul></li><li>执行文件-&gt;存储保存应用程序</li></ol></li><li>添加启动项<ol><li>打开系统偏好设置-&gt;用户与群组</li><li>选择当前用户-&gt;登录项-&gt; + ，选择制作的启动程序</li></ol></li><li>配置参数<ol><li>打开<code>reboot.py</code></li><li>修改<code>root_pwd</code></li><li>修改<code>run_action_type</code></li><li>修改其它参数</li></ol></li><li>双击制作的启动程序，启动成功后会在Mac上的菜单栏中显示图标（旋转的⚙️）</li></ol>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记录对MVC的理解</title>
      <link href="/CocoaMVC.html"/>
      <url>/CocoaMVC.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>Apple官方文档<a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/CocoaEncyclopedia/Model-View-Controller/Model-View-Controller.html">Model-View-Controller</a></p><p>Apple官方Demo<a href="https://developer.apple.com/library/archive/samplecode/MVCNetworking/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010443">MVCNetworking</a></p></blockquote><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>MVC即Model-View-Controller，是一个复合设计模式，由于一些基本的设计模式组成，这些基本模式一直工作，定义功能分离和通信路径，将整体分为了三个角色Model、View、Controller各司其职</p><ul><li>Model：数据模型，并具有基本行为能力，例如数据解析<!-- 即数据请求、数据解析、数据持久化，是数据的提供者和管理者--></li><li>View：视图，用于展示和编辑Model中的数据</li><li>Controller：控制器，将Model绑定到View<!-- 并处理View的事件、控制View刷新、控制Model修改--></li></ul><p>组合角色，例如<em>Model Controller</em>、<em>View Controller</em></p><ul><li>Model Controller：模型控制器，主要关注Model层控制，“拥有”该Model，主要职责是管理Model并与View通信，例如<code>NSDocument</code>自动处理与保存文件相关的操作</li><li>View Controller：视图控制器，主要关注View层的控制，”拥有”该View，主要职责是管理界面并与Model通信，实现根据Model显示View的相关处理，例如<code>NSWindowController</code></li></ul><h3 id="传统的MVC"><a href="#传统的MVC" class="headerlink" title="传统的MVC"></a>传统的MVC</h3><p>在最初的概念（Smalltalk）中，由于组合模式、策略模式和观察者模式组成，View与Model有通信</p><ul><li>组合模式：View实际上是一组嵌套View的组合，按照设定的层次结构显示，这些View可以是组合视图（UITableView）也可以是单个视图（UIButton），任意View都可以被用户编辑和显示</li><li> 策略模式：Controller为一个或多个View实现策略，View只管展示（视角方面），并委托Controller去决策所有View特定的接口行为，例如<em>Controller</em>通过<em>UITableView</em>的<em>data source</em>和<em>delegate</em>来控制数据及处理响应事件</li><li> 观察者模式：View观察Model的状态变化，收到通知后更新外观</li></ul><p>用户在<strong>View</strong>上操作生成事件，<strong>Controller</strong>接收事件并根据策略处理事件，这个策略可以是更新<strong>Model</strong>或者更新<strong>View</strong>，当<strong>Model</strong>状态变化时通知<strong>View</strong>更新外观</p><p><img src="https://developer.apple.com/library/archive/documentation/General/Conceptual/CocoaEncyclopedia/Art/traditional_mvc.gif" alt="Traditional version of MVC as a compound pattern"></p><span id="more"></span><h3 id="Cocoa-MVC-vs-传统MVC"><a href="#Cocoa-MVC-vs-传统MVC" class="headerlink" title="Cocoa MVC vs 传统MVC"></a>Cocoa MVC vs 传统MVC</h3><p>Cocoa MVC与传统MVC有一些相似之处，不同于Controller观察Model而不是View，分离了View与Model之间的通信，增强了它们的可重用性。</p><ul><li>Model：状态变化通知Controller传到View</li><li>View：在原有的<strong>组合模式</strong>基础上增加了<strong>命令模式</strong></li><li>Controller：在原有的<strong>策略模式</strong>基础上增加了<strong>中介者模式</strong>，在Model与View之间双向协调数据流</li></ul><p><img src="https://developer.apple.com/library/archive/documentation/General/Conceptual/CocoaEncyclopedia/Art/cocoa_mvc.gif" alt="Cocoa version of MVC as a compound design pattern"></p><h3 id="nib中的Cocoa-MVC"><a href="#nib中的Cocoa-MVC" class="headerlink" title="nib中的Cocoa MVC"></a>nib中的Cocoa MVC</h3><p>使用 Cocoa MVC设计一个良好的应用程序，协调控制器通常具有中介控制器，这些控制器存档在nib文件，如图所示：</p><p><img src="https://developer.apple.com/library/archive/documentation/General/Conceptual/CocoaEncyclopedia/Art/cocoa_mvc_coord.gif" alt="Coordinating controller as the owner of a nib file"></p><h3 id="MIT-描述的-Cocoa-MVC"><a href="#MIT-描述的-Cocoa-MVC" class="headerlink" title="MIT 描述的 Cocoa MVC"></a>MIT 描述的 Cocoa MVC</h3><p>Apple将组合模式分为了3个角色，即<strong>Model</strong>、<strong>View</strong>、<strong>Controller</strong></p><p><strong>Controller</strong>拥有<strong>Movel</strong>和<strong>View</strong></p><ul><li>数据绑定：直接绑定（set）或通过<code>data source</code>来绑定（UITableView）</li><li>事件绑定：通过<code>Target-Action</code>、<code>delegate</code>来绑定（UITableView）、KVO</li></ul><p>用户编辑<strong>View</strong>时<strong>Controller</strong>更新<strong>View</strong>或者<strong>Model</strong></p><p><strong>Model</strong>状态变化时通知<strong>Controller</strong></p><p><img src="../images/CocoaMVC.JPG" alt="MIT"></p>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Xcode新建低目标版本项目</title>
      <link href="/CreatLowDeploymentInXcode.html"/>
      <url>/CreatLowDeploymentInXcode.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>记录使用Xcode 13新建项目，Deployment iOS 13以下无法运行的处理方案</p></blockquote><p>删除 Scene 相关</p><ol><li>SceneDelegate.swift、SceneDelegate.h/SceneDelegate.m</li><li><code>AppDelegate.swift</code>/<code>AppDelegate.m</code>中的<code>configurationForConnecting</code>和<code>didDiscardSceneSessions</code>方法</li><li>Info.plist中删除 <code>Application Scene Manifest</code></li></ol>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Appium搭建笔记</title>
      <link href="/AppiumNotes.html"/>
      <url>/AppiumNotes.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>官方网址：<a href="http://appium.io/">http://appium.io</a></p><p>参考文章：</p><p><a href="https://juejin.cn/post/7011778694511329310">iOS自动化测试之Appium的安装和使用</a><br><a href="https://appium.io/docs/cn/drivers/ios-xcuitest-real-devices">Appium XCUITest 驱动在真机上的设置</a><br><a href="https://www.cnblogs.com/kaola8023/p/12487366.html">Appium 遇到 Unable to launch WebDriverAgent because of xcodebuild failure: xcodebuild failed with code 65 的解决方法</a></p></blockquote><h3 id="安装-Appium-Server"><a href="#安装-Appium-Server" class="headerlink" title="安装 Appium Server"></a>安装 Appium Server</h3><ol><li>打开链接 <a href="https://github.com/appium/appium-desktop/releases">https://github.com/appium/appium-desktop/releases</a> 下载最新版本 Appium-Server-GUI-mac-x.xx.x.dmg</li><li>下载之后终端执行 <code>xattr -cr Appium-Server-GUI-mac-x.xx.x.dmg</code> 来处理无效文件问题</li><li>打开 Appium-Server-GUI-mac-x.xx.x.dmg 之后将内容拖动至 Applications中</li><li>最后执行 <code>codesign --deep --sign - /Applications/Appium\ Server\ GUI.app</code> 来处理签名导致的js问题</li></ol><h3 id="安装-Appium-Client"><a href="#安装-Appium-Client" class="headerlink" title="安装 Appium Client"></a>安装 Appium Client</h3><ol><li>打开链接 <a href="https://github.com/appium/appium-inspector/releases">https://github.com/appium/appium-inspector/releases</a> 下载最新版本 Appium-Inspector-mac-xxxx.x.x.dmg</li><li>下载之后终端执行 <code>xattr -cr Appium-Inspector-mac-xxxx.x.x.dmg</code> 来处理无效文件问题</li><li>打开 Appium-Server-GUI-mac-x.xx.x.dmg 之后将内容拖动至 Applications中</li></ol><span id="more"></span><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><ul><li>brew：<code>/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot;</code></li><li>libimobiledevice：<code>brew install libimobiledevice</code></li><li>Carthage：<code>brew install carthage</code></li><li>iOS-deploy：<code>brew install ios-deploy</code> 或者 <code>npm install -g ios-deploy</code></li></ul><h3 id="编译WebDriverAgent"><a href="#编译WebDriverAgent" class="headerlink" title="编译WebDriverAgent"></a>编译WebDriverAgent</h3><ol><li>按照链接 <a href="https://www.cnblogs.com/kaola8023/p/12487366.html">https://www.cnblogs.com/kaola8023/p/12487366.html</a> 中操作</li><li>配置好后 Target 选择 IntegrationApp，执行 Product - Run 到设备</li><li>Target 选择 WebDriverAgentRunner，执行 Product - Test 到设备</li></ol><h3 id="启动服务端-Appium-Server-GUI"><a href="#启动服务端-Appium-Server-GUI" class="headerlink" title="启动服务端 Appium Server GUI"></a>启动服务端 Appium Server GUI</h3><p>打开Appium Server GUI，简单，点击启动服务器</p><h3 id="启动客户端-Appium-Inspector"><a href="#启动客户端-Appium-Inspector" class="headerlink" title="启动客户端 Appium Inspector"></a>启动客户端 Appium Inspector</h3><p>打开Appium Server GUI，配置如下</p><ul><li><p>Appium Server</p><ul><li>远程主机：同Appium Server GUI</li><li>远程端口：同Appium Server GUI</li><li>远程路径：/wd/hub</li><li>SSL：默认</li><li>高级设置：默认</li></ul></li><li><p>所需能力</p><ul><li>platformName：平台名称，文本<code>iOS</code></li><li>appium:platformVersion：设备系统版本号，文本<code>14.4</code></li><li>appium:deviceName：设备名称，文本<code>iPhone Xs Max</code></li><li>appium:udid：设备UDID，文本<code>xxxx-xxxxx</code></li><li>appium:bundleid：WebDriverAgent项目的Bundle id，文本<code>com.xxx.IntegrationApp</code></li><li>appium:xcodeOrgId：证书Team ID，文本<code>XXXXX</code></li><li>appium:xcodeSigningId：签名ID，文本<code>iPhone Developer</code></li></ul>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;platformName&quot;: &quot;iOS&quot;,</span><br><span class="line">  &quot;appium:platformVersion&quot;: &quot;14.4&quot;,</span><br><span class="line">  &quot;appium:deviceName&quot;: &quot;iPhone Xs Max&quot;,</span><br><span class="line">  &quot;appium:udid&quot;: &quot;xxxx-xxxxx&quot;,</span><br><span class="line">  &quot;appium:bundleid&quot;: &quot;com.xxx.IntegrationApp&quot;,</span><br><span class="line">  &quot;appium:xcodeOrgId&quot;: &quot;XXXXX&quot;,</span><br><span class="line">  &quot;appium:xcodeSigningId&quot;: &quot;iPhone Developer&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>另存为…，将<code>所需能力</code>的设置存在<code>保存能力设置</code>中，可以快速切换设备</p></li><li><p>启动会话，开始使用操作，需要先启动服务端</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Xcode Code Snippets 分析</title>
      <link href="/XcodeCodeSnippets.html"/>
      <url>/XcodeCodeSnippets.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p> 源于 <a href="https://github.com/tencentyun/qcloud-sdk-ios">qcloud-sdk-ios</a> 上的代码块描述，应用实例 <a href="https://github.com/HertzWang/FastCode">Fast Code</a></p><h2 id="文件内容"><a href="#文件内容" class="headerlink" title="文件内容"></a>文件内容</h2><p>.codesnippet结尾的xml文件，存放在<code>~/Library/Developer/Xcode/UserData/CodeSnippets</code>文件夹，完整示例如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span><br><span class="line">&lt;plist version=&quot;1.0&quot;&gt;</span><br><span class="line">&lt;dict&gt;</span><br><span class="line">&lt;key&gt;IDECodeSnippetCompletionPrefix&lt;/key&gt;</span><br><span class="line">&lt;string&gt;代码块前缀&lt;/string&gt;</span><br><span class="line">&lt;key&gt;IDECodeSnippetCompletionScopes&lt;/key&gt;</span><br><span class="line">&lt;array&gt;</span><br><span class="line">&lt;string&gt;代码块作用域&lt;/string&gt;</span><br><span class="line">&lt;/array&gt;</span><br><span class="line">&lt;key&gt;IDECodeSnippetContents&lt;/key&gt;</span><br><span class="line">&lt;string&gt;代码块内容&lt;/string&gt;</span><br><span class="line">&lt;key&gt;IDECodeSnippetIdentifier&lt;/key&gt;</span><br><span class="line">&lt;string&gt;代码块唯一标识符&lt;/string&gt;</span><br><span class="line">&lt;key&gt;IDECodeSnippetLanguage&lt;/key&gt;</span><br><span class="line">&lt;string&gt;Xcode.SourceCodeLanguage.Objective-C&lt;/string&gt;</span><br><span class="line">&lt;key&gt;IDECodeSnippetSummary&lt;/key&gt;</span><br><span class="line">&lt;string&gt;代码块概要&lt;/string&gt;</span><br><span class="line">&lt;key&gt;IDECodeSnippetTitle&lt;/key&gt;</span><br><span class="line">&lt;string&gt;代码块标题&lt;/string&gt;</span><br><span class="line">&lt;key&gt;IDECodeSnippetUserSnippet&lt;/key&gt;</span><br><span class="line">&lt;true/&gt;</span><br><span class="line">&lt;key&gt;IDECodeSnippetVersion&lt;/key&gt;</span><br><span class="line">&lt;integer&gt;2&lt;/integer&gt;</span><br><span class="line">&lt;/dict&gt;</span><br><span class="line">&lt;/plist&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>Xcode中可修改条目有七项，分别是Title、Summary、Content、Language、Platform、Completion和Availability，下载后文件与Xcode生成的文件做对比差异如下：</p><ol><li>代码块前缀 IDECodeSnippetCompletionPrefix 对应的 string</li><li>代码块作用域 IDECodeSnippetCompletionScopes 对应的 array<string>，目前已知有 All、CodeBlock</li><li>代码块内容 IDECodeSnippetContents 对应的 string，其中填充部份以 &lt;#  开头并以 #&gt; 结尾，Xcode中是 &lt;#填充部分#&gt;</li><li>代码块唯一标识符 IDECodeSnippetIdentifier 对应的 string，格式为 8位-4位-4位-4位-12位 的16进制，如：FF167DB4-0C2D-4F6D-9A2B-0C0785239FFB</li><li>代码块概要 IDECodeSnippetSummary 对应的string，无内容可为空字符串</li><li>代码块标题 IDECodeSnippetTitle 对应的 string</li></ol><span id="more"></span><h3 id="代码块作用域"><a href="#代码块作用域" class="headerlink" title="代码块作用域"></a>代码块作用域</h3><p>由于 <code>IDECodeSnippetCompletionScopes</code> 的值是 Array，所以可以设置多个，但要注意是 <code>All</code> 或多个</p><table><thead><tr><th>Availability</th><th>Code</th></tr></thead><tbody><tr><td>All Scopes</td><td>All</td></tr><tr><td>Class Implementation</td><td>ClassImplementation</td></tr><tr><td>Class Interface Methods</td><td>ClassInterfaceMethods</td></tr><tr><td>Class Interface Variables</td><td>ClassInterfaceVariables</td></tr><tr><td>Code Expression</td><td>CodeExpression</td></tr><tr><td>Function or Method</td><td>CodeBlock</td></tr><tr><td>Preprocessor Directive</td><td>Preprocessor</td></tr><tr><td>String or Comment</td><td>StringOrComment</td></tr><tr><td>Top Level</td><td>TopLevel</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Xcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS应用添加到主屏幕(支持iOS 14)</title>
      <link href="/AddToHomeScreen.html"/>
      <url>/AddToHomeScreen.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>前言：用<code>Safari</code>的访问一个网址，然后将网址添加到主屏幕，这时会在主屏幕上生成一个书签（带有Icon和标题），点击该书签后会访问指定的网址，在指定的网址中使用“scheme://”的方式打开应用，关于iOS 14上的使用参考底部的<b>iOS 14 示例</b></p></blockquote><h2 id="使用远程Web"><a href="#使用远程Web" class="headerlink" title="使用远程Web"></a>使用远程Web</h2><p>使用<code>Safari</code>打开链接并添加到主屏幕从而得到桌面快捷方式，通过<code>window.navigator.standalone</code>来区分状态，在<code>Safari</code>中加载时显示引导信息，独立全屏运行（点击主屏幕的快捷图标）时使用<code>scheme</code>来打开App，例如:<code>scheme://modules?id=1</code></p><h3 id="HTML示例代码："><a href="#HTML示例代码：" class="headerlink" title="HTML示例代码："></a>HTML示例代码：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot; &gt;</span><br><span class="line">&lt;meta name=&quot;apple-mobile-web-app-status-bar-style&quot; content=&quot;black&quot;&gt;</span><br><span class="line">&lt;meta content=&quot;text/html charset=UTF-8&quot; http-equiv=&quot;Content-Type&quot;/&gt;</span><br><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1.0,user-scalable=no&quot;/&gt;</span><br><span class="line">&lt;link rel=&#x27;apple-touch-icon&#x27; href=&#x27;https://xxx.png&#x27;&gt;</span><br><span class="line">&lt;title&gt;主屏幕显示的名称&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;a id=&quot;startApp&quot; style=&quot;display:none&quot;&gt;&lt;/a&gt;</span><br><span class="line">&lt;div id=&quot;msg&quot;&gt;</span><br><span class="line">&lt;div class=&quot;main&quot;&gt;</span><br><span class="line">&lt;div&gt;点击下方工具栏上\n并点击添加到主屏幕&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var url = location.search; // 获取url中&quot;?&quot;符后的字串</span><br><span class="line">if (window.navigator.standalone ==  true) &#123;</span><br><span class="line">document.getElementById(&quot;msg&quot;).innerHTML= &#x27;&#x27;;</span><br><span class="line">document.getElementById(&quot;startApp&quot;).href = url.substring(1);</span><br><span class="line">document.getElementById(&quot;startApp&quot;).click();</span><br><span class="line">&#125; </span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.main &#123;</span><br><span class="line">color: #333;</span><br><span class="line">text-align: center;</span><br><span class="line">width: auto;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><ul><li><code>apple-mobile-web-app-capable</code> ：仅支持Safari浏览器，以独立进程运行时全屏显示（Safari中输入网址打开链接称之为浏览器内打开，添加到主屏幕后，在主屏幕中点击生成的书签运行称之为独立进程运行）</li><li><code>apple-mobile-web-app-status-bar-style</code> ：仅支持Safari浏览器，设置状态栏颜色，apple-mobile-web-app-capable为YES时且独立进程运行时生效</li><li><code>apple-touch-icon</code>：书签图标</li><li><code>title</code>：标签内容为书签的名称</li><li><code>window.navigator.standalone</code>：独立进行状态</li></ul><p>参考：</p><p><a href="https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html#//apple_ref/doc/uid/TP40008193-SW1">Safari Supported Meta Tags</a></p><span id="more"></span><h3 id="iOS示例代码"><a href="#iOS示例代码" class="headerlink" title="iOS示例代码"></a>iOS示例代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NSString *scheme = [NSString stringWithFormat:@&quot;scheme://modules?id=%@&quot;, xxx]; // 组装Scheme</span><br><span class="line">NSString *urlString = [NSString stringWithFormat:@&quot;http://domainName:port/index.html?%@&quot;, scheme]; // 完整html路径</span><br><span class="line">NSURL *url = [NSURL URLWithString:urlString];</span><br><span class="line">[[UIApplication sharedApplication] openURL:url]; // 使用Safari打开网址</span><br></pre></td></tr></table></figure><h2 id="使用本地Web"><a href="#使用本地Web" class="headerlink" title="使用本地Web"></a>使用本地Web</h2><p>不支持iOS 14，在iOS 14以下可以使用开启本地服务的方式来实现，其原理为本地开启HTTP Server服务后打开网页，然后重定向到<code>data:text/html</code>，添加到主屏幕的其实就是 <strong>数据形式的HTML</strong> ，这种数据形式可以独立运行不依赖服务，从而实现完全本地打开应用。</p><h3 id="本地HTTP-Server"><a href="#本地HTTP-Server" class="headerlink" title="本地HTTP Server"></a>本地HTTP Server</h3><p>使用第三方库 <code>CocoaHTTPServer</code> 或 <code>GCDWebServer</code> 来开启本地HTTP Server</p><h3 id="网页部分"><a href="#网页部分" class="headerlink" title="网页部分"></a>网页部分</h3><p>使用两个网页模板 <code>Index.html</code> 和 <code>Content.html</code>，先替换 <code>Content.html</code> 中的 <code>%ShortcutIcon%</code> 和 <code>%ShortcutName%</code>，再替换 <code>Index.html</code> 中的 <code>%Content%</code></p><p>Index.html</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;</span><br><span class="line">        &lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;URL= data:text/html;charset=utf-8,%Content%&quot;&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>Content.html</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot;&gt;</span><br><span class="line">        &lt;meta name=&quot;apple-mobile-web-app-status-bar-style&quot; content=&quot;black&quot;&gt;</span><br><span class="line">        &lt;meta content=&quot;text/html charset=UTF-8&quot; http-equiv=&quot;Content-Type&quot; /&gt;</span><br><span class="line">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1.0,user-scalable=no&quot; /&gt;</span><br><span class="line">        &lt;link rel=&#x27;apple-touch-icon&#x27; href=&#x27;%ShortcutIcon%&#x27;&gt;&lt;!-- base64的图片 --&gt;</span><br><span class="line">        &lt;title&gt;%ShortcutName%&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;a href=&quot;%AppScheme%&quot; id=&quot;startApp&quot; style=&quot;display:none&quot;&gt;&lt;/a&gt;</span><br><span class="line">        &lt;div id=&quot;msg&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;main&quot;&gt;</span><br><span class="line">                &lt;div&gt;点击下方工具栏上\n并点击添加到主屏幕&lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        if (window.navigator.standalone == true) &#123;</span><br><span class="line">            document.getElementById(&quot;msg&quot;).innerHTML= &#x27;&#x27;;</span><br><span class="line">            var lnk = document.getElementById(&quot;startApp&quot;).click();</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .main &#123;</span><br><span class="line">            color: #333;</span><br><span class="line">            text-align: center;</span><br><span class="line">            width: auto;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h3 id="iOS-部分"><a href="#iOS-部分" class="headerlink" title="iOS 部分"></a>iOS 部分</h3><p>启动 HTTP Server，访问 <code>http://localhost:port/export.html</code></p><h2 id="iOS-14-示例"><a href="#iOS-14-示例" class="headerlink" title="iOS 14 示例"></a>iOS 14 示例</h2><ol><li><p>依赖三方库<code>GCDWebServer</code></p></li><li><p>新建<code>AddToHomeScreenContent.html</code>，代码如下：</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot;&gt;</span><br><span class="line">        &lt;meta name=&quot;apple-mobile-web-app-status-bar-style&quot; content=&quot;black&quot;&gt;</span><br><span class="line">        &lt;meta content=&quot;text/html charset=UTF-8&quot; http-equiv=&quot;Content-Type&quot; /&gt;</span><br><span class="line">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1.0,user-scalable=no&quot; /&gt;</span><br><span class="line">        &lt;link rel=&#x27;apple-touch-icon&#x27; href=&#x27;%ShortcutIcon%&#x27;&gt;&lt;!-- base64的图片 --&gt;</span><br><span class="line">        &lt;title&gt;%ShortcutName%&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;a href=&quot;%AppScheme%&quot; id=&quot;startApp&quot; style=&quot;display:none&quot;&gt;&lt;/a&gt;</span><br><span class="line">        &lt;div id=&quot;msg&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;main&quot;&gt;</span><br><span class="line">                &lt;div&gt;点击下方工具栏上的&lt;/div&gt;</span><br><span class="line">                &lt;div&gt;并点击添加到主屏幕&lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;img class=&quot;tips&quot; src=&quot;%TipsImage%&quot;/&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        if (window.navigator.standalone == true) &#123;</span><br><span class="line">            document.getElementById(&quot;msg&quot;).innerHTML= &#x27;&#x27;;</span><br><span class="line">            var lnk = document.getElementById(&quot;startApp&quot;).click();</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .main &#123;</span><br><span class="line">            color: #333;</span><br><span class="line">            text-align: center;</span><br><span class="line">            width: auto;</span><br><span class="line">        &#125;</span><br><span class="line">        .tips &#123;</span><br><span class="line">            width: %TipsImageWidth%;</span><br><span class="line">            position: absolute;</span><br><span class="line">            left: %TipsImageLeft%;</span><br><span class="line">            bottom: 10px;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>新建<code>HttpServerUtil : NSObject</code></p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@interface HttpServerUtil : NSObject</span><br><span class="line"></span><br><span class="line">+ (instancetype)shared;</span><br><span class="line"></span><br><span class="line">/// 添加到主屏幕</span><br><span class="line">/// @param image 桌面图标，为nil时使用应用Icon</span><br><span class="line">/// @param name 桌面显示的名称</span><br><span class="line">/// @param scheme 当前应用scheme</span><br><span class="line">+ (void)openSafariWithIcon:(UIImage * _Nullable)image name:(NSString *)name scheme:(NSString *)scheme;</span><br><span class="line"></span><br><span class="line">- (void)start;</span><br><span class="line">- (void)stop;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br></pre></td></tr></table></figure> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;HttpServerUtil.h&quot;</span><br><span class="line">#import &lt;GCDWebServer.h&gt;</span><br><span class="line">#import &lt;GCDWebServerDataResponse.h&gt;</span><br><span class="line"></span><br><span class="line">@interface HttpServerUtil ()</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong) GCDWebServer *webServer;</span><br><span class="line">@property (nonatomic, strong) NSString *base64ImageString;</span><br><span class="line">@property (nonatomic, strong) NSString *appName;</span><br><span class="line">@property (nonatomic, strong) NSString *appScheme;</span><br><span class="line">@property (nonatomic, strong) UIImage *appIconImage;</span><br><span class="line">@property (nonatomic, strong) NSURL *httpServerURL;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation HttpServerUtil</span><br><span class="line"></span><br><span class="line">#pragma mark - Override</span><br><span class="line"></span><br><span class="line">- (instancetype)init</span><br><span class="line">&#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        __weak typeof(self) weak_self = self;</span><br><span class="line">        [self.webServer addDefaultHandlerForMethod:@&quot;GET&quot;</span><br><span class="line">                                  requestClass:[GCDWebServerRequest class]</span><br><span class="line">                                  processBlock:^GCDWebServerResponse * _Nullable(__kindof GCDWebServerRequest * _Nonnull request) &#123;</span><br><span class="line">            if (weak_self) &#123;</span><br><span class="line">                __strong typeof(weak_self) self = weak_self;</span><br><span class="line">                return [self _configResponse];</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                return nil;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;];</span><br><span class="line">        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(_applicationWillEnterForeground) name:UIApplicationWillEnterForegroundNotification object:nil];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Public</span><br><span class="line"></span><br><span class="line">+ (instancetype)shared &#123;</span><br><span class="line">    static HttpServerUtil *instance;</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        instance = [[HttpServerUtil alloc] init];</span><br><span class="line">    &#125;);</span><br><span class="line">    return instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (void)openSafariWithIcon:(UIImage *)image name:(nonnull NSString *)name scheme:(nonnull NSString *)scheme &#123;</span><br><span class="line">    HttpServerUtil *serverUtil = [HttpServerUtil shared];</span><br><span class="line">    serverUtil.base64ImageString = [serverUtil _base64WithImage:image icon:YES];</span><br><span class="line">    serverUtil.appName = name;</span><br><span class="line">    serverUtil.appScheme = scheme;</span><br><span class="line">    [serverUtil start];</span><br><span class="line">    [[UIApplication sharedApplication] openURL:serverUtil.httpServerURL options:@&#123;&#125; completionHandler:^(BOOL success) &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)start &#123;</span><br><span class="line">    if ([self.webServer isRunning]) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    NSUInteger port = 12315;</span><br><span class="line">    [self.webServer startWithPort:port bonjourName:nil];</span><br><span class="line">    self.httpServerURL = [NSURL URLWithString:[NSString stringWithFormat:@&quot;http://127.0.0.1:%lu&quot;, port]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)stop &#123;</span><br><span class="line">    if (![self.webServer isRunning]) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    [self.webServer stop];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Private</span><br><span class="line"></span><br><span class="line">- (GCDWebServerResponse *)_configResponse &#123;</span><br><span class="line">    // 设置名称、Icon、Scheme</span><br><span class="line">    NSString *contentHtmlPath = [[NSBundle mainBundle] pathForResource:@&quot;AddToHomeScreenContent&quot; ofType:@&quot;html&quot;];</span><br><span class="line">    NSMutableString *contentHtml = [[NSMutableString alloc] initWithContentsOfFile:contentHtmlPath encoding:NSUTF8StringEncoding error:NULL];</span><br><span class="line">    NSString *base64TipsImage = [self _base64WithImage:[UIImage imageNamed:@&quot;&quot;] icon:NO];</span><br><span class="line">    NSString *tipsImageWidth = [NSString stringWithFormat:@&quot;%lfpx&quot;, [[UIScreen mainScreen] bounds].size.width - 15 * 2];</span><br><span class="line">    NSString *tipsImageLeft = [NSString stringWithFormat:@&quot;%lfpx&quot;, 15.0f];</span><br><span class="line">    NSDictionary *variables = @&#123;</span><br><span class="line">        @&quot;ShortcutIcon&quot; : self.base64ImageString,</span><br><span class="line">        @&quot;ShortcutName&quot; : self.appName,</span><br><span class="line">        @&quot;AppScheme&quot; : self.appScheme,</span><br><span class="line">        @&quot;TipsImage&quot; : base64TipsImage,</span><br><span class="line">        @&quot;TipsImageWidth&quot; : tipsImageWidth,</span><br><span class="line">        @&quot;TipsImageLeft&quot; : tipsImageLeft,</span><br><span class="line">    &#125;;</span><br><span class="line">    [variables enumerateKeysAndObjectsUsingBlock:^(NSString* key, NSString* value, BOOL* stop) &#123;</span><br><span class="line">        [contentHtml replaceOccurrencesOfString:[NSString stringWithFormat:@&quot;%%%@%%&quot;, key] withString:value options:0 range:NSMakeRange(0, contentHtml.length)];</span><br><span class="line">    &#125;];</span><br><span class="line">    NSString *urlStringEncode = [contentHtml stringByAddingPercentEncodingWithAllowedCharacters:[NSCharacterSet URLQueryAllowedCharacterSet]];</span><br><span class="line">    NSString *html = [NSString stringWithFormat:@&quot;data:text/html;charset=utf-8,%@&quot;, urlStringEncode];</span><br><span class="line">    GCDWebServerResponse *rsp = [GCDWebServerResponse responseWithRedirect:self.httpServerURL permanent:YES];</span><br><span class="line">    [rsp setValue:html forAdditionalHeader:@&quot;Location&quot;]; // 设置URLEncoded的html</span><br><span class="line">    return rsp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSString *)_base64WithImage:(UIImage * _Nullable)image icon:(BOOL)isIcon &#123;</span><br><span class="line">    if (isIcon) &#123;</span><br><span class="line">        image = (image ? [image sd_resizedImageWithSize:CGSizeMake(180, 180) scaleMode:SDImageScaleModeAspectFill] : self.appIconImage);</span><br><span class="line">    &#125;</span><br><span class="line">    NSData *data = UIImagePNGRepresentation(image);</span><br><span class="line">    NSString *encodedImageStr = [data base64EncodedStringWithOptions:NSDataBase64Encoding64CharacterLineLength];</span><br><span class="line">    NSString *result = [NSString stringWithFormat:@&quot;data:image/png;base64,%@&quot;, encodedImageStr];</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)_applicationWillEnterForeground &#123;</span><br><span class="line">    [self stop];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Getter</span><br><span class="line"></span><br><span class="line">- (GCDWebServer *)webServer &#123;</span><br><span class="line">    if (_webServer == nil) &#123;</span><br><span class="line">        _webServer = [[GCDWebServer alloc] init];</span><br><span class="line">    &#125;</span><br><span class="line">    return _webServer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (UIImage *)appIconImage &#123;</span><br><span class="line">    if (_appIconImage == nil) &#123;</span><br><span class="line">        NSDictionary *infoDict = [[NSBundle mainBundle] infoDictionary];</span><br><span class="line">        NSArray *iconsArr = infoDict[@&quot;CFBundleIcons&quot;][@&quot;CFBundlePrimaryIcon&quot;][@&quot;CFBundleIconFiles&quot;];</span><br><span class="line">        NSString *iconLastName = [iconsArr lastObject];</span><br><span class="line">        _appIconImage = [UIImage imageNamed:(iconLastName ?: @&quot;AppIcon&quot;)];</span><br><span class="line">    &#125;</span><br><span class="line">    return _appIconImage;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li><li><p>使用 <code>[HttpServerUtil openSafariWithIcon:nil name:@&quot;xxx&quot; scheme:@&quot;xx://&quot;];</code></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS 13修改启动图未生效</title>
      <link href="/ChangeLaunchScreenIniOS13.html"/>
      <url>/ChangeLaunchScreenIniOS13.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>前言：由于业务要求需要更新应用启动图，拿到新图时分分钟替换完事儿，经测试在iOS 13系统上未生效</p></blockquote><h3 id="问题排查"><a href="#问题排查" class="headerlink" title="问题排查"></a>问题排查</h3><p>启动图使用 <code>LaunchScreen.storyboard</code> 的方式，在查阅资料与实践后得出结论：</p><ul><li>系统会根据<code>LaunchScreen.stroboard</code>的内容生成屏幕快照（@2x和@3x）</li><li>快照存放在<code>Library/SplashBoard/Snapshots</code>下</li><li>第次运行时都会生成新的快照图片，根据屏幕倍数显示相应的快照图片</li><li>在 iOS 13 系统中，更新图片名称、内容，并删除快照图片缓存后，下次启动时启动图才更新</li></ul><p>也就是说在 iOS 13 上，更新启动图需要改图片名称、删除快照图片缓存，在下次启动时才生效！！！</p><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>在 iOS 13 上冷启动时校验缓存图片与当前图片是否一致，若缓存图片不存在或图片不一致则删除快照缓存并更新缓存图片，图片一致时不处理</p><span id="more"></span><h3 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">+ (void)cleanSplashBoard &#123;</span><br><span class="line">    float systemVersion = [WM_CURRENT_SYSTEM_VERSION floatValue];</span><br><span class="line">    if (systemVersion &gt;= 13.0 &amp;&amp; systemVersion &lt; 14.0) &#123;</span><br><span class="line">        NSString *documentsPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES).firstObject;</span><br><span class="line">        NSString *folderPath = [documentsPath stringByAppendingPathComponent:@&quot;Data&quot;];</span><br><span class="line">        NSString *imageCachePath = [folderPath stringByAppendingPathComponent:@&quot;SplashBoard&quot;]; // ~/Documents/Data/SplashBoard</span><br><span class="line">        // 准备</span><br><span class="line">        BOOL isDirectory = YES;</span><br><span class="line">        if (![[NSFileManager defaultManager] fileExistsAtPath:folderPath isDirectory:&amp;isDirectory]) &#123;</span><br><span class="line">            [[NSFileManager defaultManager]  createDirectoryAtPath:folderPath withIntermediateDirectories:YES attributes:nil error:nil];</span><br><span class="line">        &#125;</span><br><span class="line">        NSError *error = nil;</span><br><span class="line">        // 1.获取Images.xcassets中启动图</span><br><span class="line">        UIStoryboard *sb = [UIStoryboard storyboardWithName:@&quot;LaunchScreen&quot; bundle:nil];</span><br><span class="line">        NSAssert(sb != nil, @&quot;未找到 LaunchScreen.storyboard 文件&quot;);</span><br><span class="line">        UIViewController *vc = [sb instantiateInitialViewController];</span><br><span class="line">        UIImage *currentImage = nil;</span><br><span class="line">        for (UIView *subview in vc.view.subviews) &#123;</span><br><span class="line">            if ([subview isKindOfClass:[UIImageView class]]) &#123;</span><br><span class="line">                currentImage = ((UIImageView *)subview).image;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (currentImage == nil) &#123;</span><br><span class="line">        NSAssert(currentImage != nil, @&quot;LaunchScreen.storyboard 中缺少 ImageView&quot;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        NSData *currentData = UIImagePNGRepresentation(currentImage);</span><br><span class="line">        // 2.获取缓存的启动图</span><br><span class="line">        NSData *cachedData = [[NSData alloc] initWithContentsOfFile:imageCachePath];</span><br><span class="line">        if (cachedData &amp;&amp; [cachedData isEqualToData:currentData]) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        [[NSFileManager defaultManager] removeItemAtPath:[NSHomeDirectory() stringByAppendingString:@&quot;/Library/SplashBoard&quot;] error:nil];</span><br><span class="line">        [currentData writeToFile:imageCachePath atomically:YES];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Duplicate symbol for .a</title>
      <link href="/DuplicateSymbolForStaticLibrary.html"/>
      <url>/DuplicateSymbolForStaticLibrary.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><blockquote><p><code>ibmtasdk.a</code> 和 <code>libWeChatSDK.a</code> 中都包含 <code>MTASocket.o</code>，从而出现重复的法名<code>_responseErrorKey</code>导致编辑失败<br>Log:<br>duplicate symbol ‘_responseErrorKey’ in:<br>TXUGCVideoUpload/COSSDK/libmtasdk.a(MTASocket.o)<br>UnifyPay/WeChat/libWeChatSDK.a(MTASocket.o)<br>ld: 1 duplicate symbol for architecture arm64<br>clang: error: linker command failed with exit code 1 (use -v to see invocation)</p></blockquote><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="方案一：删除-libmtasdk-a-中MTASocket-o（失败）"><a href="#方案一：删除-libmtasdk-a-中MTASocket-o（失败）" class="headerlink" title="方案一：删除 libmtasdk.a 中MTASocket.o（失败）"></a>方案一：删除 <code>libmtasdk.a</code> 中<code>MTASocket.o</code>（失败）</h3><p>步骤：</p><ol><li>查看<code>libmtasdk.a</code>支持的架构类型<br> <code>$ lipo -info libmtasdk.a</code><br> 信息<code>Architectures in the fat file: libmtasdk.a are: i386 x86_64 arm64 armv7 armv7s</code>，表示该静态库支持i386、x86_64rm64、armv7、armv7s平台</li><li>获取各架构的动态库<br> <code>$ lipo -extract_family i386 -o libmtasdk_i386.a libmtasdk.a</code><br> 其它架构类型也是，最后得到libmtasdk_i386.a、libmtasdk_x86_64.a、libmtasdk_arm64.a、……</li><li>删除重复的<code>MTASocket.o</code><br> <code>$ ar -d libmtasdk_i386.a MTASocket.o </code><br> 其它架构类型也是<blockquote><p>如果报错</p><pre><code> ar: libmtasdk_armv7.a is a fat file (use libtool(1) or lipo(1) and ar(1) on it)</code></pre><p>ar: libmtasdk_armv7.a: Inappropriate file type or format<br> 则需要执行<code>$ lipo libmtasdk_armv7.a -thin armv7 -o libmtasdk_armv7_new.a</code>,然后使用<code>libmtasdk_armv7_new.a</code>继续操作</p></blockquote></li><li>合并所有架构类型的静态库<br> <code>$ lipo -create -output libmtasdk_xxx.a libmtasdk_i386.a libmtasdk_x86_64.a libmtasdk_arm64.a armv7.a armv7s.a</code></li><li>使用新的静态库<code>libmtasdk_xxx.a</code><br> 工程中删除<code>libmtasdk.a</code>并导入<code>libmtasdk_xxx.a</code></li></ol><p>结束失败了，运行时报错</p><span id="more"></span><h3 id="方案二：删除-libWeChatSDK-a中MTASocket-o（失败）"><a href="#方案二：删除-libWeChatSDK-a中MTASocket-o（失败）" class="headerlink" title="方案二：删除 libWeChatSDK.a中MTASocket.o（失败）"></a>方案二：删除 <code>libWeChatSDK.a</code>中<code>MTASocket.o</code>（失败）</h3><p>操作和结束同方案一</p><h3 id="方案三：合并libmtasdk-a-和-libWeChatSDK-a（失败）"><a href="#方案三：合并libmtasdk-a-和-libWeChatSDK-a（失败）" class="headerlink" title="方案三：合并libmtasdk.a 和 libWeChatSDK.a（失败）"></a>方案三：合并<code>libmtasdk.a</code> 和 <code>libWeChatSDK.a</code>（失败）</h3><p>步骤：</p><ol><li><p>获取各架构的动态库<br> 详细操作参考方案一</p></li><li><p>建立不所需的文件夹</p><ul><li>libmtasdk<ul><li>i386</li><li>x86_64</li><li>arm64</li><li>armv7</li></ul></li><li>libWeChatSDK<ul><li>i386</li><li>x86_64</li><li>arm64</li><li>armv7</li></ul></li></ul></li><li><p>解压各架构的静态库<br> <code>$ ar -d libmtasdk_i386.a</code><br> 两个静态库的所有架构都需要解压</p></li><li><p>将相同架构的文件夹合并</p></li><li><p>生成各架构的静态<br> <code>$ libtool -static -o i386.a *.o</code></p></li><li><p>生成新的静态库<br> <code>lipo -create -output libWeChatSDK_xxx.a i386.a x86_64.aarm64.a armv7.a</code></p></li><li><p>使用新的静态库<code>libWeChatSDK_xxx.a</code><br> 工程中删除<code>libmtasdk.a</code>和<code>libWeChatSDK.a</code>并导入<code>libWeChatSDK_xxx.a</code></p></li></ol><p>结束失败了，运行时报错</p><h3 id="方案四：升级-libWeChatSDK-（成功）"><a href="#方案四：升级-libWeChatSDK-（成功）" class="headerlink" title="方案四：升级 libWeChatSDK （成功）"></a>方案四：升级 <a href="https://developers.weixin.qq.com/doc/oplatform/Downloads/iOS_Resource.html">libWeChatSDK</a> （成功）</h3><blockquote><p>在WeChatSDK官网上看到在1.8.6.1移除了MTA库，从而决定升级WeChatSDK<br>SDK1.8.6.1</p></blockquote><ol><li>UIWebview切换成WKWebview</li><li>支持Universal Link拉起微信以及返回App</li><li>移除MTA库</li></ol><p>升级完后的 <strong>WeChatSDK</strong> 遇到错误信息， <strong>按照方案一成功解决掉了</strong> </p><blockquote><p>duplicate symbol ‘<em>OBJC_CLASS</em>$_WXWebViewController’ in:<br>UnifyPay/WeChat/libWeChatSDK.a(WapAuthHandler.o)<br>H5Pay/libH5Pay.a(WXWebViewController.o)<br>duplicate symbol ‘<em>OBJC_METACLASS</em>$_WXWebViewController’ in:<br>UnifyPay/WeChat/libWeChatSDK.a(WapAuthHandler.o)<br>H5Pay/libH5Pay.a(WXWebViewController.o)<br>ld: 2 duplicate symbols for architecture x86_64<br>clang: error: linker command failed with exit code 1 (use -v to see invocation)</p></blockquote><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><h3 id="命令总结"><a href="#命令总结" class="headerlink" title="命令总结"></a>命令总结</h3><ul><li><code>$ lipo -info XXX.a</code>，查看静态库支持 <strong>架构类型</strong> </li><li><code>$ lipo -extract_family i386 -o i386.a XXX.a</code>，获取 <strong>i386架构</strong> 的静态库</li><li><code>$ lipo XXX_armv7.a -thin armv7 -o armv7.a</code>，转换 <strong>armv7架构</strong> 静态库的 <strong>file类型</strong> ，解决<code>is a fat file (use libtool(1) or lipo(1) and ar(1) on it)</code></li><li><code>$ lipo -create -o libXXX_xxx.a libXXX_i386.a libXXX_x86_64.a libXXX_arm64.a libXXX_armv7.a</code>，合并 <strong>i386架构</strong> 、 <strong>x86_64架构</strong> 、 <strong>arm64架构</strong> 、 <strong>armv7架构</strong> 静态库</li><li><code>$ ar -d libXXX_arm64.a 1.o 2.o 3.o</code>，移除静态库中的.o</li><li><code>$ ar -x libXXX_arm64.a</code>，解压静态库至当前文件夹</li><li><code>$ libtool -static -o libXXX_arm64.a *.o</code>，生成静态库</li></ul><h3 id="方案一完整Log"><a href="#方案一完整Log" class="headerlink" title="方案一完整Log"></a>方案一完整Log</h3><pre><code>    localhost:hertz$ lipo -info libmtasdk.a         Architectures in the fat file: libmtasdk.a are: i386 x86_64 arm64 armv7 armv7s         localhost:hertz$ lipo -extract_family i386 -output i386.a libmtasdk.a         localhost:hertz$ lipo -extract_family x86_64 -output x86_64.a libmtasdk.a         localhost:hertz$ lipo -extract_family arm64 -output arm64.a libmtasdk.a         localhost:hertz$ lipo -extract_family armv7 -output armv7.a libmtasdk.a         localhost:hertz$ lipo -extract_family armv7s -output armv7s.a libmtasdk.a         localhost:hertz$ ar -d i386.a MTASocket.o        ar: MTASocket.o: not found in archive        localhost:hertz$ ar -d x86_64.a MTASocket.o        ar: MTASocket.o: not found in archive        localhost:hertz$ ar -d arm64.a MTASocket.o        localhost:hertz$ ar -d armv7.a MTASocket.o        ar: armv7.a is a fat file (use libtool(1) or lipo(1) and ar(1) on it)        ar: armv7.a: Inappropriate file type or format        localhost:hertz$ lipo armv7.a -thin armv7 -output new_armv7.a        localhost:hertz$ ar -d new_armv7.a MTASocket.o        localhost:hertz$ ar -d armv7s.a MTASocket.o        ar: armv7s.a is a fat file (use libtool(1) or lipo(1) and ar(1) on it)        ar: armv7s.a: Inappropriate file type or format        localhost:hertz$ lipo armv7s.a -thin armv7s -output new_armv7s.a        localhost:hertz$ ar -d new_armv7s.a MTASocket.o    localhost:hertz$ lipo -create -output new_library.a i386.a x86_64.a arm64.a new_armv7.a new_armv7s.a </code></pre>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决Mac提示磁盘已满</title>
      <link href="/CleanMacDisk.html"/>
      <url>/CleanMacDisk.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>通过删除缓存和无用的工具来实现腾空间</p></blockquote><h2 id="应用缓存"><a href="#应用缓存" class="headerlink" title="应用缓存"></a>应用缓存</h2><ul><li><p>企业微信<br><code>~/Library/Containers/com.tencent.WeWorkMac/Data/Library/Application\ Support/WXWork/Data</code></p></li><li><p>微信<br><code>~/Library/Containers/com.tencent.xinWeChat/Data/Library/Caches</code></p></li><li><p>QQ:<br><code>~/Library/Containers/com.tencent.qq/Data/Library/Caches</code></p></li><li><p>网易云音乐<br><code>~/Library/Containers/com.netease.163music/Data/Library/Caches</code></p></li></ul><h2 id="开发工具"><a href="#开发工具" class="headerlink" title="开发工具"></a>开发工具</h2><ul><li>~/Library/Developer/<ul><li>Xcode<ul><li>Archives（Xcode Archive后文件夹，无用时可删除）</li><li>watchOS DeviceSupport（watchOS 模拟器SDK，非watch开发可删除）</li><li>iOS DeviceSupport（iOS 模拟器SDK，可将用不着的iOS版本删除）</li><li>DerivedData（所有用Xcode Build的项目文件，可根据工程删除）</li></ul></li><li>CoreSimulator<ul><li>Caches（SimRuntime文件，可删除无用平台，如watch、tv）</li><li>Devices（Xcode运行时选的模拟器，可在<code>Xcode-&gt;Window-&gt;Devices and Simulators</code>中删除）</li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Xcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>libwebp Pod超时处理</title>
      <link href="/libwebp.html"/>
      <url>/libwebp.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>业务中需要支持WebP图片，然后在Pod时提示超时，解决思路是先fork一份libwebp项目，然后添加<code>libwebp.podspec</code>文件，最后在Podfile中指定源</p></blockquote><h2 id="Fork项目"><a href="#Fork项目" class="headerlink" title="Fork项目"></a>Fork项目</h2><ol><li><p>终端执行 <code>pod search libwebp</code>查看仓库地址，或使用Github上找到的<code>https://github.com/webmproject/libwebp</code></p><pre><code> -&gt; libwebp (1.1.0)    Library to encode and decode images in WebP format.    pod &#39;libwebp&#39;, &#39;~&gt; 1.1.0&#39;    - Homepage: https://developers.google.com/speed/webp/    - Source:   https://chromium.googlesource.com/webm/libwebp    - Versions: 1.1.0, 1.1.0-rc2, 1.0.3, 1.0.2, 1.0.1, 1.0.0, 0.6.1, 0.6.0,    0.5.2, 0.5.1, 0.5.0, 0.4.4, 0.4.3, 0.4.2, 0.4.1 [trunk repo]    - Subspecs:      - libwebp/webp (1.1.0)      - libwebp/demux (1.1.0)      - libwebp/mux (1.1.0)</code></pre></li><li><p>新建Git仓库并上传</p></li></ol><h2 id="添加-libwebp-podspec"><a href="#添加-libwebp-podspec" class="headerlink" title="添加 libwebp.podspec"></a>添加 libwebp.podspec</h2><p>在Git根目录新建文件<code>libwebp.podspec</code>，格式参考<a href="https://guides.cocoapods.org/syntax/podspec.html">Podspec Syntax Reference</a>，大体如下：</p><pre><code>Pod::Spec.new do |s|  s.name             = &#39;libwebp&#39;  s.version          = &#39;1.1.0&#39;  s.summary          = &#39;Library to encode and decode images in WebP format.&#39;  s.description      = &lt;&lt;-DESCLibrary to encode and decode images in WebP format.                       DESC  s.homepage         = &#39;https://developers.google.com/speed/webp/&#39;  s.license          = &#123; :type =&gt; &#39;BSD&#39;, :file =&gt; &#39;COPYING&#39; &#125;  s.author           = &#123; &#39;Google Inc.&#39; =&gt; &#39;mail@google.com&#39; &#125;  s.source           = &#123; :git =&gt; &#39;https://example/libwebp.git&#39;, :tag =&gt; s.version.to_s &#125;  s.compiler_flags   = &#39;-D_THREAD_SAFE&#39;  s.requires_arc     = false  s.platforms        = &#123; :ios =&gt; &#39;6.0&#39; &#125;  s.pod_target_xcconfig = &#123; &quot;USER_HEADER_SEARCH_PATHS&quot;: &quot;$(inherited) $&#123;PODS_ROOT&#125;/libwebp/ $&#123;PODS_TARGET_SRCROOT&#125;/&quot; &#125;  s.preserve_paths   = &#39;src&#39;  s.ios.deployment_target = &#39;6.0&#39;  s.source_files = &#39;src/webp/decode.h&#39;, &#39;src/webp/encode.h&#39;, &#39;src/webp/types.h&#39;, &#39;src/webp/mux_types.h&#39;, &#39;src/webp/format_constants.h&#39;, &#39;src/utils/*.&#123;h,c&#125;&#39;, &#39;src/dsp/*.&#123;h,c&#125;&#39;, &#39;src/dec/*.&#123;h,c&#125;&#39;, &#39;src/enc/*.&#123;h,c&#125;&#39;  end</code></pre><p>注意：</p><ol><li><code>libwebp.podspec</code>中的信息源于<code>libwebp.podspec.json</code>文件</li><li><code>s.source</code>中的<code>git</code>为fork后的新地址</li><li>由于使用的是tag，所以需要新建名为<code>s.version</code>对应的tag</li><li><code>s.source_files</code>这块的写法是只用到了<code>webp</code></li></ol><h2 id="指定源"><a href="#指定源" class="headerlink" title="指定源"></a>指定源</h2><p>指定Git库及分支，在<code>Podfile</code>文件中添加如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod &#x27;libwebp&#x27;, :git =&gt; &#x27;https://example/libwebp.git&#x27;, :branch =&gt; &#x27;master&#x27;</span><br></pre></td></tr></table></figure><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><p><a href="http://littlesvr.ca/apng/gif_apng_webp5.html">GIF vs APNG vs WebP</a></p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>路由无线桥接（WDS）</title>
      <link href="/UseWDS.html"/>
      <url>/UseWDS.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="记录WDS"><a href="#记录WDS" class="headerlink" title="记录WDS"></a>记录WDS</h2><ol><li>修改登录口令</li><li>设置无线密码</li><li>开启WDS（信道与桥接的SSID一致）</li><li>关闭<code>DHCP服务器</code></li><li>修改路由IP（LAN口设置-IP地址）</li></ol>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YAPI助手</title>
      <link href="/YAPIHelper.html"/>
      <url>/YAPIHelper.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>前言：</p></blockquote><h3 id="安装xlrd"><a href="#安装xlrd" class="headerlink" title="安装xlrd"></a>安装<code>xlrd</code></h3><p>执行 <code>pip install xlrd</code>安装</p><ul><li>注：提示<code>-bash: pip: command not found</code>，执行<code>sudo easy_install pip</code> 安装pip</li></ul><h3 id="执行Python"><a href="#执行Python" class="headerlink" title="执行Python"></a>执行Python</h3><pre><code># -*- coding: utf-8 -*-import xdrlib ,sysimport xlrdimport os# 文件名fileName = &#39;yapi.xlsx&#39;# 属性名称列propertyNameCol = 0# 属性类型列propertyTypeCol = 1# 属性注释列propertyDescCol = 4#打开excel文件def open_excel():    try:        data = xlrd.open_workbook(fileName)        return data    except Exception,e:        print str(e)def print_excel():    data = open_excel() #打开excel文件    sheet1 = data.sheet_by_index(0) #选择第1个Sheet    nrows = sheet1.nrows    os.system(&#39;clear&#39;)    for rownum in range(0, nrows):        name = sheet1.cell_value(rownum, propertyNameCol)        type = sheet1.cell_value(rownum, propertyTypeCol)        desc = sheet1.cell_value(rownum, propertyDescCol)        nstype = &#39;NSNumber&#39;        if type == &#39;string&#39;:            nstype = &#39;NSString&#39;        print (&#39;/// %s&#39; % (desc))        print (&#39;@property (nonatomic, copy) %s* %s;&#39; % (nstype, name))    print(&#39;&#39;)#主函数def main():    print_excel()if __name__==&quot;__main__&quot;:    main()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Runtime获取Class属性列表及属性类型</title>
      <link href="/iOSRuntimeProperty.html"/>
      <url>/iOSRuntimeProperty.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h3 id="属性类型"><a href="#属性类型" class="headerlink" title="属性类型"></a>属性类型</h3><blockquote><p><code>property_getAttributes</code>获取至的结构：<code>数据类型,修饰词...,V_属性名称，如：T@,R,C,N,V_idValue</code></p></blockquote><ul><li>数据类型，以”T”开始至第一个”,”<ul><li><code>@</code> -&gt; <code>id</code></li><li>@”XXX” -&gt; <code>XXX</code>，如：@”NSString”、@”NSArray”</li><li><code>i</code> -&gt; <code>int</code></li><li><code>d</code> -&gt; <code>double</code></li><li><code>f</code> -&gt; <code>float</code></li></ul></li><li>修饰词，以第一个”,”开始至最后一个”,”<ul><li><code>N</code> -&gt; <code>nonatomic</code></li><li><code>R</code> -&gt; <code>reonly</code></li><li><code>C</code> -&gt; <code>copy</code></li><li><code>&amp;</code> -&gt; <code>strong</code>、<code>retain</code></li><li><code>W</code> -&gt; <code>weak</code></li></ul></li><li><code>V_属性名称，以&quot;V_&quot;开始至结尾，&quot;V_&quot;后面的就是属性名称</code></li></ul><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><ul><li><p>属性声名</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@property (nonatomic, copy, readonly, nullable) id idValue;</span><br><span class="line">@property (nonatomic, copy) NSNumber *numberValue;</span><br><span class="line">@property (nonatomic, strong) NSString *stringValue;</span><br><span class="line">@property (nonatomic, copy) NSArray *arrayValue;</span><br><span class="line">@property (nonatomic, copy) NSDictionary *dictionaryValue;</span><br><span class="line">@property (nonatomic, assign) int intValue;</span><br><span class="line">@property (nonatomic, assign) double doubleValue;</span><br><span class="line">@property (nonatomic, assign) float floatValue;</span><br><span class="line">@property (nonatomic, assign, readwrite) CGFloat cgfloatValue;</span><br><span class="line">@property (nonatomic, retain) NSString *retainStringValue;</span><br><span class="line">@property (nonatomic, weak) NSString *weakStringValue;</span><br><span class="line">@property (nonatomic, strong) NSString *__weakStringValue;</span><br></pre></td></tr></table></figure></li><li><p>获取属性列表及属性类型</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;objc/runtime.h&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">uint count;</span><br><span class="line">objc_property_t *propertys = class_copyPropertyList(ObjectClass.class, &amp;count);</span><br><span class="line">@try &#123;</span><br><span class="line">for (int i = 0; i &lt; count; i++) &#123;</span><br><span class="line">objc_property_t property = propertys[i];</span><br><span class="line">NSLog(@&quot;%s -&gt; %s&quot;, property_getName(property), property_getAttributes(property));</span><br><span class="line">&#125;</span><br><span class="line">&#125; @finally &#123;</span><br><span class="line">free(propertys);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>打印结果</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">idValue -&gt; T@,R,C,N,V_idValue</span><br><span class="line">numberValue -&gt; T@&quot;NSNumber&quot;,C,N,V_numberValue</span><br><span class="line">stringValue -&gt; T@&quot;NSString&quot;,&amp;,N,V_stringValue</span><br><span class="line">arrayValue -&gt; T@&quot;NSArray&quot;,C,N,V_arrayValue</span><br><span class="line">dictionaryValue -&gt; T@&quot;NSDictionary&quot;,C,N,V_dictionaryValue</span><br><span class="line">intValue -&gt; Ti,N,V_intValue</span><br><span class="line">doubleValue -&gt; Td,N,V_doubleValue</span><br><span class="line">floatValue -&gt; Tf,N,V_floatValue</span><br><span class="line">cgfloatValue -&gt; Td,N,V_cgfloatValue</span><br><span class="line">retainStringValue -&gt; T@&quot;NSString&quot;,&amp;,N,V_retainStringValue</span><br><span class="line">weakStringValue -&gt; T@&quot;NSString&quot;,W,N,V_weakStringValue</span><br><span class="line">__weakStringValue -&gt; T@&quot;NSString&quot;,&amp;,N,V___weakStringValue</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS OTA 搭建</title>
      <link href="/iOSOTA.html"/>
      <url>/iOSOTA.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="搭建OTA"><a href="#搭建OTA" class="headerlink" title="搭建OTA"></a>搭建OTA</h2><blockquote><p>前言：我使用阿里的ECS，万网购买的域名，赛门铁克签发的证书，使用Nginx做的反向代理及Web服务</p></blockquote><h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><pre><code>-&gt; xxx.ipa-&gt; manifest.plist-&gt; xxx.crt-&gt; index.html-&gt; images    -&gt; 57x57.png    -&gt; 512x512.png</code></pre><h3 id="xxx-ipa"><a href="#xxx-ipa" class="headerlink" title="xxx.ipa"></a>xxx.ipa</h3><p>打包略</p><span id="more"></span><h2 id="manifest-plist"><a href="#manifest-plist" class="headerlink" title="manifest.plist"></a>manifest.plist</h2><blockquote><p>应用信息文件，包含bundle identifier、ersion、ipa文件路径、预览图等信息</p></blockquote><ul><li><p>打包时勾选<code>Include manifest for over-the-air installation</code></p></li><li><p>手动创建文件，内容如下：</p><pre><code>  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;  &lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;  &lt;plist version=&quot;1.0&quot;&gt;  &lt;dict&gt;      &lt;key&gt;items&lt;/key&gt;      &lt;array&gt;          &lt;dict&gt;              &lt;key&gt;assets&lt;/key&gt;              &lt;array&gt;                  &lt;dict&gt;                      &lt;key&gt;kind&lt;/key&gt;                      &lt;string&gt;software-package&lt;/string&gt;                      &lt;key&gt;url&lt;/key&gt;                      &lt;string&gt;https://DomainOrIP/path/xxx.ipa&lt;/string&gt;                  &lt;/dict&gt;                  &lt;dict&gt;                      &lt;key&gt;kind&lt;/key&gt;                      &lt;string&gt;display-image&lt;/string&gt;                      &lt;key&gt;url&lt;/key&gt;                      &lt;string&gt;https://DomainOrIP/path/image/57x57.png&lt;/string&gt;                  &lt;/dict&gt;                  &lt;dict&gt;                      &lt;key&gt;kind&lt;/key&gt;                      &lt;string&gt;full-size-image&lt;/string&gt;                      &lt;key&gt;url&lt;/key&gt;                      &lt;string&gt;https:/DomainOrIP/path/image/512x512.png&lt;/string&gt;                  &lt;/dict&gt;              &lt;/array&gt;              &lt;key&gt;metadata&lt;/key&gt;              &lt;dict&gt;                  &lt;key&gt;bundle-identifier&lt;/key&gt;                  &lt;string&gt;AppBundleIdentifier&lt;/string&gt;                  &lt;key&gt;bundle-version&lt;/key&gt;                  &lt;string&gt;AppBundleVersion&lt;/string&gt;                  &lt;key&gt;kind&lt;/key&gt;                  &lt;string&gt;software&lt;/string&gt;                  &lt;key&gt;title&lt;/key&gt;                  &lt;string&gt;AppName&lt;/string&gt;              &lt;/dict&gt;          &lt;/dict&gt;      &lt;/array&gt;  &lt;/dict&gt;  &lt;/plist&gt;</code></pre></li></ul><h3 id="xxx-crt"><a href="#xxx-crt" class="headerlink" title="xxx.crt"></a>xxx.crt</h3><blockquote><p>用于服务器<code>https</code>配置和手机安装证书</p></blockquote><ul><li><p>使用已有证书</p><ul><li><code>pem</code>转<code>crt</code>   <code>openssl x509 -outform der -in your-cert.pem -out your-cert.crt</code></li><li>其它转<code>crt</code><a href="https://vimsky.com/article/3608.html">参考文章</a></li></ul></li><li><p>建新证书</p><ul><li>正常操作<a href="https://www.jianshu.com/p/75f01a638a07">参考</a></li></ul></li></ul><h3 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h3><blockquote><p>引导安装证书和安装应用</p></blockquote><ul><li>证书连接：<code>https://DomainOrIP/path/xxx.crt</code></li><li>安装应用：<code>itms-services://?action=download-manifest&amp;url=https://DomainOrIP/path/manifest.plist</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AppStoreReject3.7.7</title>
      <link href="/AppStoreReject3-7-7.html"/>
      <url>/AppStoreReject3-7-7.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>前言：</p><p>苹果审核变严之时，“糖护士”发布<code>3.7.7</code>版本时多次被拒，本文主要记录问题及解决识方案。</p></blockquote><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ol><li>苹果终结了<code>prefs:</code>私有方法的使用；</li><li><code>Info.plist</code>中准确描述授权的用途，不能含糊描述了，不要请求用不到的授权；</li><li>应用截图要符合实际；</li><li><code>App IDs Identifiers</code>中不要开启用不到的功能。</li></ol><h3 id="2018年9月21日"><a href="#2018年9月21日" class="headerlink" title="2018年9月21日"></a>2018年9月21日</h3><p>2.5.1：由于使用了苹果私有方法<code>prefs:root=</code>被拒，项目中删除<code>prefs:root=</code>相关代码。</p><p>5.1.1：有个图片附件，是说请求授权描述不够清晰，如“点击允许使用相机”，应该写为“允许后可使用扫一扫功能”，需要明确告知用户，更新<code>Info.plist</code>文件中的描述。</p><span id="more"></span><blockquote><p>信息如下：</p></blockquote><pre><code>2.5 Performance: Software Requirements 5.1.1 Legal: Privacy - Data Collection and Storage---------------------------------------------Guideline 2.5.1 - Performance - Software RequirementsYour app uses the &quot;prefs:root=&quot; non-public URL scheme, which is a private entity. The use of non-public APIs is not permitted on the App Store because it can lead to a poor user experience should these APIs change.Continuing to use or conceal non-public APIs in future submissions of this app may result in the termination of your Apple Developer account, as well as removal of all associated apps from the App Store.Next StepsTo resolve this issue, please revise your app to provide the associated functionality using public APIs or remove the functionality using the &quot;prefs:root&quot; or &quot;App-Prefs:root&quot; URL scheme.If there are no alternatives for providing the functionality your app requires, you can file an enhancement request.Guideline 5.1.1 - Legal - Privacy - Data Collection and StorageWe noticed that your app requests the user’s consent to access their camera but does not clarify the use of this feature in the permission modal alert.Next StepsTo resolve this issue, please revise the permission modal alert to specify why the app is requesting access to the user&#39;s camera.The permission request alert should specify how your app will use this feature to help users understand why your app is requesting access to their personal data.ResourcesFor additional information and instructions on configuring and presenting an alert, please review the Requesting Permission section of the iOS Human Interface Guidelines and the Information Property List Key Reference. You may also want to review the Technical Q&amp;A QA1937: Resolving the Privacy-Sensitive Data App Rejection page for details on how to provide a usage description for permission request alerts.Learn more about Protecting the User’s Privacy.Please see attached screenshot for details.</code></pre><h3 id="2018年9月23日"><a href="#2018年9月23日" class="headerlink" title="2018年9月23日"></a>2018年9月23日</h3><p>2.3.3：说是在 <code>iPad（9.7寸）</code> 的 <code>App Sotre</code> 中显示的截图与实际不符，因为是有iPad截图的，所以登录<a href="https://itunesconnect.apple.com/">App Store Connect</a>后，打开准备提交应用<code>App 预览和屏幕快照</code>的<code>在媒体管理中查看所有尺寸</code>，勾选9.7英寸显示屏后面的<code>使用12.9英寸显示屏</code>。</p><p>2.5.1：是说我用了 <code>HealthKit</code> ，视频中未明确显示是如何使用的，在描述的不够清晰，我的处理是更新 <code>Info.plist</code> 中的描述说明，删除了多余的授权请求（更新健康数据），重新录制了视频并更新了链接（审核备注中）。 然而并没有解决，伏笔！！！</p><blockquote><p>信息如下：</p></blockquote><pre><code>2.3 Performance: Accurate Metadata2.5 Performance: Software Requirements---------------------------------------------Guideline 2.3.3 - Performance - Accurate MetadataWe noticed that your screenshots do not sufficiently reflect your app in use.Specifically, your 9.7-inch iPad screenshots do not display the app in the correct device frame.Next StepsTo resolve this issue, please revise your screenshots to ensure that they accurately reflect the app in use on the supported devices. For iPhone, you need a set of 5.5-inch display screenshots and for iPad, you need a set for 12.9-inch display. This set will be scaled appropriately down to other device sizes when viewed on the App Store in each territory.Note that 6.5-inch display assets for iPhone Xs Max are optional, and can scale down to iPhone Xr, iPhone Xs, and iPhone X. Screenshots that include features like rounded corners or sensor housing should only be used for the 6.5-inch or 5.8-inch display.ResourcesFor resources on creating great screenshots for the App Store, you may want to review the App Store Product Page information available on the Apple developer portal.Please ensure you have made any screenshot modifications using Media Manager. You should confirm your app looks and behaves identically in all languages and on all supported devices. Learn how to use Media Manager to add custom screenshots for each display size and localization.Guideline 2.5.1 - Performance - Software RequirementsYour app uses the HealthKit or CareKit APIs but does not indicate integration with the Health app in your app description and clearly identify the HealthKit and CareKit functionality in your app&#39;s user interface.Next Step￼ To resolve this issue, please clearly identify the HealthKit functionality in app&#39;s user interface to avoid confusion.Specifically, the provided demo video: http://v.youku.com/xxx.html, did not showcase HealthKit functionality in app&#39;s user interface. Please see attached screenshots for details.</code></pre><h3 id="2018年9月27日"><a href="#2018年9月27日" class="headerlink" title="2018年9月27日"></a>2018年9月27日</h3><p>2.5：说是我用了 <code>HealthKit</code> 却没有相应的界面说明（指得是授权），健康的授权是 present 出一个ViewController，是像通知、相机那样。检查了代码，发现获取步数用的记步器（CMStepCounter），果断删除 <code>HealthKit</code> 相关代码、授权请求描述，使用新的记步器（CMPedometer iOS 8+）。这就是伏笔之一！！！</p><blockquote><p>信息如下：</p></blockquote><pre><code>2.5 Performance: Software Requirements--------------------------------------Your app uses the HealthKit or CareKit APIs but does not indicate integration with the Health app in your app description and clearly identify the HealthKit and CareKit functionality in your app&#39;s user interface.Specifically, please provide instructions to locate the HealthKit functionality within the app. Next StepsTo resolve this issue, please clearly identify the HealthKit functionality in app&#39;s user interface to avoid confusion.</code></pre><h3 id="2018年9月28日"><a href="#2018年9月28日" class="headerlink" title="2018年9月28日"></a>2018年9月28日</h3><p>2.5.1：这会儿有点崩溃，因 <code>HealthKit</code> 的问题被拒了三回，每次大同小异，在同事的帮助下看出了端倪，因为<code>App IDs Identifiers</code> 中开启了健康功能，关掉健康功能后，重新下载描述文件就好了。一般需要先删除描述文件，路径在<code>~/Library/MobileDevice/Provisioning\ Profiles</code></p><blockquote><p>信息如下：</p></blockquote><pre><code>2.5 Performance: Software Requirements--------------------------------------Guideline 2.5.1 - Performance - Software RequirementsThank you for your resubmission. Your app uses the HealthKit or CareKit APIs but does not indicate integration with the Health app in your app description and clearly identify the HealthKit and CareKit functionality in your app&#39;s user interface.Next StepsTo resolve this issue, please clearly identify the HealthKit functionality in app&#39;s user interface to avoid confusion.</code></pre>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Xcode 8+ 插件安装</title>
      <link href="/XcodeUsePlugins.html"/>
      <url>/XcodeUsePlugins.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>参考：<a href="https://blog.csdn.net/qq942418300/article/details/79827361">XCode9插件安装，XCode9.2插件安装，XCode8和XCode9的Alcatraz安装</a></p></blockquote><h2 id="手动操作"><a href="#手动操作" class="headerlink" title="手动操作"></a>手动操作</h2><ol><li><p>删除旧版 <code>Alcatraz</code></p><pre><code> $ rm -rf ~/Library/Application\ Support/Developer/Shared/Xcode/Plug-ins/Alcatraz.xcplugin $ rm -rf ~/Library/Application\ Support/Alcatraz/ </code></pre></li><li><p>安装最新版 <code>Alcatraz</code> (需要科学上网)</p><pre><code> $ curl -fsSL https://raw.github.com/supermarin/Alcatraz/master/Scripts/install.sh | sh </code></pre></li><li><p>安装 <code>update_xcode_plugins</code> (请检镜像)</p><pre><code> $ sudo gem install -n /usr/local/bin update_xcode_plugins </code></pre><ul><li>运行结束后执行下 <code>$ update_xcode_plugins</code>，此时会检查出本地的插件</li><li>按照提示操作 <code>Run update_xcode_plugins --unsign to fix this</code>，执行后忽略提示</li></ul></li></ol><span id="more"></span><ol start="4"><li>重新启动 <code>Xcode</code>，并选择<code>Load Bundles</code></li></ol><h2 id="Python-脚本"><a href="#Python-脚本" class="headerlink" title="Python 脚本"></a>Python 脚本</h2><pre><code># -*- coding: utf-8 -*-import osimport sysfrom subprocess import Popen# 使用须知：# 1.网络需要：科学上网# 2.检查Ruby镜像，参考：https://gems.ruby-china.com# 3.执行过程需要一次授权，用于安装 update_xcode_plugins# 4.推荐退出Xcode（非必要）## 注：运行后 `Done installing documentation for update_xcode_plugins after 0 seconds 1 gem installed` 会卡顿一会儿def main():    # 删除旧版 Alcatraz    os.system (&#39;rm -rf ~/Library/Application\ Support/Developer/Shared/Xcode/Plug-ins/Alcatraz.xcplugin&#39;)    os.system(&#39;rm -rf ~/Library/Application\ Support/Alcatraz/&#39;)        # 安装最新版 Alcatraz    os.system(&#39;curl -fsSL https://raw.github.com/supermarin/Alcatraz/master/Scripts/install.sh | sh&#39;)        # 安装 update_xcode_plugins    os.system (&#39;sudo gem install -n /usr/local/bin update_xcode_plugins&#39;)    os.system (&#39;update_xcode_plugins&#39;)    os.system (&#39;update_xcode_plugins  --unsign&#39;)        # 启动 Xcode    Popen([&#39;open&#39;, &#39;-a&#39;, &#39;Xcode&#39;])main()</code></pre><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><ol><li><p>Failed to connect to github-production-release-asset-2e65be.s3.amazonaws.com port 443: Operation timed out</p><p> 在安装最新版<code>Alcatraz</code>时会下载存放在 <code>s3.amazonaws.com</code>上部分资源，需要<code>科学上网</code></p></li><li><p>server did not return a valid file (<a href="https://gems.ruby-china.org/specs.4.8.gz">https://gems.ruby-china.org/specs.4.8.gz</a>)</p><p> <a href="https://gems.ruby-china.com/">更新Ruby镜像地址</a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Xcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS 照片授权相关（一）</title>
      <link href="/iOSPhotoLibrary.html"/>
      <url>/iOSPhotoLibrary.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>直接使用 <code>UIImagePickerController</code> 打开照片</p></blockquote><table><thead><tr><th><center>版本</center></th><th><center>需要权限</center></th><th><center>重新安装授权提示</center></th><th><center>Privacy - Photo Library Usage Description</center></th></tr></thead><tbody><tr><td><center>iOS 8.4</center></td><td><center>✓</center></td><td><center>✕</center></td><td><center>✕</center></td></tr><tr><td><center>iOS 9.3</center></td><td><center>✓</center></td><td><center>✕</center></td><td><center>✕</center></td></tr><tr><td><center>iOS 10.3.1</center></td><td><center>✓</center></td><td><center>✓</center></td><td><center>✓</center></td></tr><tr><td><center>iOS 11.4</center></td><td><center>✕</center></td><td><center>✓</center></td><td><center>✓</center></td></tr><tr><td><center>iOS 12.0</center></td><td><center>✕</center></td><td><center>✓</center></td><td><center>✕</center></td></tr><tr><td></td><td></td><td></td><td></td></tr></tbody></table><span id="more"></span><blockquote><p>使用 <code>UIImageWriteToSavedPhotosAlbum</code> 保存 <code>UIImage</code> 到照片</p></blockquote><table><thead><tr><th><center>版本</center></th><th><center>需要权限</center></th><th><center>重新安装授权提示</center></th><th><center>Privacy - Photo Library Usage Description</center></th><th><center>Privacy - Photo Library<br> Additions Usage Description</center></th></tr></thead><tbody><tr><td><center>iOS 8.4</center></td><td><center>✓</center></td><td><center>✕</center></td><td><center>✕</center></td><td><center>✕</center></td></tr><tr><td><center>iOS 9.3</center></td><td><center>✓</center></td><td><center>✕</center></td><td><center>✕</center></td><td><center>✕</center></td></tr><tr><td><center>iOS 10.3.1</center></td><td><center>✓</center></td><td><center>✓</center></td><td><center>✓</center></td><td><center>✕</center></td></tr><tr><td><center>iOS 11.4</center></td><td><center>✓</center></td><td><center>✓</center></td><td><center>✕</center></td><td><center>✓</center></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git 使用 sparsecheckout 检出指定目录</title>
      <link href="/GitSparseCheckout.html"/>
      <url>/GitSparseCheckout.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>前言：该文参考<a href="https://blog.csdn.net/songjiaping/article/details/79469818">git下载克隆部分文件代码的方法</a></p></blockquote><h2 id="使用命令"><a href="#使用命令" class="headerlink" title="使用命令"></a>使用命令</h2><span id="more"></span><pre><code>mkdir finder # 新建目标文件夹cd finder # 进入文件夹git init # 初始化 git 文件夹git remote add -f origin GitAddress # 添加远程仓库git config core.sparsecheckout true # 使用 sparsecheckoutecho &quot;objectPath&quot; &gt;&gt; .git/info/sparse-checkout # 设置checkout的目录，可设置多个目录git checkout master # checkout</code></pre><h2 id="python脚本"><a href="#python脚本" class="headerlink" title="python脚本"></a>python脚本</h2><pre><code># -*- coding: utf-8 -*-import os#  Version 0.1.0### 使用说明：## 1.设置文件目录，默认为当前目录## 2.设置查出的目录## 3.设置Git仓库地址## 4.设置Git分支，默认为 master#=============（自定义区）=============# 设置文件目录，默认为当前目录finder_base = &quot;./sparsecheckout0.1.0&quot;# 设置查出的目录finder_checkout_paths = [&quot;Project1&quot;, &quot;Project3&quot;]# 设置Git仓库地址git_address = &quot;https://gitee.com/HertzWang/GitSparseCheckout.git&quot;# 设置Git分支，默认为 mastergit_branch = &quot;master&quot;#====================================# 查检本地目录def check_finder():    print (&#39;校验目录开始...&#39;)    if os.path.exists(finder_base):        os.system(&#39;rm -rf %s&#39; % finder_base)    os.system(&#39;mkdir %s&#39; % finder_base)    os.chdir(finder_base)    print (&#39;校验目录完成&#39;)# 设置 Gitdef git_setting():    print (&#39;开始设置 Git&#39;)    os.system(&#39;git init&#39;)    os.system(&#39;git remote add -f origin %s&#39; % git_address)    os.system(&#39;git config core.sparsecheckout true&#39;)    for path in finder_checkout_paths:        os.system(&#39;echo %s &gt;&gt; .git/info/sparse-checkout&#39; % path)    os.system(&#39;cat .git/info/sparse-checkout&#39;)    print (&#39;Git 设置完成&#39;)# 检出def git_checkout():    os.system(&#39;git checkout %s&#39; % git_branch)    os.system(&#39;open .&#39;)def main():    # 查检本地目录    check_finder()    # 设置 Git    git_setting()    # 检出    git_checkout()main()</code></pre>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS系统各版本发布说明</title>
      <link href="/iOSReleaseNotes.html"/>
      <url>/iOSReleaseNotes.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h3 id="iOS-11"><a href="#iOS-11" class="headerlink" title="iOS 11"></a>iOS 11</h3><table><thead><tr><th>版本</th><th>链接</th></tr></thead><tbody><tr><td>iOS 11.2 SDK Release Notes</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOS-11.2/index.html#//apple_ref/doc/uid/TP40017694">打开</a></td></tr><tr><td>iOS 11.1 SDK Release Notes</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOS-11.1/index.html#//apple_ref/doc/uid/TP40017683">打开</a></td></tr><tr><td>iOS 11 SDK Release Notes</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-11/index.html#//apple_ref/doc/uid/TP40017669">打开</a></td></tr></tbody></table><h3 id="iOS-10"><a href="#iOS-10" class="headerlink" title="iOS 10"></a>iOS 10</h3><table><thead><tr><th>版本</th><th>链接</th></tr></thead><tbody><tr><td>iOS SDK Release Notes for iOS 10.3</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-10.3/index.html#//apple_ref/doc/uid/TP40017612">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 10.2</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-10.2/index.html#//apple_ref/doc/uid/TP40017585">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 10.1</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-10.1/index.html#//apple_ref/doc/uid/TP40017562">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 10.0</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-10.0/index.html#//apple_ref/doc/uid/TP40017540">打开</a></td></tr></tbody></table><span id="more"></span><h3 id="iOS-9"><a href="#iOS-9" class="headerlink" title="iOS 9"></a>iOS 9</h3><table><thead><tr><th>版本</th><th>链接</th></tr></thead><tbody><tr><td>iOS SDK Release Notes for iOS 9.3</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-9.3/index.html#//apple_ref/doc/uid/TP40016779">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 9.2</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-9.2/index.html#//apple_ref/doc/uid/TP40016638">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 9.1</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-9.1/index.html#//apple_ref/doc/uid/TP40016570">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 9</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-9.0/index.html#//apple_ref/doc/uid/TP40016202">打开</a></td></tr></tbody></table><h3 id="iOS-8"><a href="#iOS-8" class="headerlink" title="iOS 8"></a>iOS 8</h3><table><thead><tr><th>版本</th><th>链接</th></tr></thead><tbody><tr><td>iOS SDK Release Notes for iOS 8.4</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-8.4/index.html#//apple_ref/doc/uid/TP40015246">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 8.3</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-8.3/index.html#//apple_ref/doc/uid/TP40015151">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 8.2</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-8.2/index.html#//apple_ref/doc/uid/TP40015020">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 8.1.1</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-8.1/index.html#//apple_ref/doc/uid/TP40014993">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 8.0 GM</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-8.0/index.html#//apple_ref/doc/uid/TP40014223">打开</a></td></tr></tbody></table><h3 id="iOS-7"><a href="#iOS-7" class="headerlink" title="iOS 7"></a>iOS 7</h3><table><thead><tr><th>版本</th><th>链接</th></tr></thead><tbody><tr><td>iOS SDK Release Notes for iOS 7.1</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-7.1/index.html#//apple_ref/doc/uid/TP40013935">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 7 GM</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-7.0/index.html#//apple_ref/doc/uid/TP40013202">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 6.1</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-6_1/index.html#//apple_ref/doc/uid/TP40012869">打开</a></td></tr></tbody></table><h3 id="iOS-6及以前"><a href="#iOS-6及以前" class="headerlink" title="iOS 6及以前"></a>iOS 6及以前</h3><table><thead><tr><th>版本</th><th>链接</th></tr></thead><tbody><tr><td>iOS SDK Release Notes for iOS 6</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-6_0/index.html#//apple_ref/doc/uid/TP40012166">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 5.1</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-5_1/index.html#//apple_ref/doc/uid/TP40011329">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 5.0</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-5_0/index.html#//apple_ref/doc/uid/TP40010949">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 4.3.2</td><td><a href="https://developer.apple.com/library/content/releasenotes/Miscellaneous/RN-iOSSDK-4_3_2/index.html#//apple_ref/doc/uid/TP40010884">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 4.3</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-4_3/index.html#//apple_ref/doc/uid/TP40010565">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 4.2</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iOSSDK-4_2/index.html#//apple_ref/doc/uid/TP40010243">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 4.1</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iPhoneSDK-4_1/index.html#//apple_ref/doc/uid/TP40010153">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 4.0.2</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iPhone-4_0_2/index.html#//apple_ref/doc/uid/TP40010239">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 4</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iPhoneSDK-4_0/index.html#//apple_ref/doc/uid/TP40009763">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 3.2</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iPhoneSDK-3_2/index.html#//apple_ref/doc/uid/TP40009477">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 3.1</td><td><a href="https://developer.apple.com/library/content/releasenotes/General/RN-iPhoneSDK-3/index.html#//apple_ref/doc/uid/TP40008407">打开</a></td></tr><tr><td>iOS SDK Release Notes for iOS 2.2</td><td><a href="https://developer.apple.com/library/content/releasenotes/iPhone/RN-iPhoneSDK/index.html#//apple_ref/doc/uid/TP40007428">打开</a></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Core Graphics</title>
      <link href="/iOSCoreGraphics.html"/>
      <url>/iOSCoreGraphics.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>本文参考</p><p> <a href="https://zhuanlan.zhihu.com/p/27798398">iOS绘图技术（一、简单介绍和绘制视图）</a></p><p> <a href="https://mp.weixin.qq.com/s?__biz=MjM5OTM0MzIwMQ==&mid=2652551125&idx=3&sn=d664030238d0d8f29ce42e1e08833ce4&chksm=bcd2f2db8ba57bcd173aa7a823b8043c4798d3e0a6e6d800e0f845ef76dff5930ba9904d1bd1&scene=27&open_source=weibo_search">iOS绘图框架CoreGraphics分析</a></p></blockquote><h2 id="简要说明"><a href="#简要说明" class="headerlink" title="简要说明"></a>简要说明</h2><ul><li>iOS 在运行循环中会整合所有的绘图请求，并一次性将它们绘制出来</li><li>不能在子线程中绘制，也不能进行复杂操作，否则会造成主线程卡顿</li><li>调用 UIView 的 drawRect: / draw(_:) 方法进行绘制</li><li><code>setNeedsDisplay</code> 该方法标记为<strong>整个视图</strong>重新绘制，并且会在下一次绘制周期中重新绘制，自动调用 drawRect: / draw(_:)方法</li><li><code>setNeedsDisplayInRect:</code> 该方法标记为<strong>视图部分区域</strong>重新绘制，周期同上。从绘制带来的开销角度，不推荐整个视图的重新绘制。</li></ul><h2 id="UIKit部分"><a href="#UIKit部分" class="headerlink" title="UIKit部分"></a>UIKit部分</h2><blockquote><p>UIKit是高级的图形接口，它的 API 都是基于 Objective-C的。它能够访问绘图、动画、字体、图片等内容。</p></blockquote><span id="more"></span><h3 id="填充、描边"><a href="#填充、描边" class="headerlink" title="填充、描边"></a>填充、描边</h3><p>代码示例：</p><pre><code>override func draw(_ rect: CGRect) &#123;    // Drawing code        // 填充    /// 方式一    UIColor.brown.setFill() // UIKit，将当前的图形上下文设置要填充的颜色    UIRectFill(rect) // UIKit，填充矩形        /// 方式二：路径形式填充    let p = UIBezierPath.init(roundedRect: CGRect.init(x: 120, y: 120, width: 40, height: 40), cornerRadius: 5)    UIColor.red.setFill()    p.fill()        // 描边    /// 方式一    UIColor.white.setStroke() // UIKit，描边    let frame = CGRect.init(x: 20, y: 30, width: 100, height: 300)    UIRectFrame(frame)        /// 方式二：路径形式描边    let b = UIBezierPath.init(roundedRect: CGRect.init(x: 120, y: 170, width: 40, height: 40), cornerRadius: 5)    UIColor.red.setStroke()    b.stroke()            // 画横线    let space: CGFloat = 44.0    var lineFrame = CGRect.init(x: 0, y: 350, width: rect.width, height: 1)    UIColor.green.setFill()        for _ in 1...4 &#123;        UIRectFill(lineFrame)          //UIRectFrame(lineFrame)                lineFrame.origin.y += space    &#125;    &#125;</code></pre><p>仅供参考的个人理解：</p><ul><li>简单矩形填充可用 <code>setFill</code> 和 <code>UIRectFill</code> 结合使用</li><li>简单矩形描边可用 <code>setStroke</code> 和 <code>UIRectFrame</code> 结合使用</li><li>复杂图像可以用 <code>UIBezierPath</code> 设置路径来进行填充、描边</li><li><code>UIBezierPath</code> 比较灵活一些</li></ul><h3 id="UIImage绘制图像、NSString绘制文本"><a href="#UIImage绘制图像、NSString绘制文本" class="headerlink" title="UIImage绘制图像、NSString绘制文本"></a>UIImage绘制图像、NSString绘制文本</h3><p>代码示例：</p><pre><code>override func draw(_ rect: CGRect) &#123;    // Drawing code        // UIImage绘制图像    if let image = UIImage.init(named: &quot;dog&quot;) &#123;        let imageReact = CGRect.init(origin: CGPoint.init(x: 150, y: 150), size: image.size)        image.draw(in: imageReact) // 注意图片的原始size        //image.draw(in: imageReact, blendMode: .normal, alpha: 0.9)        //image.draw(at: imagePoint) // 从某个点开始        //image.draw(at: imagePoint, blendMode: .normal, alpha: 1.0)    &#125;        // NSString绘制文字    let dogString = NSString.init(string: &quot;小狗&quot;)    let font = UIFont.systemFont(ofSize: 34)        let attr = [NSAttributedStringKey.font : font]        dogString.draw(at: CGPoint.init(x: 150, y: 150), withAttributes: attr)     //dogString.draw(in: &lt;#T##CGRect#&gt;, withAttributes: &lt;#T##[NSAttributedStringKey : Any]?#&gt;)&#125;</code></pre><p>仅供参考的个人理解：</p><ul><li>绘制图片、文本，可以设置起点，也可以设置size</li><li>图片绘制需要考虑原始的size</li></ul><h3 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h3><h4 id="九九乘法表"><a href="#九九乘法表" class="headerlink" title="九九乘法表"></a>九九乘法表</h4><p>参考代码如下，如有更好的代码请联系我，非常感谢！</p><pre><code>class MultiplicationTableView: UIView &#123;        override func draw(_ rect: CGRect) &#123;        // Drawing code                let width = UIScreen.main.bounds.width        let height = width * 3.0 / 5.0 // 5:3        let itemWidth = (width - 20.0) / 9.0        let itemHeight = height / 9.0                // 设置背景        UIColor.white.setFill()        UIRectFill(rect)        // 乘法表内容        var strRect = CGRect.zero        var strAttr = [NSAttributedStringKey:Any]()        strAttr[NSAttributedStringKey.font] = UIFont.systemFont(ofSize: 7)                let style = NSMutableParagraphStyle()        style.alignment = .center        strAttr[NSAttributedStringKey.paragraphStyle] = style            for x in 1...9 &#123;            for y in 1...9 &#123;                guard y &lt;= x else &#123;                    break                &#125;                let stringChinese = NSString.init(string: &quot;\(y.chinese)\(x.chinese)\((x*y).resultChinese)&quot;)                let string = NSString.init(string: &quot;\(y)x\(x)=\(x*y)\n\(stringChinese)&quot;)                debugPrint(&quot;\(string)&quot;)                                strRect = CGRect.init(x: CGFloat(y-1) * itemWidth - CGFloat(y), y: CGFloat(x-1) * itemHeight - CGFloat(x), width: itemWidth, height: itemHeight)                                // 背景                UIColor.init(red: CGFloat(150+y*10)/255.0, green: CGFloat(100+y*10)/255.0, blue: CGFloat(60+y*10)/255.0, alpha: 1.0).setFill()                UIRectFill(strRect)                                // 内容                let strSize = string.size(withAttributes: strAttr)                let topMargin = (itemHeight - strSize.height) * 0.5                let stringRect = CGRect.init(x: strRect.minX, y: strRect.minY + topMargin, width: itemWidth, height: itemHeight)                string.draw(in: stringRect, withAttributes: strAttr)                                // 边框                UIRectFrame(strRect)            &#125;        &#125;    &#125;&#125;extension Int &#123;    var chinese: String &#123;        get &#123;            switch self &#123;            case 1:                return &quot;一&quot;            case 2:                return &quot;二&quot;            case 3:                return &quot;三&quot;            case 4:                return &quot;四&quot;            case 5:                return &quot;五&quot;            case 6:                return &quot;六&quot;            case 7:                return &quot;七&quot;            case 8:                return &quot;八&quot;            case 9:                return &quot;九&quot;            default:                return &quot;&quot;            &#125;        &#125;    &#125;        var resultChinese: String &#123;        get &#123;                        if self &lt; 10 &#123;                // 小于10： 得X                return &quot;得\(self.chinese)&quot;            &#125; else &#123;                if self%10 == 0 &#123;                    // 个位为0： X十                    return &quot;\((self/10).chinese)十&quot;                &#125; else if self &lt; 20 &#123;                    // 十位为1：十X                    return &quot;十\((self-10).chinese)&quot;                &#125; else &#123;                    // X十Y                    let unit = self%10                    let decade = (self-unit)/10                    return &quot;\(decade.chinese)十\(unit.chinese)&quot;                &#125;            &#125;        &#125;    &#125;&#125;</code></pre><h4 id="随机验证码"><a href="#随机验证码" class="headerlink" title="随机验证码"></a>随机验证码</h4><p>参考代码如下，如有更好的代码请联系我，非常感谢！</p><pre><code>////  VerificationCodeView.swift//  CoreGraphicsDemo01////  Created by HertzWang on 2018/1/19.//  Copyright © 2018年 HertzWang. All rights reserved.//import UIKitclass VerificationCodeView: UIView &#123;    private let items = [&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;]        private let count: Int = 4        override func draw(_ rect: CGRect) &#123;        // Drawing code                // 设置背景        UIColor.init(red: CGFloat(arc4random_uniform(UInt32(80)))/255.0, green: CGFloat(arc4random_uniform(UInt32(125)))/255.0, blue: CGFloat(arc4random_uniform(UInt32(255)))/255.0, alpha: 1.0).setFill()        UIRectFill(rect)                // 设置内容        let itemWidth = rect.width / CGFloat(count)        for index in 0..&lt;count &#123;            let random = Int(arc4random_uniform(UInt32(self.items.count)))            let item = NSString.init(string: self.items[random])            let attr = [NSAttributedStringKey.font: UIFont.systemFont(ofSize: 18),                        NSAttributedStringKey.foregroundColor: UIColor.init(red: CGFloat(arc4random_uniform(UInt32(80)))/255.0, green: CGFloat(arc4random_uniform(UInt32(125)))/255.0, blue: CGFloat(arc4random_uniform(UInt32(255)))/255.0, alpha: 1.0) ]                        var point = CGPoint.init(x: itemWidth * CGFloat(index), y: 0)            point.x += CGFloat(arc4random_uniform(UInt32(itemWidth-18)))            point.y += CGFloat(arc4random_uniform(UInt32(rect.height-18)))                        item.draw(at: point, withAttributes: attr)                    &#125;    &#125;        override init(frame: CGRect) &#123;        super.init(frame: frame)                addGestureRecognizer(UITapGestureRecognizer.init(target: self, action: #selector(refreshCode)))    &#125;        required init?(coder aDecoder: NSCoder) &#123;        fatalError(&quot;init(coder:) has not been implemented&quot;)    &#125;        @objc private func refreshCode() &#123;        setNeedsDisplay()    &#125;&#125;</code></pre><h3 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h3><blockquote><p>上述的操作只能在 UIView 的 drawRect: / draw(_:) 中绘制，现在说下在其它位置的写法</p></blockquote><h4 id="图片绘制"><a href="#图片绘制" class="headerlink" title="图片绘制"></a>图片绘制</h4><p>示例代码：</p><pre><code>override func viewDidLoad() &#123;    super.viewDidLoad()    // Do any additional setup after loading the view, typically from a nib.        // 绘制图片    /// 1. 获取图片上下文    UIGraphicsBeginImageContextWithOptions(CGSize.init(width: 100, height: 100), false, 0) // size 可用理解为画布    /// 2. 绘制    let p = UIBezierPath.init(ovalIn: CGRect.init(x: 0, y: 0, width: 100, height: 100)) // 设置路径，在画布中的frame    UIColor.red.setFill() // 设置填充颜色    p.fill() // 填充        /// 3.1. 从上下文中获取绘制的图片    if let image = UIGraphicsGetImageFromCurrentImageContext() &#123;        /// 3.2. 添加到视图上        let imageView = UIImageView.init(image: image)        imageView.frame = CGRect.init(origin: CGPoint.zero, size: image.size)        self.view.addSubview(imageView)    &#125;        /// 4. 关闭上下文    UIGraphicsEndImageContext()&#125;</code></pre><h2 id="Core-Graphics-Quartz-2D-部分"><a href="#Core-Graphics-Quartz-2D-部分" class="headerlink" title="Core Graphics/Quartz 2D 部分"></a>Core Graphics/Quartz 2D 部分</h2><h3 id="drawRect"><a href="#drawRect" class="headerlink" title="drawRect:"></a>drawRect:</h3><p>示例代码：</p><pre><code>override func draw(_ rect: CGRect) &#123;    // Drawing code        // Core Graphics    if let con = UIGraphicsGetCurrentContext() &#123; // 获取上下文（画布）        /// 矩形填充        con.addRect(CGRect.init(x: 120, y: 100, width: 100, height: 100))        con.setFillColor(UIColor.green.cgColor)        con.fillPath()                /// 圆形描边        con.addEllipse(in:CGRect.init(x: 120, y: 300, width: 100, height: 100))        con.setStrokeColor(red: 255, green: 0, blue: 0, alpha: 1)        con.strokePath()    &#125;&#125;</code></pre><h3 id="图片上下文"><a href="#图片上下文" class="headerlink" title="图片上下文"></a>图片上下文</h3><p>示例代码：</p><pre><code>override func viewDidLoad() &#123;    super.viewDidLoad()    // Do any additional setup after loading the view, typically from a nib.        // 使用 Core Graphics 绘制图片    /// 1. 获取上下文    UIGraphicsBeginImageContext(CGSize.init(width: 100, height: 100)) // 画布size，超出部分不显示    /// 2. 绘制图片    if let con = UIGraphicsGetCurrentContext() &#123;          //con.addEllipse(in: CGRect.init(x: 0, y: 0, width: 100, height: 100)) // 圆形        con.addRect(CGRect.init(x: 0, y: 0, width: 100, height: 100)) // 矩形        con.setFillColor(UIColor.green.cgColor)        con.fillPath()        /// 3.1 获取图片        if let image = UIGraphicsGetImageFromCurrentImageContext() &#123;            /// 3.2 添加到视图            let imageView = UIImageView.init(image: image)            imageView.frame = CGRect.init(origin: CGPoint.zero, size: image.size)            self.view.addSubview(imageView)        &#125;    &#125;        /// 4. 关闭图片上下文    UIGraphicsEndImageContext()&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS 快速获取设备信息</title>
      <link href="/iOSDeviceExtension.html"/>
      <url>/iOSDeviceExtension.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>前言：在开发中需要统计用户信息，如设备的型号、iOS版本等，将其封装。</p><p>参考<a href="https://github.com/976500133/UIDevice-Extension">UIDevice-Extension</a>、<a href="https://www.theiphonewiki.com/wiki/Models">设备型号</a></p></blockquote><p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><pre><code>UIDevice.current.deviceModelUIDevice.current.deviceFamily// ...</code></pre><span id="more"></span><h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h2><h3 id="Swift"><a href="#Swift" class="headerlink" title="Swift"></a>Swift</h3><pre><code>extension UIDevice &#123;    //设备码 : iPhone7,2, iPhone6,1, ...    public var deviceCode: String &#123;        var sysInfo: [CChar] = Array.init(repeating: 0, count: MemoryLayout.size(ofValue: utsname()))                let code = sysInfo.withUnsafeMutableBufferPointer &#123; ( ptr: inout UnsafeMutableBufferPointer&lt;CChar&gt;) -&gt; String in                        guard let pointer = ptr.baseAddress?.withMemoryRebound(to: utsname.self, capacity: 1, &#123; ptr in                return ptr            &#125;) else &#123;                return &quot;&quot;            &#125;            uname(pointer)            let machinePtr = ptr.baseAddress?.advanced(by: Int(_SYS_NAMELEN * 4))                        return String.init(cString: machinePtr!)        &#125;                return code    &#125;        // 设备是什么  iPhone,iPad, ...    public var deviceFamily: String &#123;        return UIDevice.current.model    &#125;        // 设备型号 参考：https://www.theiphonewiki.com/wiki/Models    public var deviceModel: String &#123;                var model : String        let deviceCode = UIDevice().deviceCode        switch deviceCode &#123;                    case &quot;iPod1,1&quot;:                                 model = &quot;iPod Touch 1G&quot;        case &quot;iPod2,1&quot;:                                 model = &quot;iPod Touch 2G&quot;        case &quot;iPod3,1&quot;:                                 model = &quot;iPod Touch 3G&quot;        case &quot;iPod4,1&quot;:                                 model = &quot;iPod Touch 4G&quot;        case &quot;iPod5,1&quot;:                                 model = &quot;iPod Touch 5G&quot;        case &quot;iPod7,1&quot;:                                 model = &quot;iPod Touch 6G&quot;                    case &quot;iPhone1,1&quot;:                               model = &quot;iPhone 2G&quot;        case &quot;iPhone1,2&quot;:                               model = &quot;iPhone 3G&quot;        case &quot;iPhone2,1&quot;:                               model = &quot;iPhone 3GS&quot;        case &quot;iPhone3,1&quot;, &quot;iPhone3,2&quot;, &quot;iPhone3,3&quot;:     model = &quot;iPhone 4&quot;        case &quot;iPhone3,1&quot;, &quot;iPhone3,2&quot;, &quot;iPhone3,3&quot;:     model = &quot;iPhone 4&quot;        case &quot;iPhone4,1&quot;:                               model = &quot;iPhone 4S&quot;        case &quot;iPhone5,1&quot;, &quot;iPhone5,2&quot;:                  model = &quot;iPhone 5&quot;        case &quot;iPhone5,3&quot;, &quot;iPhone5,4&quot;:                  model = &quot;iPhone 5C&quot;        case &quot;iPhone6,1&quot;, &quot;iPhone6,2&quot;:                  model = &quot;iPhone 5S&quot;        case &quot;iPhone7,2&quot;:                               model = &quot;iPhone 6&quot;        case &quot;iPhone7,1&quot;:                               model = &quot;iPhone 6 Plus&quot;        case &quot;iPhone8,1&quot;:                               model = &quot;iPhone 6S&quot;        case &quot;iPhone8,2&quot;:                               model = &quot;iPhone 6S Plus&quot;        case &quot;iPhone8,4&quot;:                               model = &quot;iPhone SE&quot;        case &quot;iPhone9,1&quot;, &quot;iPhone9,3&quot;:                  model = &quot;iPhone 7&quot;        case &quot;iPhone9,2&quot;, &quot;iPhone9,4&quot;:                  model = &quot;iPhone 7 Plus&quot;        case &quot;iPhone10,1&quot;, &quot;iPhone10,4&quot;:                model = &quot;iPhone 8&quot;        case &quot;iPhone10,2&quot;, &quot;iPhone10,5&quot;:                model = &quot;iPhone 8 Plus&quot;        case &quot;iPhone10,3&quot;, &quot;iPhone10,6&quot;:                model = &quot;iPhone X&quot;                    case &quot;iPad1,1&quot;:                                 model = &quot;iPad 1&quot;        case &quot;iPad2,1&quot;, &quot;iPad2,2&quot;, &quot;iPad2,3&quot;, &quot;iPad2,4&quot;:model = &quot;iPad 2&quot;        case &quot;iPad3,1&quot;, &quot;iPad3,2&quot;, &quot;iPad3,3&quot;:           model = &quot;iPad 3&quot;        case &quot;iPad3,4&quot;, &quot;iPad3,5&quot;, &quot;iPad3,6&quot;:           model = &quot;iPad 4&quot;        case &quot;iPad4,1&quot;, &quot;iPad4,2&quot;, &quot;iPad4,3&quot;:           model = &quot;iPad Air&quot;        case &quot;iPad5,1&quot;, &quot;iPad5,3&quot;, &quot;iPad5,4&quot;:           model = &quot;iPad Air 2&quot;        case &quot;iPad2,5&quot;, &quot;iPad2,6&quot;, &quot;iPad2,7&quot;:           model = &quot;iPad Mini&quot;        case &quot;iPad4,4&quot;, &quot;iPad4,5&quot;, &quot;iPad4,6&quot;:           model = &quot;iPad Mini 2&quot;        case &quot;iPad4,7&quot;, &quot;iPad4,8&quot;, &quot;iPad4,9&quot;:           model = &quot;iPad Mini 3&quot;        case &quot;iPad5,1&quot;, &quot;iPad5,2&quot;:                      model = &quot;iPad Mini 4&quot;        case &quot;iPad6,7&quot;, &quot;iPad6,8&quot;:                      model = &quot;iPad Pro&quot;                    case &quot;i386&quot;, &quot;x86_64&quot;:                          model = &quot;Simulator&quot;        default:                                        model = deviceCode //If unkhnown        &#125;                return model    &#125;        // 获取设备型号方式2，设备型号不全！    //    public var deviceModel2: String &#123;    //        let name = UnsafeMutablePointer&lt;utsname&gt;.allocate(capacity: 1)    //        uname(name)    //        let machine = withUnsafePointer(to: &amp;name.pointee.machine, &#123; (ptr) -&gt; String? in    //    //            let int8Ptr = unsafeBitCast(ptr, to: UnsafePointer&lt;CChar&gt;.self)    //            return String.init(cString: int8Ptr)    //        &#125;)    //        name.deallocate(capacity: 1)    //        if let deviceString = machine &#123;    //            switch deviceString &#123;    //            //iPhone    //            case &quot;iPhone1,1&quot;:                return &quot;iPhone 1G&quot;    //            case &quot;iPhone1,2&quot;:                return &quot;iPhone 3G&quot;    //            case &quot;iPhone2,1&quot;:                return &quot;iPhone 3GS&quot;    //            case &quot;iPhone3,1&quot;, &quot;iPhone3,2&quot;:   return &quot;iPhone 4&quot;    //            case &quot;iPhone4,1&quot;:                return &quot;iPhone 4S&quot;    //            case &quot;iPhone5,1&quot;, &quot;iPhone5,2&quot;:   return &quot;iPhone 5&quot;    //            case &quot;iPhone5,3&quot;, &quot;iPhone5,4&quot;:   return &quot;iPhone 5C&quot;    //            case &quot;iPhone6,1&quot;, &quot;iPhone6,2&quot;:   return &quot;iPhone 5S&quot;    //            case &quot;iPhone7,1&quot;:                return &quot;iPhone 6 Plus&quot;    //            case &quot;iPhone7,2&quot;:                return &quot;iPhone 6&quot;    //            case &quot;iPhone8,1&quot;:                return &quot;iPhone 6s&quot;    //            case &quot;iPhone8,2&quot;:                return &quot;iPhone 6s Plus&quot;    //            case &quot;iPhone8,4&quot;:                return &quot;iPhone SE&quot;    //            case &quot;iPhone9,1&quot;:                return &quot;iPhone 7&quot;    //            case &quot;iPhone9,2&quot;:                return &quot;iPhone 7 Plus&quot;    //            case &quot;iPhone10,1&quot;:                return &quot;iPhone 8&quot;    //            case &quot;iPhone10,4&quot;:                return &quot;iPhone 8&quot;    //            case &quot;iPhone10,2&quot;:                return &quot;iPhone 8 Plus&quot;    //            case &quot;iPhone10,5&quot;:                return &quot;iPhone 8 Plus&quot;    //            case &quot;iPhone10,3&quot;:                return &quot;iPhone X&quot;    //            case &quot;iPhone10,6&quot;:                return &quot;iPhone X&quot;    //    //            case &quot;iPad3,1&quot;:                 return &quot;iPad 3&quot;    //            case &quot;iPad3,2&quot;:                 return &quot;iPad 3&quot;    //            case &quot;iPad3,3&quot;:                 return &quot;iPad 3&quot;    //    //            case &quot;iPad3,4&quot;:                 return &quot;iPad 4&quot;    //            case &quot;iPad3,5&quot;:                 return &quot;iPad 4&quot;    //            case &quot;iPad3,6&quot;:                 return &quot;iPad 4&quot;    //            case &quot;iPad4,1&quot;:                 return &quot;iPad Air&quot;    //            case &quot;iPad4,2&quot;:                 return &quot;iPad Air&quot;    //            case &quot;iPad4,3&quot;:                 return &quot;iPad Air&quot;    //            default:    //                return deviceString    //            &#125;    //        &#125; else &#123;    //            return &quot;&quot;    //        &#125;    //    &#125;        //IOS 版本号    public var deviceIOSVersion: String &#123;        return UIDevice.current.systemVersion    &#125;        //设备屏宽高    public var deviceScreenWidth: CGFloat &#123;        let screenSize: CGRect = UIScreen.main.bounds        let width = screenSize.width;        return width    &#125;    public var deviceScreenHeight: CGFloat &#123;        let screenSize: CGRect = UIScreen.main.bounds        let height = screenSize.height;        return height    &#125;        //小于5S 的设备    public var lessIphone5S : Bool &#123;                switch UIDevice().deviceModel &#123;        case &quot;iPhone 4&quot; , &quot;iPhone 4S&quot; , &quot;iPhone 5&quot; , &quot;iPhone 5C&quot; ,&quot;iPhone 5S&quot; :            return true        default : break        &#125;        return false    &#125;            //设备方向    public var deviceOrientationString: String &#123;        var orientation : String        switch UIDevice.current.orientation&#123;        case .portrait:            orientation=&quot;Portrait&quot;        case .portraitUpsideDown:            orientation=&quot;Portrait Upside Down&quot;        case .landscapeLeft:            orientation=&quot;Landscape Left&quot;        case .landscapeRight:            orientation=&quot;Landscape Right&quot;        case .faceUp:            orientation=&quot;Face Up&quot;        case .faceDown:            orientation=&quot;Face Down&quot;        default:            orientation=&quot;Unknown&quot;        &#125;        return orientation    &#125;            // 设备方向 Landscape Portrait    public var isDevicePortrait: Bool &#123;        return UIDevice.current.orientation.isPortrait    &#125;    public var isDeviceLandscape: Bool &#123;        return UIDevice.current.orientation.isLandscape    &#125;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 python 脚本更改图片大小</title>
      <link href="/PythonImageSize.html"/>
      <url>/PythonImageSize.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>前言：</p><p>方便icon出图，采用 Python 交付自动生成。</p><p>参考文章<a href="http://blog.csdn.net/danation/article/details/76522151">[Python]改变图片的分辨率大小</a></p></blockquote><p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h2><ol><li>python 环境</li><li>python 图像处理库 pillow 支持</li></ol><h2 id="python脚本"><a href="#python脚本" class="headerlink" title="python脚本"></a>python脚本</h2><pre><code>#coding=utf-8import os  # 打开文件时需要from PIL import Image # 图片处理# 设置原图路径icon_path = &#39;./icon.png&#39;# 生成像素列表pixel_array = [480, 240, 180, 171, 120, 167, 152, 144, 114, 108, 87, 80, 76, 72, 60, 58, 40, 28]# 校验原图是否为 512 x 512 pxdef check_icon():    if os.path.exists(icon_path) == False:        os.system(&#39;操作失败：未找到原图片&#39;)    else:        print(&#39;校验原图像素...&#39;)        im = Image.open(icon_path)        width = im.size[0]        height = im.size[1]        if (width == 512 and height == 512):            out_image()        else:            print(&#39;操作失败：原图需要512x512像素&#39;)# 输出不同像素def out_image():    print(&#39;生成中...&#39;)    im = Image.open(icon_path)    for pixel in pixel_array:        w_new = pixel        h_new = pixel        out = im.resize((w_new, h_new), Image.ANTIALIAS)        new_path = &#39;./icon%sx%s.png&#39; % (w_new, h_new)        out.save(new_path)    print(&#39;完成&#39;)    os.system(&#39;open .&#39;)def main():    check_icon()main()</code></pre><span id="more"></span><h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><h3 id="ImportError-No-module-named-PIL"><a href="#ImportError-No-module-named-PIL" class="headerlink" title="ImportError: No module named PIL"></a>ImportError: No module named PIL</h3><p>终端执行 <code>sudo pip install pillow</code></p><h3 id="ImportError-No-module-named-pip"><a href="#ImportError-No-module-named-pip" class="headerlink" title="ImportError: No module named pip"></a>ImportError: No module named pip</h3><p>执行 <code>sudo easy_install pip</code> 安装，参考 <a href="https://stackoverflow.com/questions/17271319/how-do-i-install-pip-on-macos-or-os-x">How do I install pip on macOS or OS X?</a></p>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在Ubuntu中搭建ss服务端</title>
      <link href="/ssserverForUbuntu.html"/>
      <url>/ssserverForUbuntu.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>前提：有一个非位于大陆的云主机</p><p>示例环境：Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-1045-aws x86_64)</p></blockquote><h2 id="安装-Shadowsocks"><a href="#安装-Shadowsocks" class="headerlink" title="安装 Shadowsocks"></a>安装 Shadowsocks</h2><p>在<code>Ubuntu</code>下安装<code>SS</code>比较简单，执行以下命令即可：</p><ol><li>更新软件包： <code>$ sudo apt-get update</code> </li><li>安装 python-pip 运行 环境：<code>$ sudo apt-get install python3-pip</code></li><li>安装 shadowsocks 服务端： <code>$ sudo pip3 install https://github.com/shadowsocks/shadowsocks/archive/master.zip</code></li></ol><h2 id="配置信息"><a href="#配置信息" class="headerlink" title="配置信息"></a>配置信息</h2><p>开放端口：<code>$ sudo ufw allow 8389</code></p><p>执行 <code>sudo vi /etc/shadowsocks.json</code>，并输入以下信息：</p><!----><pre><code>&#123;    &quot;server&quot;:&quot;0.0.0.0&quot;,    &quot;local_address&quot;: &quot;127.0.0.1&quot;,    &quot;local_port&quot;:1081,    &quot;timeout&quot;:300,    &quot;method&quot;:&quot;aes-256-gcm&quot;,    &quot;port_password&quot;:&#123;        &quot;8380&quot;:&quot;Ss@8380&quot;,        &quot;8381&quot;:&quot;Ss@8381&quot;,        &quot;8382&quot;:&quot;Ss@8382&quot;,        &quot;8383&quot;:&quot;Ss@8383&quot;,        &quot;8384&quot;:&quot;Ss@8384&quot;,        &quot;8385&quot;:&quot;Ss@8385&quot;    &#125;&#125;</code></pre><h2 id="启动与停止"><a href="#启动与停止" class="headerlink" title="启动与停止"></a>启动与停止</h2><p><code>$ sudo ssserver -c /etc/shadowsocks.json -d start</code><br><code>$ sudo ssserver -c /etc/shadowsocks.json -d stop</code></p><h2 id="ping-IP-Request-timeout"><a href="#ping-IP-Request-timeout" class="headerlink" title="ping IP Request timeout"></a>ping IP Request timeout</h2><p>AWS 安全组编辑入站规则，添加“所有流量”</p>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Print </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hackintosh-EFI</title>
      <link href="/Hackintosh-EFI.html"/>
      <url>/Hackintosh-EFI.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h1 id="Windows读写EFI分区"><a href="#Windows读写EFI分区" class="headerlink" title="Windows读写EFI分区"></a>Windows读写EFI分区</h1><h2 id="挂载分区"><a href="#挂载分区" class="headerlink" title="挂载分区"></a>挂载分区</h2><ol><li>以管理员方式打开<code>cmd</code>： <code>windows + x</code>选择管理员打开</li><li><code>diskpart</code> // 进入磁盘管理</li><li><code>list disk</code> // 查看电脑所有磁盘</li><li><code>select disk 0</code> // 根据磁盘编号选择磁盘</li><li><code>list partition</code> // 查看改磁盘下所有分区</li><li><code>select partition 0</code> // 根据分区编号选择分区</li><li><code>assign letter=x</code> // 以 x 盘符挂载分区</li><li><code>exit</code> // 退出磁盘管理</li></ol><span id="more"></span><h2 id="修改-EFI"><a href="#修改-EFI" class="headerlink" title="修改 EFI"></a>修改 EFI</h2><ol><li>以管理员方式打开<code>cmd</code>： <code>windows + x</code>选择管理员打开</li><li><code>notepad</code> // 打开一个txt文本</li><li>选择<code>文件</code>–&gt;<code>打开</code>，在改文件浏览界面操作</li></ol>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Print </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>App Icon 和 Launch Screen 尺寸</title>
      <link href="/iOSIconAndLaunch.html"/>
      <url>/iOSIconAndLaunch.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="Launch-Screen"><a href="#Launch-Screen" class="headerlink" title="Launch Screen"></a>Launch Screen</h2><blockquote><p>参考： <a href="https://developer.apple.com/design/human-interface-guidelines/ios/visual-design/adaptivity-and-layout/">开发者官网</a></p></blockquote><h3 id="iPhone"><a href="#iPhone" class="headerlink" title="iPhone"></a>iPhone</h3><table><thead><tr><th>设备</th><th>尺寸</th><th>对角线</th></tr></thead><tbody><tr><td>iPhone 14 Pro Max</td><td>430x932 pt (1290x2796 px @3x)</td><td>6.7 英寸</td></tr><tr><td>iPhone 14 Plus<br>iPhone 13 Pro Max<br>iPhone 12 Pro Max</td><td>428x926 pt (1284x2778 px @3x)</td><td>6.7 英寸</td></tr><tr><td>iPhone 14/14 Pro<br>iPhone 13/13 Pro<br>iPhone 12/12 Pro</td><td>390x844 pt (1170x2532 px @3x)</td><td>6.1 英寸</td></tr><tr><td>iPhone 13 mini<br>iPhone 12 mini</td><td>375x812 pt (1080x2340 px @3x)</td><td>5.4 英寸</td></tr><tr><td>iPhone 11 Pro Max<br>iPhone XS Max</td><td>414x896 pt (1242x2688 px @3x)</td><td>6.5 英寸</td></tr><tr><td>iPhone 11 Pro<br>iPhone XS<br>iPhone X</td><td>375x812 pt (1125x2436 px @3x)</td><td>5.8 英寸</td></tr><tr><td>iPhone 11<br>iPhone XR</td><td>414x896 pt (828x1792 px @2x)</td><td>6.1 英寸</td></tr><tr><td>iPhone 8 Plus<br>iPhone 7 Plus<br>iPhone 6s Plus<br>iPhone 6 Plus</td><td>414x736 pt (1080x1920 px @3x)</td><td>5.5 英寸</td></tr><tr><td>iPhone 8/7/6s/6<br>iPhone SE(第三代)<br>iPhone SE(第二代)</td><td>375x667 pt (750x1334 px @2x)</td><td>4.7 英寸</td></tr><tr><td>iPhone SE/5s/5</td><td>320x568 pt (640x1136 px @2x)</td><td>4 英寸</td></tr><tr><td>iPhone 4s/4</td><td>320x480 pt (640x960 px @2x)</td><td>3.5 英寸</td></tr></tbody></table><p>注：判断设备像素时使用 pt x 倍数，在5.4、5.5英寸的设备上宽度缩至1080px</p><blockquote><p>Assets LaunchImage</p></blockquote><table><thead><tr><th>环境</th><th>方向</th><th>尺寸</th></tr></thead><tbody><tr><td><center>iPhone X <br> iOS 11+ </center></td><td>竖屏</td><td>1125px × 2436px</td></tr><tr><td><center>Retina HD 5.5 <br> iOS 8,9 </center></td><td>竖屏</td><td>1242px × 2208px</td></tr><tr><td><center>Retina HD 4.7 <br> iOS 8,9 </center></td><td>竖屏</td><td>750px x 1334px</td></tr><tr><td><center>1x iPhone <br> iOS 5,6 </center></td><td>竖屏</td><td>320px x 480px</td></tr><tr><td><center>2x iPhone <br> iOS 5,6/7-9 </center></td><td>竖屏</td><td>640px x 960px</td></tr><tr><td><center>Retina 4 iPhone <br> iOS 5,6/7-9 </center></td><td>竖屏</td><td>640px x 1136px</td></tr><tr><td><center>iPhone X  <br> iOS 11+ </center></td><td>横屏</td><td>2436px × 1125px</td></tr><tr><td><center>Retina HD 5.5 <br> iOS 8,9 </center></td><td>横屏</td><td>2208px x 1242px</td></tr></tbody></table><h3 id="iPad"><a href="#iPad" class="headerlink" title="iPad"></a>iPad</h3><table><thead><tr><th>设备</th><th>竖屏</th><th>横屏</th></tr></thead><tbody><tr><td>12.9” iPad Pro</td><td>2048px × 2732px</td><td>2732px × 2048px</td></tr><tr><td>10.5” iPad Pro</td><td>1668px × 2224px</td><td>2224px × 1668px</td></tr><tr><td>9.7” iPad</td><td>1536px × 2048px</td><td>2048px × 1536px</td></tr><tr><td>7.9” iPad mini 4</td><td>1536px × 2048px</td><td>2048px × 1536px</td></tr></tbody></table><blockquote><p>Assets LaunchImage </p></blockquote><table><thead><tr><th>环境</th><th>倍数</th><th>方向</th><th>尺寸</th></tr></thead><tbody><tr><td><center>iPad <br> iOS 5,6/7-9 </center></td><td>1x <br> 2x</td><td>竖屏</td><td>768px × 1024px <br> 1536px × 2048px</td></tr><tr><td><center>iPad Without Status Bar <br> iOS 5,6 </center></td><td>1x <br> 2x</td><td>竖屏</td><td>768px × 1004px <br> 1536px × 2008px</td></tr><tr><td><center>iPad <br> iOS 5,6/7-9 </center></td><td>1x <br> 2x</td><td>横屏</td><td>1024px × 768px <br> 2048px × 1536px</td></tr><tr><td><center>iPad Without Status Bar <br> iOS 5,6 </center></td><td>1x <br> 2x</td><td>横屏</td><td>1024px × 748px <br> 2048px × 1496px</td></tr></tbody></table><table><thead><tr><th>环境</th><th>方向</th><th>尺寸</th></tr></thead><tbody><tr><td><center>iPad <br> iOS 5,6/7-9 </center></td><td>竖屏</td><td>768px × 1024px (@1x)<br> 1536px × 2048px (@2x)</td></tr><tr><td><center>iPad Without Status Bar <br> iOS 5,6 </center></td><td>竖屏</td><td>768px × 1004px (@1x) <br> 1536px × 2008px (@2x)</td></tr><tr><td><center>iPad <br> iOS 5,6/7-9 </center></td><td>横屏</td><td>1024px × 768px (@1x) <br> 2048px × 1536px (@2x)</td></tr><tr><td><center>iPad Without Status Bar <br> iOS 5,6 </center></td><td>横屏</td><td>1024px × 748px (@1x) <br> 2048px × 1496px (@2x)</td></tr></tbody></table><h2 id="Icon"><a href="#Icon" class="headerlink" title="Icon"></a>Icon</h2><blockquote><p>参考： <a href="https://developer.apple.com/ios/human-interface-guidelines/icons-and-images/app-icon/">开发者官网</a>， <a href="./PythonImageSize.html">使用 Python 截取</a> </p></blockquote><ul><li>iPhone </li></ul><table><thead><tr><th>环境</th><th>尺寸</th></tr></thead><tbody><tr><td><center>iPhone Notifications <br> iOS 7-11 <br> 20pt</td><td>40px x 40px (20pt x 20pt @2x) <br> 60px x 60px (20pt x 20pt @3x)</td></tr><tr><td><center>iPhone <br> Spotlight - iOS 5,6 <br> Settings - iOS 5-11 <br> 29pt</td><td>29px x 29px (29pt x 29pt @1x) <br> 58px x 58px (29pt x 29pt @2x) <br> 87px x 87px (29pt x 29pt @3x)</td></tr><tr><td><center>iPhone Spotlight <br> iOS 7-11 <br> 40pt</td><td>80px 80px (40pt x 40pt @2x) <br> 120px x 120px (40pt x 40pt @3x)</td></tr><tr><td><center>iPhone App <br> iOS 7-11 <br> 60pt</td><td>120px x 120px (60pt x 60pt @2x) <br> 180px x 180px (60pt x 60pt @3x)</td></tr></tbody></table><span id="more"></span><ul><li>iPad</li></ul><table><thead><tr><th>环境</th><th>尺寸</th></tr></thead><tbody><tr><td><center>iPad Notifications <br> iOS 7-11 <br> 20pt</td><td>20px x 20px (20pt x 20pt @1x) <br> 40px x 40px (20pt x 20pt @2x)</td></tr><tr><td><center>iPad Settings <br> iOS 5-11 <br> 29pt</td><td>29px x 29px (29pt x 29pt @1x) <br> 58px x 58px (29pt x 29pt @2x)</td></tr><tr><td><center>iPad Spotlight <br> iOS 7-11 <br> 40pt</td><td>40px x 40px (40pt x 40pt @1x) <br> 80px x 80px (40pt x 40pt @2x)</td></tr><tr><td><center>iPad App <br> iOS 7-11 <br> 76pt</td><td>76px x 76px (76pt x 76pt @1x) <br> 152px x 152px (76pt x 76pt @2x)</td></tr><tr><td><center>iPad Pro App <br> iOS 9-11 <br> 83.5pt</td><td>167px x 167px (83.5pt x 83.5pt @2x)</td></tr><tr><td><center>App Store <br> iOS <br> 1024pt</td><td>1024px x 1024px (1024pt x 1024pt @1x)</td></tr></tbody></table><h3 id="Icon-size"><a href="#Icon-size" class="headerlink" title="Icon size"></a>Icon size</h3><table><thead><tr><th>设备/环境</th><th>尺寸</th></tr></thead><tbody><tr><td>iPhone</td><td>180px × 180px (60pt × 60pt @3x) <br> 120px × 120px (60pt × 60pt @2x)</td></tr><tr><td>iPad Pro</td><td>167px × 167px (83.5pt × 83.5pt @2x)</td></tr><tr><td>iPad, iPad mini</td><td>152px × 152px (76pt × 76pt @2x)</td></tr><tr><td>App Store</td><td>1024px × 1024px (1024pt × 1024pt @1x)</td></tr></tbody></table><h3 id="Spotlight-icon-size"><a href="#Spotlight-icon-size" class="headerlink" title="Spotlight icon size"></a>Spotlight icon size</h3><table><thead><tr><th>设备</th><th>尺寸</th></tr></thead><tbody><tr><td>iPhone</td><td>87px × 87px (29pt × 29pt @3x) <br> 58px × 58px (29pt × 29pt @2x)</td></tr><tr><td>iPad Pro, iPad, iPad mini</td><td>58px × 58px (29pt × 29pt @2x)</td></tr></tbody></table><h3 id="Settings-icon-size"><a href="#Settings-icon-size" class="headerlink" title="Settings icon size"></a>Settings icon size</h3><table><thead><tr><th>设备</th><th>尺寸</th></tr></thead><tbody><tr><td>iPhone</td><td>87px × 87px (29pt × 29pt @3x) <br> 58px × 58px (29pt × 29pt @2x)</td></tr><tr><td>iPad Pro, iPad, iPad mini</td><td>58px × 58px (29pt × 29pt @2x)</td></tr></tbody></table><h3 id="Notification-icon-size"><a href="#Notification-icon-size" class="headerlink" title="Notification icon size"></a>Notification icon size</h3><table><thead><tr><th>设备</th><th>尺寸</th></tr></thead><tbody><tr><td>iPhone</td><td>60px × 60px (20pt × 20pt @3x) <br> 40px × 40px (20pt × 20pt @2x)</td></tr><tr><td>iPad Pro, iPad, iPad mini</td><td>40px × 40px (20pt × 20pt @2x)</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS项目重命名</title>
      <link href="/iOSProjectRename.html"/>
      <url>/iOSProjectRename.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>示例工程使用 Cocoapods 管理第三方</p></blockquote><h2 id="修改工程名"><a href="#修改工程名" class="headerlink" title="修改工程名"></a>修改工程名</h2><p><img src="./images/iOSProjectRename-project01.png" alt="修改工程名01" title="修改工程名01"></p><p><img src="./images/iOSProjectRename-project02.png" alt="修改工程名02" title="修改工程名02"></p><span id="more"></span><p><img src="./images/iOSProjectRename-project03.png" alt="修改工程名03" title="修改工程名03"></p><h2 id="修改-TARGETS-名称"><a href="#修改-TARGETS-名称" class="headerlink" title="修改 TARGETS 名称"></a>修改 TARGETS 名称</h2><p><img src="./images/iOSProjectRename-targets.png" alt="修改 TARGETS" title="修改 TARGETS"></p><h2 id="添加-Scheme"><a href="#添加-Scheme" class="headerlink" title="添加 Scheme"></a>添加 Scheme</h2><p><code>Project -&gt; Scheme -&gt; New Scheme...</code></p><h2 id="修改文件夹名"><a href="#修改文件夹名" class="headerlink" title="修改文件夹名"></a>修改文件夹名</h2><p><img src="./images/iOSProjectRename-finder01.png" alt="修改文件夹01" title="修改文件夹01"></p><p><img src="./images/iOSProjectRename-finder02.png" alt="修改文件夹02" title="修改文件夹02"></p><h2 id="修改-Podfile-中的-target"><a href="#修改-Podfile-中的-target" class="headerlink" title="修改 Podfile 中的 target"></a>修改 Podfile 中的 target</h2><blockquote><p>注：修改有风险</p></blockquote><ol><li>修改 Podfile 中的 target</li><li>删除工程根目录中的 <code>xx.xcworkspace</code> 、 <code>Podfile.lock</code> 和 <code>Pods</code></li><li>终端打开工程根目录执行 <code>pod install</code></li></ol><h2 id="删除旧文件"><a href="#删除旧文件" class="headerlink" title="删除旧文件"></a>删除旧文件</h2><ol><li><code>Pods/Projects/</code> 下的 .a</li><li><code>Pods/Targets Support Files/Pods-xxx/</code> 下的旧配置</li></ol>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 PHP 实现 APNs</title>
      <link href="/iOSAPNsWithPHP.html"/>
      <url>/iOSAPNsWithPHP.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>参考 <a href="http://blog.csdn.net/heyufei/article/details/53616961">iOS 消息推送(VOIP)</a></p></blockquote><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><h3 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h3><ol><li>下载推送证书，加入到 钥匙串，并将文件改名为 <code>aps_development.cer</code> 放入本文件夹；</li><li>从 钥匙串 将证书导出为 p12 格式，更名为 <code>aps_development.p12</code> 放入本文件夹；</li><li>修改 <code>push.php</code> 文件中的配置；</li><li>终端执行 <code>init.py</code> 初始化证书；</li><li>终端执行 <code>php push.php</code> 发送（默认为开发环境）。</li></ol><p>注： 执行完 <code>python</code> 脚本终端会输出以下内容，若没有则表示操作有误，请重新操作</p><pre><code>Enter Import Password:MAC verified OKEnter PEM pass phrase:Verifying - Enter PEM pass phrase:</code></pre><h3 id="常见问题及解决"><a href="#常见问题及解决" class="headerlink" title="常见问题及解决"></a>常见问题及解决</h3><span id="more"></span><ol><li><p>证书相关查看上面的 <code>参考</code></p></li><li><p>不能导出 <code>p12</code></p><p> 说明该证书不是这台机器颁发的，解决方案是找到那台机器拿到 p12 文件，或者重新生成证书（慎用）。</p></li><li><p><code>SSL3_GET_SERVER_CERTIFICATE:certificate verify failed</code> / <code>Warning: stream_socket_client(): SSL operation failed with code 1. OpenSSL Error messages: error:14094410:SSL routines:SSL3_READ_BYTES</code></p><p> 下载 <a href="https://www.entrust.com/get-support/ssl-certificate-support/root-certificate-downloads/">entrust_2048_ca.cer 证书</a> 放至本文件夹</p></li></ol><h2 id="文件说明"><a href="#文件说明" class="headerlink" title="文件说明"></a>文件说明</h2><ul><li><p>aps_development.cer</p><p>  推送证书，分 <code>Development</code> 和 <code>Production</code> 两种，从 <a href="https://developer.apple.com/">开发官方下载</a></p></li><li><p>aps_development.p12</p><p>  私钥，官方下载的推送证书(<code>aps_development.cer</code>）加入<code>钥匙串</code>后导出</p></li><li><p>aps_cert.pem</p><p>  推送证书(<code>aps_development.cer</code>)的 <code>pem</code> 格式</p></li><li><p>aps_key.pem</p><p>  私钥(<code>aps_development.p12</code>)的 <code>pem</code> 格式</p></li><li><p>aps.pem</p><p>  合成文件，推送证书(<code>pem</code> 格式)和私钥(<code>pem</code> 格式)的合成文件</p></li></ul><p>有兴可查看下面的 <code>init.py</code></p><ul><li><p>entrust_2048_ca.cer</p><p>  这个不太确认…是个CA证书，有了解的可以联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a></p></li></ul><h2 id="附"><a href="#附" class="headerlink" title="附"></a>附</h2><h3 id="测试推送"><a href="#测试推送" class="headerlink" title="测试推送"></a>测试推送</h3><ol><li>使用网站 <a href="http://pushtry.com/">http://pushtry.com/</a></li><li><a href="https://itunes.apple.com/cn/app/easy-apns-provider-%E6%8E%A8%E9%80%81%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/id989622350?mt=12">Easy APNs Provider - 推送测试工具</a></li></ol><h3 id="init-py"><a href="#init-py" class="headerlink" title="init.py"></a>init.py</h3><pre><code># -*- coding: utf-8 -*-import osdef main():  # 将 aps_development.cer 转成 pem 格式  os.system(&#39;openssl x509 -in aps_development.cer -inform DER -out aps_cert.pem -outform PEM&#39;)  # 将 aps_development.p12 格式的私钥转换成 aps_key.pem  print(&#39;请输入导出时的密码，无密码按回车继续，然后设置 PEM pass phrase\nPlease enter the password of the export, no password to press enter to continue, setting PEM pass phrase.\n&#39;)  os.system(&#39;openssl pkcs12 -nocerts -out aps_key.pem -in aps_development.p12&#39;)  # 合成  os.system(&#39;cat aps_cert.pem aps_key.pem &gt; aps.pem&#39;)  print(&#39;证书初始化结束/The certificate initialization done.&#39;)main()</code></pre><h3 id="push-php"><a href="#push-php" class="headerlink" title="push.php"></a>push.php</h3><pre><code>&lt;?php// token：设备注册成功后 application:didRegisterForRemoteNotificationsWithDeviceToken: 中查看，去除空格$deviceToken = &#39;1ff8a0af52b48748c7628609a812f15d1c961df4bb04e618def369996a7e72ae&#39;;// passphrase：私钥密码$passphrase = &#39;qwe123&#39;;// 数值：显示在 icon 上$badge = 0;// 环境 TRUE-开发，FALSE-正式$devPlatform = TRUE;// 推送信息设置$message = &#39;推送消息&#39;; // 推送消息////////////////////////////////////////////////////////////////////////////////// 设置上下文$ctx = stream_context_create();stream_context_set_option($ctx, &#39;ssl&#39;, &#39;local_cert&#39;, &#39;aps.pem&#39;); // 设置证书stream_context_set_option($ctx, &#39;ssl&#39;, &#39;cafile&#39;, &#39;entrust_2048_ca.cer&#39;); // 设置CA证书stream_context_set_option($ctx, &#39;ssl&#39;, &#39;passphrase&#39;, $passphrase); // 设置私钥密码// 打开一个 APNs 的连接，开发环境 gateway.sandbox.push.apple.com:2195 正式环境 gateway.push.apple.com:2195$sslPath = &#39;ssl://gateway.sandbox.push.apple.com:2195&#39;;if ($devPlatform == FALSE) &#123;    $sslPath = &#39;ssl://gateway.push.apple.com:2195&#39;;&#125;$fp = stream_socket_client(    $sslPath, $err,    $errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx);if (!$fp)    exit(&quot;Failed to connect: $err $errstr&quot; . PHP_EOL);echo &#39;Connected to APNS&#39; . PHP_EOL;// 封装推送信息$body[&#39;aps&#39;] = array(    &#39;alert&#39; =&gt; $message,    &#39;sound&#39; =&gt; &#39;default&#39;,    &#39;badge&#39; =&gt; $badge,);// 转为 JSON 格式$payload = json_encode($body);// 转为二进制$msg = chr(0).pack(&#39;n&#39;, 32).pack(&#39;H*&#39;, $deviceToken).pack(&#39;n&#39;, strlen($payload)).$payload;// 发送至 Apple 服务器$result = fwrite($fp, $msg, strlen($msg));if (!$result)    echo &#39;Message not delivered&#39; . PHP_EOL;else    echo &#39;Message successfully delivered&#39; . PHP_EOL;// 关闭连接fclose($fp);?&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac平台MySQL基础</title>
      <link href="/MySQLTour.html"/>
      <url>/MySQLTour.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>Mac平台上MySQL支持<code>dmg</code>文件安装，打开<a href="https://dev.mysql.com/downloads/mysql/">下载界面</a></p><h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><p>停止MySQL，然后终端执行：</p><pre><code>sudo rm /usr/local/mysqlsudo rm -rf /usr/local/mysql*sudo rm -rf /Library/StartupItems/MySQLCOMsudo rm -rf /Library/PreferencePanes/My*sudo rm -rf /Library/Receipts/mysql*rm -rf ~/Library/PreferencePanes/My*sudo rm -rf /Library/Receipts/MySQL*sudo rm -rf /var/db/receipts/com.mysql.*</code></pre><p>编辑 <code>/etc/hostconfig</code> 文件，删除 <code>MYSQLCOM=-YES-</code></p><h2 id="重置root用户密码"><a href="#重置root用户密码" class="headerlink" title="重置root用户密码"></a>重置root用户密码</h2><blockquote><p>可参考<a href="https://dev.mysql.com/doc/refman/5.7/en/resetting-permissions.html">官方做法</a>，也可使用我这种<strong>不安全</strong>的做法</p></blockquote><span id="more"></span><h3 id="停止MySQL服务"><a href="#停止MySQL服务" class="headerlink" title="停止MySQL服务"></a>停止MySQL服务</h3><p><code>$ sudo /usr/local/mysql/support-files/mysql.server stop</code></p><p>如果报错<code>ERROR! MySQL server PID file could not be found!</code>，则需要打开<code>系统偏好设置</code>——<code>MySQL</code>点击<code>Stop MySQL Server</code></p><p>注：</p><ul><li>使用 <code>mysql.server</code> 启动的，必须使用 <code>mysql.server</code> 停止</li><li>使用 <code>MySQL面板（系统偏好设置中）</code> 启动的，必须使用 <code>MySQL面板</code> 停止</li><li>两者都不能停止，可尝试<code>top</code>查看<code>PID</code>，然后使用<code>sudo kill PID</code>（<strong>慎用</strong>）</li></ul><h3 id="安全模式启动MySQL"><a href="#安全模式启动MySQL" class="headerlink" title="安全模式启动MySQL"></a>安全模式启动MySQL</h3><p><code>$ sudo /usr/local/mysql/bin/mysqld_safe --skip-grant-tables</code></p><ul><li>–skip-grant-tables 不校验用户密码，任何存在的账户都可免密码登录，<strong>极不安全</strong></li></ul><h3 id="root账户进入MySQL"><a href="#root账户进入MySQL" class="headerlink" title="root账户进入MySQL"></a>root账户进入MySQL</h3><p>打开一个新终端，提示输入密码时按<code>回车</code>继续：</p><p><code>$ /usr/local/mysql/bin/mysql -u root -p</code></p><p>用户信息存在 <code>mysql.user</code>表中，需要先选择 <code>mysql</code> 这个数据库</p><pre><code>Welcome to the MySQL monitor.  Commands end with ; or \g.Your MySQL connection id is 46Server version: 5.7.18Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.mysql&gt; use mysql;</code></pre><h3 id="重置root密码"><a href="#重置root密码" class="headerlink" title="重置root密码"></a>重置root密码</h3><p>直接更新 <code>mysql.user</code> 表中 <code>root</code> 用户的密码：</p><p><code>mysql&gt; UPDATE user SET authentication_string = PASSWORD(&#39;新密码&#39;) WHERE User=&#39;root&#39;;</code></p><h3 id="刷新权限"><a href="#刷新权限" class="headerlink" title="刷新权限"></a>刷新权限</h3><p><code>mysql&gt; flush privileges;</code></p><h3 id="重启MySQL"><a href="#重启MySQL" class="headerlink" title="重启MySQL"></a>重启MySQL</h3><p>先停止、再启动，结束<code>安全启动MySQL</code>的终端。</p><h2 id="数据库管理工具"><a href="#数据库管理工具" class="headerlink" title="数据库管理工具"></a>数据库管理工具</h2><p>推荐使用 <a href="https://www.navicat.com.cn/download">Navite for MySQL</a>，也可使用官方的<a href="https://dev.mysql.com/downloads/workbench/">MySQL Workbench</a></p>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP CodeIngiter 初探</title>
      <link href="/PHPCITour.html"/>
      <url>/PHPCITour.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>主要摘自<a href="http://codeigniter.org.cn/user_guide/index.html">CodeIgniter 中国 »  文档首页</a></p></blockquote><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p><a href="http://codeigniter.org.cn/user_guide/installation/downloads.html">点击打开下载界面</a></p><h2 id="安装说明"><a href="#安装说明" class="headerlink" title="安装说明"></a>安装说明</h2><h3 id="安装-CodeIgniter："><a href="#安装-CodeIgniter：" class="headerlink" title="安装 CodeIgniter："></a>安装 CodeIgniter：</h3><ol><li>解压缩安装包；</li><li>将 CodeIgniter 文件夹及里面的文件上传到服务器，通常 index.php 文件将位于网站的根目录；</li><li>使用文本编辑器打开 application/config/config.php 文件设置你网站的根 URL，如果你想使用加密或会话，在这里设置上你的加密密钥；</li><li>如果你打算使用数据库，打开 application/config/database.php 文件设置数据库参数。</li></ol><h3 id="安全性"><a href="#安全性" class="headerlink" title="安全性"></a>安全性</h3><p>将 <code>system</code> 和 <code>application</code> 文件夹放置 Web 根目录之外，修改 <em>文件夹</em> 名称，并设置 <code>index.php</code> 中的 <em><code>%system_path</code></em> 和 *<code>$application_folder</code>*，最好设置成绝对路径。</p><p>生产环境要禁用 PHP 错误报告以及所有其他仅在开发环境使用的功能。在 CodeIgniter 中，可以通过设置 <code>ENVIRONMENT</code> 常量来做到这一点，这在 <a href="http://codeigniter.org.cn/user_guide/general/security.html">安全</a> 这篇指南中有着更详细的介绍。</p>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac OS 上安装 Niginx</title>
      <link href="/InstallNginxFormMac.html"/>
      <url>/InstallNginxFormMac.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>参考<a href="http://www.jianshu.com/p/6c7cb820a020">Mac下用brew安装nginx</a></p></blockquote><h2 id="安装brew-Homebrew"><a href="#安装brew-Homebrew" class="headerlink" title="安装brew(Homebrew)"></a>安装brew(Homebrew)</h2><p>一般默认装有<code>brew</code></p><pre><code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></pre><p><code>brew</code>常用命令：</p><ul><li>搜索软件：<code>brew search nginx</code></li><li>卸载软件：<code>brew uninstall nginx</code></li><li>升级brew：<code>sodu brew update</code></li><li>查看安装信息：<code>sodu brew info nginx</code></li><li>查看已经安装的软件：<code>brew list</code></li><li>注：脚本会在执行前暂停，按下回车并输入管理员密码。更多信息<a href="https://brew.sh/index_zh-cn.html">查看官方网站</a></li></ul><span id="more"></span><h2 id="安装Nginx"><a href="#安装Nginx" class="headerlink" title="安装Nginx"></a>安装Nginx</h2><pre><code>$ brew install nginx</code></pre><p><code>nginx</code>常用命令：</p><ul><li>启动<code>nginx</code>服务：<code>sudo brew services start nginx</code></li><li>关闭<code>nginx</code>服务：<code>sudo brew services stop nginx</code></li><li>重新加载<code>nginx</code>：<code>nginx -s reload</code></li><li>停止<code>nginx</code>：<code>nginx -s stop</code></li><li>检查配置文件语法：<code>nginx -t</code></li></ul><p>注：也可使用<code>sudo nginx</code>启动、使用<code>sudo nginx -s stop</code>停止。</p><h2 id="Nginx相关信息"><a href="#Nginx相关信息" class="headerlink" title="Nginx相关信息"></a>Nginx相关信息</h2><ul><li>部署路径：<code>/usr/local/var/www</code></li><li><code>nginx</code>配置文件路径：<code>/usr/local/etc/nginx/nginx.conf</code></li><li>默认使用<code>8080</code>端口</li></ul><p>执行 <code>brew info nginx</code> 后得到以下信息</p><pre><code>nginx: stable 1.12.0 (bottled), devel 1.13.2, HEADHTTP(S) server and reverse proxy, and IMAP/POP3 proxy serverhttps://nginx.org//usr/local/Cellar/nginx/1.12.0_1 (23 files, 1MB) *  Poured from bottle on 2017-07-08 at 18:27:37From: https://github.com/Homebrew/homebrew-core/blob/master/Formula/nginx.rb==&gt; DependenciesRequired: pcre ✔, openssl@1.1 ✔Optional: passenger ✘==&gt; Options--with-debug    Compile with support for debug log--with-gunzip    Compile with support for gunzip module--with-passenger    Compile with support for Phusion Passenger module--with-webdav    Compile with support for WebDAV module--devel    Install development version 1.13.2--HEAD    Install HEAD version==&gt; CaveatsDocroot is: /usr/local/var/wwwThe default port has been set in /usr/local/etc/nginx/nginx.conf to 8080 so thatnginx can run without sudo.nginx will load all files in /usr/local/etc/nginx/servers/.To have launchd start nginx now and restart at login:  brew services start nginxOr, if you don&#39;t want/need a background service you can just run:  nginx        </code></pre>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unity与iOS原生03</title>
      <link href="/Unity-iOS-03.html"/>
      <url>/Unity-iOS-03.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>前言：本文章主要解决在现有iOS工程中集成多个Unity工程的问题</p><p>Unity 5.3.5f1  </p><p>Xcode 8.2.1</p></blockquote><h1 id="iOS原生集成多个Unity工程"><a href="#iOS原生集成多个Unity工程" class="headerlink" title="iOS原生集成多个Unity工程"></a>iOS原生集成多个Unity工程</h1><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><ol><li>Unity3d场景生成、上传、下载和加载（卸载未研究，必要时需卸载）；</li><li>Unity3d导出资源、加载资源、场景切换；</li><li>iOS原生集成Unity3d工程（集成Unity3d生成Xcode中的资源，参考<a href="http://qingqinghebiancao.github.io/2016/09/07/Unity%E9%9B%86%E6%88%90%E5%88%B0iOS%E6%9C%AC%E5%9C%B0%E5%B7%A5%E7%A8%8B%E4%B8%AD/">链接</a>）</li><li>iOS原生与Unity3d交互（界面切换、数据交互）</li></ol><h2 id="Unity部分"><a href="#Unity部分" class="headerlink" title="Unity部分"></a>Unity部分</h2><span id="more"></span><ul><li>主工程(UnityMainProject)<ul><li>主场景(MainScene) <em>下载并加载服务器上的场景</em></li><li>其它场景(OtherScene)</li></ul></li><li>场景工程(NewScene)<ul><li>场景(example)</li></ul></li></ul><h2 id="iOS原生部分"><a href="#iOS原生部分" class="headerlink" title="iOS原生部分"></a>iOS原生部分</h2><ul><li>工程(UnitySceneDemo)</li></ul><h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><h3 id="Unity工程修改后重新生成Xcode工程，Libraries、Classes和Data需要更新"><a href="#Unity工程修改后重新生成Xcode工程，Libraries、Classes和Data需要更新" class="headerlink" title="Unity工程修改后重新生成Xcode工程，Libraries、Classes和Data需要更新"></a>Unity工程修改后重新生成Xcode工程，Libraries、Classes和Data需要更新</h3><ol><li>移除 <strong>Build Phases -&gt; Compile Sources</strong> 中 <em>路径为Class</em>下的 main.mm</li><li>修改 <strong>UnityAppController.h</strong></li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// we will cache view controllers for fixed orientation</span></span><br><span class="line"><span class="comment">// auto-rotation view contoller goes to index=0</span></span><br><span class="line"><span class="comment">//UnityViewControllerBase* _viewControllerForOrientation[5];</span></span><br><span class="line">UIViewController* _viewControllerForOrientation[<span class="number">5</span>];</span><br></pre></td></tr></table></figure><p>和</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//inline UnityAppController*GetAppController()</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//return (UnityAppController*)[UIApplication sharedApplication].delegate;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&quot;AppDelegate.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> UnityAppController*  <span class="title">GetAppController</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AppDelegate *delegate = (AppDelegate *)[UIApplication sharedApplication].delegate;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> delegate.unityController;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Unity使用项目中场景需要设置：File-gt-Setting…-加入场景（所需要的）"><a href="#Unity使用项目中场景需要设置：File-gt-Setting…-加入场景（所需要的）" class="headerlink" title="Unity使用项目中场景需要设置：File -&gt; Setting… 加入场景（所需要的）"></a>Unity使用项目中场景需要设置：File -&gt; Setting… 加入场景（所需要的）</h3><h1 id="合并多个Unity工程（场景包含多媒体）"><a href="#合并多个Unity工程（场景包含多媒体）" class="headerlink" title="合并多个Unity工程（场景包含多媒体）"></a>合并多个Unity工程（场景包含多媒体）</h1><h2 id="操作步骤："><a href="#操作步骤：" class="headerlink" title="操作步骤："></a>操作步骤：</h2><ol><li><p>导出资源：</p><ul><li>打开工程，选中<code>Project -&gt; Assets</code>，右键并选择<code>Export Package...</code>，点击对话框右下角的<code>Export...</code></li></ul></li><li><p>导入资源：</p><ul><li>方式一：打开工程，选择<strong>菜单栏</strong>的<code>Assets -&gt; Import Package -&gt; Custom Package...</code>，选择资源(<strong>xx.unitypackage</strong>)</li><li>方式二：打开工程，双击<em><strong>Finder</strong></em>中的资源(<strong>xx.unitypackage</strong>)</li><li>方式三：打开工程，从<em><strong>Finder</strong></em>中拖动到工程的<em>Assets</em>面板中</li></ul></li></ol><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><ol start="0"><li><p>导入资源后文件夹目录混乱</p><p> 解决：</p><ul><li>方式一：手动拖动文件或文件夹到指定目录</li><li>方式二：导出资源时外层加个文件夹</li></ul></li><li><p>场景切换报错（<strong>S0</strong>为场景名）</p><pre><code> Scene &#39;S0&#39; (-1) couldn&#39;t be loaded because it has not been added to the build settings or the AssetBundle has not been loaded. To add a scene to the build settings use the menu File-&gt;Build Settings... UnityEngine.SceneManagement.SceneManager:LoadScene(String) ButtonClickedAction:LoadMathGameS0() (at Assets/Scripts/ButtonClickedAction.cs:62) UnityEngine.EventSystems.EventSystem:Update() </code></pre><p> 该问题由未选择场景导致，解决操作如下：</p><ol><li><strong>Assets</strong>中找到对应的场景（这里是<em>S0</em>）</li><li>选择<strong>菜单栏</strong>的<code>File -&gt; Build Setting...</code></li><li>将场景拖动到对话框的<code>Scenes In Build</code>中</li></ol></li><li><p>导入unitypackage后文件重复</p><pre><code> Assets/MathGame/Scripts/GameManager.cs(10,14): error CS0101: The namespace `global::&#39; already contains a definition for `GameManager&#39; Assets/MathGame/Scripts/SoundManager.cs(4,14): error CS0101: The namespace `global::&#39; already contains a definition for `SoundManager&#39;</code></pre><p> 文件名冲突，解决：</p><ul><li>让提供者修改文件名和Class名</li></ul></li></ol><h1 id="交互封装"><a href="#交互封装" class="headerlink" title="交互封装"></a>交互封装</h1><h2 id="Unity调用原生"><a href="#Unity调用原生" class="headerlink" title="Unity调用原生"></a>Unity调用原生</h2><blockquote><p>注：也可将第二部分内容合并到第四部分中，并将 <strong>.m 改为 .mm</strong> 即可</p></blockquote><h3 id="第一部分：Unity声名外部方法"><a href="#第一部分：Unity声名外部方法" class="headerlink" title="第一部分：Unity声名外部方法"></a>第一部分：Unity声名外部方法</h3><blockquote><p>这是 <strong>C# JavaScript</strong> ，也可使用 <strong>JavaScript</strong></p></blockquote><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.SceneManagement;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.InteropServices; <span class="comment">//1.添加InteropServices</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ButtonClickedAction</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.声名外部方法（iOS方法）</span></span><br><span class="line">[<span class="meta">DllImport(<span class="meta-string">&quot;__Internal&quot;</span>)</span>] <span class="comment">//注意没有分号</span></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unitySendMessageShowNativeWindow</span>(<span class="params"> <span class="built_in">string</span> str </span>)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Use this for initialization</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>)</span> &#123;</span><br><span class="line">Debug.Log (<span class="string">&quot;ButtonClickedAction Start&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">......</span><br></pre></td></tr></table></figure><h3 id="第二部分：原生实现Unity声名的外部方法"><a href="#第二部分：原生实现Unity声名的外部方法" class="headerlink" title="第二部分：原生实现Unity声名的外部方法"></a>第二部分：原生实现Unity声名的外部方法</h3><blockquote><p>必须在 <code>.mm</code> 文件中实现</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">unitySendMessageShowNativeWindow</span><span class="params">(<span class="keyword">char</span> *message)</span> </span>&#123;</span><br><span class="line">        [[Unity_Bridge defaultInstance] unitySendMessageShowNativeWindow:message]; <span class="comment">//获取单例，调用实例相应方法</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="第三部分：封装"><a href="#第三部分：封装" class="headerlink" title="第三部分：封装"></a>第三部分：封装</h3><blockquote><p><strong>头文件 .h</strong></p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//MARK: - IKanUnityInterfaceDelegate</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> Unity bridge 协议方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@protocol IKanUnityInterfaceDelegate &lt;NSObject&gt;</span><br><span class="line"></span><br><span class="line">@optional</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 返回原生Window</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param message 当前场景名称</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)unitySendMessageShowNativeWindow:(<span class="keyword">char</span> *)message;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//==============================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//MARK: - @interface Unity_Bridge</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> Unity与原生的桥梁：实现Unity声名的方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@interface Unity_Bridge : NSObject&lt;IKanUnityInterfaceDelegate&gt;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, assign) id&lt;IKanUnityInterfaceDelegate&gt; delegate; <span class="comment">//委托</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 单例</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @return 实例</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (instancetype)defaultInstance;</span><br><span class="line"></span><br><span class="line"><span class="comment">//以下方法声名与协议中相同</span></span><br><span class="line">- (<span class="keyword">void</span>)unitySendMessageShowNativeWindow:(<span class="keyword">char</span> *)message;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><blockquote><p><strong>实现 .m</strong></p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&quot;Unity-Bridge.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">@implementation Unity_Bridge</span><br><span class="line"></span><br><span class="line">+ (instancetype)defaultInstance &#123;</span><br><span class="line">    <span class="keyword">static</span> Unity_Bridge *instance = nil;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">dispatch_once_t</span> onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        instance = [[Unity_Bridge alloc] init];</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)unitySendMessageShowNativeWindow:(<span class="keyword">char</span> *)message &#123;</span><br><span class="line">    <span class="keyword">if</span> (_delegate &amp;&amp; [_delegate respondsToSelector:@selector(unitySendMessageShowNativeWindow:)]) &#123;</span><br><span class="line">        </span><br><span class="line">        [self.delegate unitySendMessageShowNativeWindow:message];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><h3 id="第四部分：使用"><a href="#第四部分：使用" class="headerlink" title="第四部分：使用"></a>第四部分：使用</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&quot;ViewController.h&quot;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&quot;Unity-Bridge.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">@<span class="function">interface <span class="title">ViewController</span> <span class="params">()</span>&lt;IKanUnityInterfaceDelegate&gt;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">@<span class="title">property</span> <span class="params">(nonatomic, strong)</span> Unity_Bridge *unityBridge</span>;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation ViewController</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc</span><br><span class="line">&#123;</span><br><span class="line">    _unityBridge.delegate = nil;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    <span class="comment">// Do any additional setup after loading the view, typically from a nib.</span></span><br><span class="line">    </span><br><span class="line">    _unityBridge = [Unity_Bridge defaultInstance];</span><br><span class="line">    _unityBridge.delegate = self;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Delegate</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)unitySendMessageShowNativeWindow:(<span class="keyword">char</span> *)message &#123;</span><br><span class="line">    [(AppDelegate *)[UIApplication sharedApplication].delegate hideUnityWindow];</span><br><span class="line"></span><br><span class="line">    NSString *msg = [NSString stringWithUTF8String:message];</span><br><span class="line">    <span class="keyword">if</span> ([msg isEqualToString:@<span class="string">&quot;NewScene&quot;</span>]) &#123;</span><br><span class="line">        [[IKanUnitySendMessage manager] sendMessage:<span class="string">&quot;Main Camera&quot;</span> method:<span class="string">&quot;ShowScene&quot;</span> msg:<span class="string">&quot;MainScene&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><h2 id="原生调用Unity"><a href="#原生调用Unity" class="headerlink" title="原生调用Unity"></a>原生调用Unity</h2><blockquote><p>使用防御式编程将<code>UnitySendMessage</code>封装</p></blockquote><h3 id="基本封装"><a href="#基本封装" class="headerlink" title="基本封装"></a>基本封装</h3><blockquote><p><strong>头文件 .h</strong></p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 原生调用Unity方法，防御式编程</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@interface IKanUnitySendMessage : NSObject</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 返回一个实例</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @return 实例</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (nullable instancetype)manager;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 调用Unity方法</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param obj Unity对象名</span></span><br><span class="line"><span class="comment"> @param method 方法名</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)sendMessage:(nonnull <span class="keyword">const</span> <span class="keyword">char</span>*)obj method:(nonnull <span class="keyword">const</span> <span class="keyword">char</span>*)method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 调用Unity方法</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> @param obj Unity对象名</span></span><br><span class="line"><span class="comment"> @param method 方法名</span></span><br><span class="line"><span class="comment"> @param msg 参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)sendMessage:(nonnull <span class="keyword">const</span> <span class="keyword">char</span>*)obj method:(nonnull <span class="keyword">const</span> <span class="keyword">char</span>*)method msg:(nullable <span class="keyword">const</span> <span class="keyword">char</span>*)msg;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><blockquote><p><strong>实现 .m</strong></p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&quot;IKanUnitySendMessage.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">@implementation IKanUnitySendMessage</span><br><span class="line"></span><br><span class="line">+ (nullable instancetype)manager &#123;</span><br><span class="line">    <span class="keyword">return</span> [[IKanUnitySendMessage alloc] init];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)sendMessage:(nonnull <span class="keyword">const</span> <span class="keyword">char</span>*)obj method:(nonnull <span class="keyword">const</span> <span class="keyword">char</span>*)method &#123;</span><br><span class="line">    [self sendMessage:obj method:method msg:<span class="string">&quot;&quot;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)sendMessage:(nonnull <span class="keyword">const</span> <span class="keyword">char</span>*)obj method:(nonnull <span class="keyword">const</span> <span class="keyword">char</span>*)method msg:(nullable <span class="keyword">const</span> <span class="keyword">char</span>*)msg &#123;</span><br><span class="line">    </span><br><span class="line">    NSAssert(obj != nil &amp;&amp; StrLength(obj) != <span class="number">0</span>, @<span class="string">&quot;Unity Send Message obj 不能为nil 或 空&quot;</span>);</span><br><span class="line">    NSAssert(method != nil &amp;&amp; StrLength(method) != <span class="number">0</span>, @<span class="string">&quot;Unity Send Message method 不能为nil 或 空&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    UnitySendMessage(obj, method, msg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Unity </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解压Assects.car文件</title>
      <link href="/iOSUnzipAssectsCarFile.html"/>
      <url>/iOSUnzipAssectsCarFile.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>前言：解压<code>ipa</code>并显示包内容后，看到一个 <code>Assets.car</code> 文件，心想它就是 <code>Assets.xcassets</code></p></blockquote><p>参考原文：<a href="http://www.jianshu.com/p/a5dd75102467">iOS学习之解压Assets.car</a></p><h2 id="获取工具"><a href="#获取工具" class="headerlink" title="获取工具"></a>获取工具</h2><ol><li>从<a href="https://github.com/steventroughtonsmith/cartool">Github</a>下载工程；</li><li>打开工程；</li><li>编译后 Products 文件夹中得到 <code>cartool</code></li></ol><h2 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h2><pre><code>$ ./cartool /xxx/Assets.car /xxx/outputDirectory</code></pre><ul><li>cartool: 命令行工具</li><li>Assets.car: Assets.xcassets 压缩后的文件</li><li>outputDirectory: 目标文件夹，必需存在！</li></ul><h2 id="脚本操作"><a href="#脚本操作" class="headerlink" title="脚本操作"></a>脚本操作</h2><span id="more"></span><blockquote><p>Pythone 脚本如下</p><p>需要 <code>cartool工具</code>、<code>.car文件</code>和<code>脚本</code>在同一目录</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 工具目录</span></span><br><span class="line">cartool_path = <span class="string">&quot;./&quot;</span></span><br><span class="line"><span class="comment"># 文件路径</span></span><br><span class="line">file_path = <span class="string">&quot;./Assets.car&quot;</span></span><br><span class="line"><span class="comment"># 输出目录</span></span><br><span class="line">out_directory = <span class="string">&quot;./outDirectory&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="comment"># 定位</span></span><br><span class="line">    os.system(<span class="string">&#x27;cd %s&#x27;</span> % cartool_path)</span><br><span class="line">    <span class="comment"># 判断输出目录是否存在，不存在则新建</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(out_directory) == <span class="literal">False</span>:</span><br><span class="line">        os.system(<span class="string">&#x27;mkdir %s&#x27;</span> % out_directory)</span><br><span class="line">    <span class="comment"># 解压文件</span></span><br><span class="line">    os.system(<span class="string">&#x27;%scartool %s %s&#x27;</span> % (cartool_path,file_path,out_directory))</span><br><span class="line">    <span class="comment"># 打开输出目录</span></span><br><span class="line">    os.system(<span class="string">&#x27;open %s&#x27;</span> % out_directory)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于转义、base64</title>
      <link href="/iOSAboutESC.html"/>
      <url>/iOSAboutESC.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>前言：最近在搞一些东东，html中一堆堆的<code>%20</code>、<code>%3A</code>看着头大，然后硬着头皮去分析……</p></blockquote><p><em>持续更新中…</em></p><h2 id="URL编码-解码"><a href="#URL编码-解码" class="headerlink" title="URL编码/解码"></a>URL编码/解码</h2><p>首先推荐一个网站：<a href="http://tool.chinaz.com/tools/urlencode.aspx">站长工具-URL编码/解码</a></p><p>Objective-C 中使用以下方法对URL编码、解码：</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 编码</span></span><br><span class="line"><span class="operator">-</span> (nullable <span class="type">NSString</span> <span class="operator">*</span>)stringByAddingPercentEncodingWithAllowedCharacters:(<span class="type">NSCharacterSet</span> <span class="operator">*</span>)allowedCharacters <span class="type">NS_AVAILABLE</span>(<span class="number">10_9</span>, <span class="number">7_0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解码 例：NSString *newStr = str.stringByRemovingPercentEncoding;</span></span><br><span class="line"><span class="meta">@property</span> (nullable, readonly, copy) <span class="type">NSString</span> <span class="operator">*</span>stringByRemovingPercentEncoding <span class="type">NS_AVAILABLE</span>(<span class="number">10_9</span>, <span class="number">7_0</span>);</span><br></pre></td></tr></table></figure><span id="more"></span><p>以下是非完全统计的转义（发现有误请联系）：</p><table><thead><tr><th>转义前</th><th>转义后</th><th>转义前</th><th>转义后</th></tr></thead><tbody><tr><td>%20</td><td>空格</td><td>%21</td><td>!</td></tr><tr><td>%22</td><td>-</td><td>%23</td><td>#</td></tr><tr><td>%25</td><td>%</td><td>%26</td><td>&amp;</td></tr><tr><td>%28</td><td>(</td><td>%29</td><td>)</td></tr><tr><td>%2B</td><td>+</td><td>%2C</td><td>,</td></tr><tr><td>%2F</td><td>/</td><td>%3A</td><td>:</td></tr><tr><td>%3B</td><td>;</td><td>%3C</td><td>&lt;</td></tr><tr><td>%3D</td><td>=</td><td>%3E</td><td>&gt;</td></tr><tr><td>%3F</td><td>?</td><td>%40</td><td>@</td></tr><tr><td>%5C</td><td>\</td><td>%7C</td><td>|</td></tr></tbody></table><p>附：<a href="http://tool.oschina.net/commons?type=2">HTML特殊转义字符对照表</a></p><h2 id="图片与base64"><a href="#图片与base64" class="headerlink" title="图片与base64"></a>图片与base64</h2><p>推荐文章：<a href="http://www.toutiao.com/a6401965088865632514/">关于图片的Base64编码，你了解吗？</a></p><h3 id="Objective-C-中使用（摘自：iOS-图片转成base64编码）："><a href="#Objective-C-中使用（摘自：iOS-图片转成base64编码）：" class="headerlink" title="Objective-C 中使用（摘自：iOS 图片转成base64编码）："></a>Objective-C 中使用（摘自：<a href="http://www.jianshu.com/p/91979b5def90">iOS 图片转成base64编码</a>）：</h3><ul><li>UIImage图片转成Base64字符串：  <figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIImage</span> <span class="operator">*</span>originImage <span class="operator">=</span> [<span class="type">UIImage</span> imageNamed:@<span class="string">&quot;originImage.png&quot;</span>];</span><br><span class="line"><span class="type">NSData</span> <span class="operator">*</span>data <span class="operator">=</span> <span class="type">UIImageJPEGRepresentation</span>(originImage, <span class="number">1</span>.0f);</span><br><span class="line"><span class="type">NSString</span> <span class="operator">*</span>encodedImageStr <span class="operator">=</span> [data base64EncodedStringWithOptions:<span class="type">NSDataBase64Encoding64CharacterLineLength</span>];</span><br></pre></td></tr></table></figure></li><li>Base64字符串转UIImage图片：  <figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSData</span> <span class="operator">*</span>decodedImageData <span class="operator">=</span> [[<span class="type">NSData</span> alloc] </span><br><span class="line">initWithBase64EncodedString:encodedImageStr options:<span class="type">NSDataBase64DecodingIgnoreUnknownCharacters</span>];</span><br><span class="line"><span class="type">UIImage</span> <span class="operator">*</span>decodedImage <span class="operator">=</span> [<span class="type">UIImage</span> imageWithData:decodedImageData];</span><br></pre></td></tr></table></figure></li></ul><h3 id="分析base64（个人理解，有其它见解请指教）"><a href="#分析base64（个人理解，有其它见解请指教）" class="headerlink" title="分析base64（个人理解，有其它见解请指教）"></a>分析base64（个人理解，有其它见解请指教）</h3><pre><code>data:image/jpg;base64,/9j/4Rbi.....GNWCdROn0HRe0dwb5G3CcC+C/pimS2dHAaQNXqft6//Z</code></pre><ul><li><code>data</code> 表示开始、<code>//Z</code> 表示结束</li><li><code>image</code> 内容类型</li><li><code>jpg</code> 图片类型</li><li><code>base64</code>内容开始标记</li></ul>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS高精度计算</title>
      <link href="/iOSHighPrecisionComputation.html"/>
      <url>/iOSHighPrecisionComputation.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>参考 </p><p><a href="http://blog.csdn.net/tqwei00001/article/details/53219404">iOS开发中高精度数值(货币)计算</a></p><p><a href="http://chuansong.me/n/1560106">iOS 中的数据结构和算法（一）：浮点数</a> </p></blockquote><h2 id="货币计算"><a href="#货币计算" class="headerlink" title="货币计算"></a>货币计算</h2><p>使用 <code>@interface NSDecimalNumber : NSNumber</code></p><p>成员方法：</p><ul><li>Adding 加法</li><li>Subtracting 减法</li><li>Multiplying 乘法</li><li>Dividing 除法</li><li>RaisingToPower 幂次方</li><li>MultiplyingByPowerOf10 指数</li></ul><h2 id="高精度算法"><a href="#高精度算法" class="headerlink" title="高精度算法"></a>高精度算法</h2><span id="more"></span><p>摘自唐巧的总结：</p><ul><li>浮点数在计算机内部并不是严格精确到每一位的。</li><li>在判断两个浮点数相等时，不能使用 == 操作符，需要通过比较两个浮点数差的绝对值，是否小于一个极小数的方式来判断。</li><li>如果你需要精确的浮点数计算，需要使用高精度算法。</li></ul><p>提示：</p><ol><li>用两个数组来分别存放浮点数的整数部分和小数部分，数组中的每一个元素代表浮点数某一位的值；</li><li>在计算两个浮点数的加法时，两个数组分别进行相加求和；</li><li>需要处理进位和对齐，整数部分按低位对齐，小数部分按高位对齐。</li></ol><p>算法代码，请指教：</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 0.参与运算的数据</span></span><br><span class="line"><span class="type">NSString</span> <span class="operator">*</span>numberA <span class="operator">=</span> @<span class="string">&quot;555554.999999&quot;</span>; <span class="comment">// 数据A</span></span><br><span class="line"><span class="type">NSString</span> <span class="operator">*</span>numberB <span class="operator">=</span> @<span class="string">&quot;111111.666667&quot;</span>; <span class="comment">// 数据B</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">// 1.分离整数部分和小数部分</span></span><br><span class="line"><span class="comment">/// 1.1数据A</span></span><br><span class="line"><span class="type">NSMutableArray</span> <span class="operator">*</span>numberAArray <span class="operator">=</span> [<span class="type">NSMutableArray</span> new];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">NSString</span> <span class="operator">*</span>number <span class="keyword">in</span> [numberA componentsSeparatedByString:@<span class="string">&quot;.&quot;</span>]) &#123;</span><br><span class="line">    [numberAArray addObject:number];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/// 1.2数据B</span></span><br><span class="line"><span class="type">NSMutableArray</span> <span class="operator">*</span>numberBArray <span class="operator">=</span> [<span class="type">NSMutableArray</span> new];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">NSString</span> <span class="operator">*</span>number <span class="keyword">in</span> [numberB componentsSeparatedByString:@<span class="string">&quot;.&quot;</span>]) &#123;</span><br><span class="line">    [numberBArray addObject:number];</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 2.补0，整数部分补前面、小数部分补后面，使位数相等</span></span><br><span class="line"><span class="comment">/// 2.1整数位补0</span></span><br><span class="line">long flag <span class="operator">=</span> [numberAArray[<span class="number">0</span>] length] <span class="operator">-</span> [numberBArray[<span class="number">0</span>] length];</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> (flag <span class="operator">&gt;</span> <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (int i <span class="operator">=</span> <span class="number">0</span>; i <span class="operator">&lt;</span> flag; i<span class="operator">++</span>) &#123;</span><br><span class="line">        numberBArray[<span class="number">0</span>] <span class="operator">=</span> [<span class="type">NSString</span> stringWithFormat:@<span class="string">&quot;0%@&quot;</span>,numberBArray[<span class="number">0</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (flag <span class="operator">&lt;</span> <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (int i <span class="operator">=</span> <span class="number">0</span>; i <span class="operator">&lt;</span> labs(flag); i<span class="operator">++</span>) &#123;</span><br><span class="line">        numberAArray[<span class="number">0</span>] <span class="operator">=</span> [<span class="type">NSString</span> stringWithFormat:@<span class="string">&quot;0%@&quot;</span>,numberAArray[<span class="number">0</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/// 2.2小数位补0</span></span><br><span class="line">flag <span class="operator">=</span> [numberAArray[<span class="number">1</span>] length] <span class="operator">-</span> [numberBArray[<span class="number">1</span>] length];</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> (flag <span class="operator">&gt;</span> <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (int i <span class="operator">=</span> <span class="number">0</span>; i <span class="operator">&lt;</span> flag; i<span class="operator">++</span>) &#123;</span><br><span class="line">        numberBArray[<span class="number">1</span>] <span class="operator">=</span> [<span class="type">NSString</span> stringWithFormat:@<span class="string">&quot;%@0&quot;</span>,numberBArray[<span class="number">1</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (flag <span class="operator">&lt;</span> <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (int i <span class="operator">=</span> <span class="number">0</span>; i <span class="operator">&lt;</span> labs(flag); i<span class="operator">++</span>) &#123;</span><br><span class="line">        numberAArray[<span class="number">1</span>] <span class="operator">=</span> [<span class="type">NSString</span> stringWithFormat:@<span class="string">&quot;%@0&quot;</span>,numberAArray[<span class="number">1</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 3.分开相加，先小数部分、后整数部分</span></span><br><span class="line"><span class="comment">/// 3.1小数位相加</span></span><br><span class="line"><span class="type">NSString</span> <span class="operator">*</span>temp1A <span class="operator">=</span> numberAArray[<span class="number">1</span>];</span><br><span class="line"><span class="type">NSString</span> <span class="operator">*</span>temp1B <span class="operator">=</span> numberBArray[<span class="number">1</span>];</span><br><span class="line"><span class="type">NSString</span> <span class="operator">*</span>temp1 <span class="operator">=</span> @<span class="string">&quot;&quot;</span>;</span><br><span class="line">int add <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (int i <span class="operator">=</span> <span class="number">0</span>; i <span class="operator">&lt;</span> [temp1A length]; i<span class="operator">++</span>) &#123;</span><br><span class="line">    <span class="type">NSRange</span> range <span class="operator">=</span> <span class="type">NSMakeRange</span>([temp1A length]<span class="operator">-</span>i<span class="operator">-</span><span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    int tempA <span class="operator">=</span> [[temp1A substringWithRange:range] intValue];</span><br><span class="line">    int tempB <span class="operator">=</span> [[temp1B substringWithRange:range] intValue];</span><br><span class="line">    </span><br><span class="line">    int sum <span class="operator">=</span> tempA <span class="operator">+</span> tempB <span class="operator">+</span> add;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (sum <span class="operator">&gt;=</span> <span class="number">10</span>) &#123;</span><br><span class="line">        add <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        sum <span class="operator">-=</span> <span class="number">10</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        add <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    temp1 <span class="operator">=</span> [<span class="type">NSString</span> stringWithFormat:@<span class="string">&quot;%d%@&quot;</span>,sum, temp1];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/// 3.2整数位相加</span></span><br><span class="line"><span class="type">NSString</span> <span class="operator">*</span>temp0A <span class="operator">=</span> numberAArray[<span class="number">0</span>];</span><br><span class="line"><span class="type">NSString</span> <span class="operator">*</span>temp0B <span class="operator">=</span> numberBArray[<span class="number">0</span>];</span><br><span class="line"><span class="type">NSString</span> <span class="operator">*</span>temp0 <span class="operator">=</span> @<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (int i <span class="operator">=</span> <span class="number">0</span>; i <span class="operator">&lt;</span> [temp0A length]; i<span class="operator">++</span>) &#123;</span><br><span class="line">    <span class="type">NSRange</span> range <span class="operator">=</span> <span class="type">NSMakeRange</span>([temp0A length]<span class="operator">-</span>i<span class="operator">-</span><span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    int tempA <span class="operator">=</span> [[temp0A substringWithRange:range] intValue];</span><br><span class="line">    int tempB <span class="operator">=</span> [[temp0B substringWithRange:range] intValue];</span><br><span class="line">    </span><br><span class="line">    int sum <span class="operator">=</span> tempA <span class="operator">+</span> tempB <span class="operator">+</span> add;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (sum <span class="operator">&gt;=</span> <span class="number">10</span>) &#123;</span><br><span class="line">        add <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        sum <span class="operator">-=</span> <span class="number">10</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        add <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    temp0 <span class="operator">=</span> [<span class="type">NSString</span> stringWithFormat:@<span class="string">&quot;%d%@&quot;</span>,sum, temp0];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.打印结果</span></span><br><span class="line"><span class="type">NSLog</span>(@<span class="string">&quot;%@ + %@ = %@.%@&quot;</span>, numberA, numberB, temp0, temp1);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS内存管理</title>
      <link href="/iOSAboutMemoryManagement.html"/>
      <url>/iOSAboutMemoryManagement.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="关于内存管理"><a href="#关于内存管理" class="headerlink" title="关于内存管理"></a>关于内存管理</h2><blockquote><p>参考：</p><p>1、<a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html">官方文档</a>  2、<a href="http://blog.devtang.com/2016/07/30/ios-memory-management/">唐巧-理解iOS的内存管理</a></p></blockquote><p>应用程序内存管理是指程序运行时内存分配、使用、完成后释放的管理。一个好的程序尽可能少使用内存。<br><img src="./images/iOSAboutMemoryManagement-Theory.png" alt="引用计数原理" title="引用计数原理"></p><h2 id="管理方法"><a href="#管理方法" class="headerlink" title="管理方法"></a>管理方法</h2><p>Objective-C提供两种应用程序内存管理方法：</p><span id="more"></span><ol><li>手动管理（manual retain-release，简称MRR，国内习惯叫MRC），通过跟踪拥有的对象来明确管理内存。这是使用基础类NSObject与运行时环境结合提供的模型（称为引用计数）来实现的。</li><li>自动引用计数（Automatic Reference Count，简称ARC），在2011年WWD上提出的。ARC背后的原理是依赖编译器的静态分析能力，通过在编译时找出合理地方插入引用计数管理代码。</li></ol><p>注：引用计数（Reference Count）是一个简单而有效的管理对象生命周期的方式。引用计数真正能派上用场的场景是在面向对象的程序设计架构中，用于对象之间传递和共享数据。</p><h2 id="基本原则"><a href="#基本原则" class="headerlink" title="基本原则"></a>基本原则</h2><p>任何 new、alloc 或 copy 都要有相应的 release 或 autorelease</p><h2 id="良好做法防止内存相关问题"><a href="#良好做法防止内存相关问题" class="headerlink" title="良好做法防止内存相关问题"></a>良好做法防止内存相关问题</h2><p>内存管理不正确导致的主要问题有两种：</p><ol><li>释放或重写仍在使用的数据。这会导致内存损坏，并且通常会导致应用程序崩溃，甚至导致用户数据损坏；</li><li>不释放不再使用的数据会导致内存泄漏。内存泄漏的地方不会被使用，从而内存使用量不断增加，导致系统性能差或应用被终止。</li></ol><h2 id="ARC下的内存管理问题"><a href="#ARC下的内存管理问题" class="headerlink" title="ARC下的内存管理问题"></a>ARC下的内存管理问题</h2><p>ARC能够解决iOS开发中90%的内存管理问题，但是另外还有10%内存管理，是需要开发者自己处理的，这主要就是与底层 Core Foundation 对象交互的那部分，底层的 Core Foundation 对象由于不在 ARC 的管理下，所以需要自己维护这些对象的引用计数。</p><p>主要体现在：</p><ol><li>过度使用 block 之后，无法解决循环引用问题；</li><li>遇到底层 Core Foundation 对象，需要自己手工管理它们的引用计数。</li></ol><h3 id="循环引用（Reference-Cycle）问题"><a href="#循环引用（Reference-Cycle）问题" class="headerlink" title="循环引用（Reference Cycle）问题"></a>循环引用（Reference Cycle）问题</h3><p>例如：</p><ul><li>Controller 持有网络请求对象</li><li>网络请求对象持有回调的 block</li><li>回调的 block 里使用 self，所以持有了 Controller</li></ul><h4 id="主动断开"><a href="#主动断开" class="headerlink" title="主动断开"></a>主动断开</h4><p>在网络请求结束后，网络请求对象执行完  block 之后，主动释放对于 block 的持有，以便打破循环引用。</p><h4 id="使用弱引用"><a href="#使用弱引用" class="headerlink" title="使用弱引用"></a>使用弱引用</h4><p>弱引用虽然持有对象，但是并不增加引用计数，这样就避免了循环引用的产生。</p><h4 id="弱引用的实现原理："><a href="#弱引用的实现原理：" class="headerlink" title="弱引用的实现原理："></a>弱引用的实现原理：</h4><p>系统对于每一引有弱引用的对象，都维护一个表来记录它所有的弱引用的指针地址。这样，当一个对象的引用计数为0时，系统就通过这张表，找到所有的弱引用指针，继而把它们都置成nil。</p><h3 id="使用-Xcode-检测循环引用"><a href="#使用-Xcode-检测循环引用" class="headerlink" title="使用 Xcode 检测循环引用"></a>使用 Xcode 检测循环引用</h3><p>Xcode 的 Instruments 工具集可以很方便的检测循环引用。在 Xcode 的菜单选择： Project -&gt; Profile，然后选择 Leaks，如图：</p><p><img src="./images/iOSAboutMemoryManagement-Leaks.png" alt="Leaks" title="Leaks"></p><h4 id="Core-Foundation-对象的内存管理"><a href="#Core-Foundation-对象的内存管理" class="headerlink" title="Core Foundation 对象的内存管理"></a>Core Foundation 对象的内存管理</h4><p>底层的 Core Foundation 对象，在创建时大多以 XxxCreateWithXxx 这样的方式创建，例如：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个 CFStringRef 对象</span></span><br><span class="line">CFStringRef str= CFStringCreateWithCString(kCFAllocatorDefault, <span class="string">&quot;hello world&quot;</span>, kCFStringEncodingUTF8);</span><br><span class="line"><span class="comment">// 创建一个 CTFontRef 对象</span></span><br><span class="line">CTFontRef fontRef = CTFontCreateWithName((CFStringRef)@<span class="string">&quot;ArialMT&quot;</span>, fontSize, <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure><p>对于这些对象的引用计数的修改，要相应的使用 CFRetain 和 CFRelease 方法。如下所示：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个 CTFontRef 对象</span></span><br><span class="line">CTFontRef fontRef = CTFontCreateWithName((CFStringRef)@<span class="string">&quot;ArialMT&quot;</span>, fontSize, <span class="literal">NULL</span>);</span><br><span class="line"><span class="comment">// 引用计数加 1</span></span><br><span class="line">CFRetain(fontRef);</span><br><span class="line"><span class="comment">// 引用计数减 1</span></span><br><span class="line">CFRelease(fontRef);</span><br></pre></td></tr></table></figure><p>在 ARC 下将一个 Core Foundation 对象转换成一个 Objective-C 对象，这时需要告诉编译器，转换过程中的引用计数需要做如何的调整。这就引入了 bridge 相关的关键字，以下是这引起关键字的说明：</p><ul><li>__bridge：只做类型转换，不修改相关对象的引用计数，原来的 Core Foundation 对象在不用时，需要调用 CFRelease 方法。</li><li>__bridge_retained：类型转换后，将相关对象的引用计数加1，原来的 Core Foundation 对象在不用时，需要调用 CFRelease 方法。</li><li>__bridge_transfer：类型转换后，将该对象的引用计数交给 ARC 管理， Core Foundation 对象在不用时，不再需要调用 CFRelease 方法。</li></ul><h4 id="C-语言代码的内存管理"><a href="#C-语言代码的内存管理" class="headerlink" title="C 语言代码的内存管理"></a>C 语言代码的内存管理</h4><p>需要使用free(void *)函数来释放动态分配的内存空间，如：malloc、copy等。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">objc_property_t</span> *ivars = class_copyPropertyList([self class], &amp;count);</span><br><span class="line"><span class="comment">//more</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(ivars);</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>在 ARC 的帮助下，iOS开发者的内存管理工作已经被大大减轻，但是我们仍然需要理解引用计数这种内存管理方式的优点和常见问题，特别要注意解决要注意避免循环引问题。</p><ul><li>对于循环引用的问题有两种主要解决办法，一是主动断开循环引用，二是使用弱引用的方式避免循环引用。</li><li>对于 Core Foundation 对象，由于不在 ARC 管理之下，我们仍需要延续之前手工管理引用计数的办法。</li><li>对于使用 C 语言动态分配的内存空间，不在 ARC 管理下，需要使用C语言的 free(void *) 函数释放内存。 </li><li>在调试内存问题时， Instruments 工具可以很好的对我们辅助，善用 Instruments 可以节省我们大量的调试时间。</li></ul><h2 id="MRR转ARC（个人想法）"><a href="#MRR转ARC（个人想法）" class="headerlink" title="MRR转ARC（个人想法）"></a>MRR转ARC（个人想法）</h2><ol><li>在 Compile Sources 中相应的 .m文件删除 -fno-objc-arc；</li><li>删除相应的 retain 、release 和 autorelease。</li></ol>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>办理护照</title>
      <link href="/IssuePassport.html"/>
      <url>/IssuePassport.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="准备材料"><a href="#准备材料" class="headerlink" title="准备材料"></a>准备材料</h2><ol><li>照电子版照片（需要光盘刻录，不便宜）；</li><li>身份证原件。</li></ol><h2 id="办理流程"><a href="#办理流程" class="headerlink" title="办理流程"></a>办理流程</h2><p>地点：户口所在地公安局出入境</p><p>流程： </p><ol><li>将电子版照片和身份证交给工作人员；</li><li>录电子签名（写纸上就行，工作人员会扫描成电子版）；</li><li>录入指纹（我录的是左、右手的拇指）</li><li>缴费￥200（去银行转账给工作人员，拿转账回执单交给工作人员）；</li><li>领取申请条。</li></ol><ul><li>注：支持邮寄（￥40），需要将申请条交给工作人员，留下收件人地址后建议记下他们单位联系方式。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Print </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>异地购房公积金提取</title>
      <link href="/ProvidentFundExtract.html"/>
      <url>/ProvidentFundExtract.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>参考<a href="http://www.bjgjj.gov.cn/bszn/gjjbszn/201606/t20160623_3907.html">北京公积金官方文档</a></p></blockquote><p>所需材料：</p><ol><li>房本（《不动产权证书》）复印件（1、2、3页）；</li><li>契税完税证（《中华人民共和国税收完税证明》，税种为契税）（原件及复印件）；</li><li>身份证复印件一张；</li><li>公积金联名卡复印件一张；</li><li>异地购房证明（需加盖客户公章）；</li><li>近一年社保证明；</li><li>《房产交易申报单》复印件一张（可选，如果契税的备注一栏没有交易金额则需要）</li></ol><p><img src="./images/ProvidentFundExtract.png" alt="材料附图" title="材料附图"></p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Print </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>黑苹果修改键位</title>
      <link href="/HackintoshKeyboard.html"/>
      <url>/HackintoshKeyboard.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>前言：装了黑苹果，Windows键盘的键位用不习惯，于是有了以下操作。</p></blockquote><h2 id="⌘和⌥设置"><a href="#⌘和⌥设置" class="headerlink" title="⌘和⌥设置"></a>⌘和⌥设置</h2><p>打开 <code>系统偏好设置</code>→<code>键盘</code>→<code>修饰键</code>，选择相应的键位，如图：</p><p><img src="../images/HackintoshKeyboard-ModifierKeys.png" alt="键盘设置界面"></p><span id="more"></span><h2 id="Launchpad设置"><a href="#Launchpad设置" class="headerlink" title="Launchpad设置"></a>Launchpad设置</h2><p>打开 <code>系统偏好设置</code>→<code>键盘</code>→<code>修饰键</code>→<code>快捷键</code>→<code>Launchpad 与 Dock</code>，设置如图：</p><p><img src="../images/HackintoshKeyboard-Launchpad.png" alt="Launchpad设置"></p><h2 id="Mission-Control设置"><a href="#Mission-Control设置" class="headerlink" title="Mission Control设置"></a>Mission Control设置</h2><p>打开 <code>系统偏好设置</code>→<code>键盘</code>→<code>修饰键</code>→<code>快捷键</code>→<code>Mission Control</code>，设置如图：</p><p><img src="../images/HackintoshKeyboard-MissionControl.png" alt="Mission Control设置"></p>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Print </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>找回身份证</title>
      <link href="/FindIDCard.html"/>
      <url>/FindIDCard.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>讲述一段亲身经历，打车身份证落车上找回</p></blockquote><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>北京西站下车后打车回住处，到家后发现身份证和车票丢失</p><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><ol><li>火车出站时走的是人工检票，且车票和身份证在一起，说明是在出站后丢失的</li><li>出站后直接去乘车，期间没有跟任何人接触，乘车路上丢的可能性较小</li><li>目标锁定在出租车上，可能是下车的时候掉出来的，因为踩的较高</li><li>如果是去乘车路上丢的，找回就会机率渺茫，只能异地补办</li><li>如果是在出租车上丢的，可以尝试找回</li></ol><span id="more"></span><h2 id="找回"><a href="#找回" class="headerlink" title="找回"></a>找回</h2><ol><li>小票上有出租车公司的电话、车号、司机证号等信息，打他们电话</li><li>提供相关信息（下车时间、始发地、目的地、车号），让客服找到司机并确认失物</li><li>得到司机电话</li><li>司机派送</li></ol><p>注：让人师傅打表过来的人没打，给了人一盒玉溪，不能让人白跑不是</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li>丢失后要冷静分析，什么时间段在哪儿丢的，或者可能丢的</li><li>打车记得要小票</li><li>出租车公司的电话经常占线不好打，一定要坚持</li></ol><h2 id="附：小票"><a href="#附：小票" class="headerlink" title="附：小票"></a>附：小票</h2><p><img src="./images/FindIDCard.png" alt="小票"></p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 北京 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows端口被占用</title>
      <link href="/ECSPortUsed.html"/>
      <url>/ECSPortUsed.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>Windows 443 商品被占用处理</p></blockquote><h2 id="查看占用进程PID"><a href="#查看占用进程PID" class="headerlink" title="查看占用进程PID"></a>查看占用进程PID</h2><p>在DOS中运行 <code>netstat -ano|findstr &quot;443&quot;</code> 查看</p><h2 id="结束进程"><a href="#结束进程" class="headerlink" title="结束进程"></a>结束进程</h2><h3 id="taskkill"><a href="#taskkill" class="headerlink" title="taskkill"></a>taskkill</h3><p>使用 <code>taskkill</code>，DOS中执行 <code>taskkill /PID xx</code> </p><h3 id="任务管理器"><a href="#任务管理器" class="headerlink" title="任务管理器"></a>任务管理器</h3><p>打开<code>任务管理器</code>，查看中选择<code>PID</code>，然后在<code>进程</code>中结束</p><h3 id="system进程占用"><a href="#system进程占用" class="headerlink" title="system进程占用"></a>system进程占用</h3><p>停止 <code>Routing and Remote Access</code> 服务，完事儿后记得启动</p>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ipa打包、上传至pgyer.com</title>
      <link href="/AutomaticDeploymentToPgyer.html"/>
      <url>/AutomaticDeploymentToPgyer.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>实现ipa打包、上传<br>环境：Mac OS 10.12、Xcode 8.3、Python 2.7.10<br>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p></blockquote><h2 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h2><h3 id="使用官方的-xcodebuild-命令"><a href="#使用官方的-xcodebuild-命令" class="headerlink" title="使用官方的 xcodebuild 命令"></a>使用官方的 <code>xcodebuild</code> 命令</h3><blockquote><p>cd 到工程根目录（工程使用cocoapods管理）</p></blockquote><ol><li><p>清空缓存 clean</p><pre><code> $ xcodebuild clean -workspace MyWorkspace.xcworkspace -scheme MyScheme </code></pre></li><li><p>归档 archive </p><span id="more"></span><pre><code> $ xcodebuild archive -workspace MyWorkspace.xcworkspace -scheme MyScheme -archivePath ./build/MyWorkspace.xcarchive </code></pre><ul><li><code>archive</code>：归档为 <code>.xcarchive</code>文件（*Archive a scheme from the build root (SYMROOT).  This requires specifying a scheme.*）</li><li><code>-workspace</code>：当前目录下<code>.xcworkspace</code>文件路径（<em>Build the workspace name.xcworkspace</em></li><li><code>-scheme</code>：项目的<code>scheme</code>（<em>Build the scheme specified by schemename.  Required if building a workspace</em>），可执行<code>xcodebuild -list</code>查看    </li><li><code>-archivePath</code>：归档后文件位置（<em>Specifies the path for the archive produced by the archive action, or specifies the archive that should be exported when -exportArchive is passed</em>）</li></ul></li><li><p>导出 ipa</p><pre><code> $ xcodebuild -exportArchive -archivePath ./build/MyWorkspace.xcarchive -exportPath ./build/ -exportOptionsPlist ./build/export.plist </code></pre><ul><li><p><code>-exportArchive</code>：导出iad文件（<em>Specifies that an archive should be exported. Requires -archivePath, -exportPath, and -exportOptionsPlist.  Cannot be passed along with an action</em>）</p></li><li><p><code>-archivePath</code>：同上</p></li><li><p><code>-exportPath</code>：导出的路径（<em>Specifies the destination for the exported product, including the name of the exported file</em>），文件名默认为<code>MyWorkspace.ipa</code></p></li><li><p><code>-exportOptionsPlist</code>：指定一个<code>plist</code>文件（<em>Specifies options for -exportArchive.  xcodebuild -help can print the full set of available options</em>）</p></li><li><p><code>export.plist</code>：<strong>需要手动创建</strong>，注意修改<code>teamID</code>。了解更多执行 <code>xcodebuild -help</code>查看 <em>Available keys for -exportOptionsPlist</em></p>  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">plist</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span> <span class="meta-string">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>method<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>ad-hoc<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>teamID<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>10位字符，你的teamId<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul></li></ol><h3 id="使用三方的-fir-命令"><a href="#使用三方的-fir-命令" class="headerlink" title="使用三方的 fir 命令"></a>使用三方的 <code>fir</code> 命令</h3><p>准备：<a href="https://github.com/FIRHQ/fir-cli/blob/master/doc/install.md">安装fir-cli</a></p><pre><code>$ fir build_ipa path/to/workspace -w -S &lt;scheme name&gt;</code></pre><p>执行完成后会生成<code>fir_build</code>文件夹，更多信息<a href="https://github.com/FIRHQ/fir-cli/blob/master/doc/build_ipa.md">参考官方说明</a></p><h2 id="上传（发布）"><a href="#上传（发布）" class="headerlink" title="上传（发布）"></a>上传（发布）</h2><blockquote><p>将ipa包上传至pgyer.com，主要使用Web、<a href="https://www.pgyer.com/apps/">桌面客户端</a>、<a href="https://www.pgyer.com/doc/api#uploadApp">开放API</a>、<a href="https://www.pgyer.com/doc/view/fastlane">FastLane</a>、<a href="https://www.pgyer.com/doc/view/xcode_plugin">Xcode 插件</a>、<a href="https://www.pgyer.com/doc/view/jenkins_ios">Jenkins</a></p></blockquote><h3 id="使用一条命令快速上传应用"><a href="#使用一条命令快速上传应用" class="headerlink" title="使用一条命令快速上传应用"></a>使用一条命令快速上传应用</h3><pre><code>curl -F &quot;file=@&#123;$filePath&#125;&quot; \-F &quot;uKey=&#123;$uKey&#125;&quot; \-F &quot;_api_key=&#123;$apiKey&#125;&quot; \https://www.pgyer.com/apiv1/app/upload</code></pre><ul><li>ilePath：是应用安装包文件的路径</li><li>uKey：是开发者的用户 Key，在应用管理-API中查看</li><li>apiKey：是开发者的 API Key，在应用管理-API中查看</li></ul><h2 id="Python-自动部署"><a href="#Python-自动部署" class="headerlink" title="Python 自动部署"></a>Python 自动部署</h2><blockquote><p>脚本集成实现打包、上传、发邮件通知功能，注意阅读<strong>使用说明</strong></p><p>以下代码有用拿走，有优化请 <a href="mailto:hertz@hertzwang.com"><strong>反馈</strong></a></p></blockquote><p>使用<code>Python</code> 封装 <code>xcodebuild</code> 自动布置 pgyer.com，支持邮件通知</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> email <span class="keyword">import</span> encoders</span><br><span class="line"><span class="keyword">from</span> email.header <span class="keyword">import</span> Header</span><br><span class="line"><span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText</span><br><span class="line"><span class="keyword">from</span> email.mime.multipart  <span class="keyword">import</span> MIMEMultipart</span><br><span class="line"><span class="keyword">from</span> email.utils <span class="keyword">import</span> parseaddr, formataddr</span><br><span class="line"><span class="keyword">import</span> smtplib</span><br><span class="line"></span><br><span class="line"><span class="comment">#  当前版本：v1.0.1</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">## 使用说明：</span></span><br><span class="line"><span class="comment">## 0.修改开发人员名称、测试人员名称、App名称，会在邮件中使用</span></span><br><span class="line"><span class="comment">## 1.将该文件放置工程根目录（与.xcworkspace同级）</span></span><br><span class="line"><span class="comment">## 2.修改以下相关信息：项目名称、scheme名称、teamId、pgyer Info相关和email相关</span></span><br><span class="line"><span class="comment">## 3.修改删除ipa标记</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 项目相关设置</span></span><br><span class="line"><span class="comment">## 开发人员</span></span><br><span class="line">dev_name = <span class="string">&#x27;-&#x27;</span></span><br><span class="line"><span class="comment">## 测试人员</span></span><br><span class="line">tester_name = <span class="string">&#x27;-&#x27;</span></span><br><span class="line"><span class="comment">## 项目名称</span></span><br><span class="line">project_name = <span class="string">&quot;-&quot;</span></span><br><span class="line"><span class="comment">## 项目根目录,结尾不带 &quot;/&quot;，目前使用的是相对路径（可不修改）</span></span><br><span class="line">project_path = <span class="string">&quot;.&quot;</span></span><br><span class="line"><span class="comment">## scheme名称（终端进入工程根目录，执行 xcodebuild -list）</span></span><br><span class="line">scheme_name = <span class="string">&quot;-&quot;</span></span><br><span class="line"><span class="comment">## App 名称（邮件中使用）</span></span><br><span class="line">app_name = <span class="string">&quot;-&quot;</span></span><br><span class="line"><span class="comment">## teamId</span></span><br><span class="line">team_id = <span class="string">&quot;-&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pgyer Info</span></span><br><span class="line">api_key = <span class="string">&quot;-&quot;</span></span><br><span class="line">user_key = <span class="string">&quot;-&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># email</span></span><br><span class="line"><span class="comment">## 发件人邮箱账号</span></span><br><span class="line">from_addr = <span class="string">&quot;-&quot;</span></span><br><span class="line"><span class="comment">## 发件人邮箱密码</span></span><br><span class="line">password = <span class="string">&quot;-&quot;</span></span><br><span class="line"><span class="comment">## 邮箱服务地址</span></span><br><span class="line">smtp_server = <span class="string">&quot;-&quot;</span></span><br><span class="line"><span class="comment">## 收件人，多个用&quot;,&quot;分开</span></span><br><span class="line">to_addr = <span class="string">&#x27;-&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除ipa标记，默认为 False</span></span><br><span class="line">clear_ipa = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行返回结果</span></span><br><span class="line">result_not_exist = <span class="number">256</span></span><br><span class="line">result_not_found = <span class="string">&quot;Not found&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 清空缓存</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xcb_clean</span>():</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;clean...&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;cd %s;xcodebuild clean -workspace %s/%s.xcworkspace -scheme %s&#x27;</span> % (project_path,project_path,project_name,scheme_name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成plist文件</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_plist_file</span>():</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;generate export.plist&#x27;</span>)</span><br><span class="line">    plistText = <span class="string">&quot;&quot;&quot;\</span></span><br><span class="line"><span class="string">        &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="string">        &lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;plist version=&quot;1.0&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;dict&gt;</span></span><br><span class="line"><span class="string">                &lt;key&gt;method&lt;/key&gt;</span></span><br><span class="line"><span class="string">                &lt;string&gt;ad-hoc&lt;/string&gt;</span></span><br><span class="line"><span class="string">                &lt;key&gt;teamID&lt;/key&gt;</span></span><br><span class="line"><span class="string">                &lt;string&gt;%s&lt;/string&gt;</span></span><br><span class="line"><span class="string">            &lt;/dict&gt;</span></span><br><span class="line"><span class="string">        &lt;/plist&gt;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span> % (team_id)</span><br><span class="line">    plist = <span class="built_in">open</span>(<span class="string">&quot;%s/build/export.plist&quot;</span> % project_path, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">    plist.write(plistText)</span><br><span class="line">    plist.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 归档为.xcarchive格式</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xcb_archive</span>():</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;archive...&#x27;</span>)</span><br><span class="line">    build_path = <span class="string">&#x27;%s/build&#x27;</span> % project_path</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(build_path) == <span class="literal">False</span>:</span><br><span class="line">        os.system(<span class="string">&#x27;mkdir %s&#x27;</span> % build_path)</span><br><span class="line">    os.system(<span class="string">&#x27;xcodebuild archive -workspace %s/%s.xcworkspace -scheme %s -archivePath %s/build/%s.xcarchive&#x27;</span> % (project_path,project_name,scheme_name,project_path,project_name))</span><br><span class="line">    <span class="comment"># 生成plist文件，用于打包</span></span><br><span class="line">    generate_plist_file()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行命令，并返回输出值</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_cmd</span>(<span class="params">cmd</span>):</span></span><br><span class="line">    r = os.popen(cmd)</span><br><span class="line">    text = r.read()</span><br><span class="line">    r.close()</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取build版本号：使用正则</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_build_version</span>():</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;get build version...&#x27;</span>)</span><br><span class="line">    <span class="keyword">global</span> build_version</span><br><span class="line">    <span class="comment"># 通过Info.plist，查询build版本  </span></span><br><span class="line">    cmd = <span class="string">&quot;cat %s/%s/Info.plist&quot;</span> % (project_path,project_name)</span><br><span class="line">    cmdlog = exec_cmd(cmd)</span><br><span class="line">    regex = re.<span class="built_in">compile</span>(<span class="string">r&quot;\d+\.\d+\.\d+\.\d&quot;</span>)</span><br><span class="line">    build_version = regex.findall(cmdlog)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导出ipa</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xcb_exportArchive</span>():</span></span><br><span class="line">    <span class="keyword">global</span> ipa_filename</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;exportArchive...&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;它没有停止，只是需要时间，请稍等&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;xcodebuild -exportArchive -archivePath %s/build/%s.xcarchive -exportPath %s/build/ -exportOptionsPlist %s/build/export.plist&#x27;</span> % (project_path,project_name,project_path,project_path))</span><br><span class="line">    <span class="comment"># 获取build版本号</span></span><br><span class="line">    get_build_version()</span><br><span class="line">    <span class="comment"># ipa包重命名</span></span><br><span class="line">    ipa_filename = <span class="string">&quot;%siPhone%s版本&quot;</span> % (app_name, build_version)</span><br><span class="line">    os.system(<span class="string">&#x27;mv %s/build/%s.ipa %s/build/%s.ipa&#x27;</span> % (project_path, project_name, project_path, ipa_filename))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取短连接</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_short_link</span>(<span class="params">text</span>):</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;get short link&#x27;</span>)</span><br><span class="line">    <span class="keyword">global</span> qrcode_url</span><br><span class="line">    <span class="keyword">global</span> short_link</span><br><span class="line">    <span class="comment"># 初始化 short_link</span></span><br><span class="line">    short_link = result_not_found</span><br><span class="line">    <span class="comment"># json 解析上传返回结果</span></span><br><span class="line">    decodejson = json.loads(text)</span><br><span class="line">    shortcut_url = decodejson[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;appShortcutUrl&#x27;</span>]</span><br><span class="line">    qrcode_url = decodejson[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;appQRCodeURL&#x27;</span>]</span><br><span class="line">    qrcode_url = qrcode_url.encode(<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(shortcut_url) &gt; <span class="number">0</span>:</span><br><span class="line">        short_link = <span class="string">&quot;http://www.pgyer.com/%s&quot;</span> % (shortcut_url.encode(<span class="string">&#x27;UTF-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(result_not_found)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上传至 pgyer.com</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload_pgyer</span>():</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;pgyer upload&#x27;</span>)</span><br><span class="line">    filePath = <span class="string">&quot;%s/build/%s.ipa&quot;</span> % (project_path, ipa_filename)</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(filePath):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;uploading...&#x27;</span>)</span><br><span class="line">        <span class="comment"># 使用curl命令上传</span></span><br><span class="line">        cmd = <span class="string">&quot;curl -F &#x27;file=@%s/build/%s.ipa&#x27; -F &#x27;uKey=%s&#x27; -F &#x27;_api_key=%s&#x27; https://qiniu-storage.pgyer.com/apiv1/app/upload&quot;</span> % (project_path,ipa_filename,user_key,api_key)</span><br><span class="line">        <span class="comment"># 获取终端打印信息</span></span><br><span class="line">        cmdlog = exec_cmd(cmd)</span><br><span class="line">        <span class="comment"># 过滤信息，查找短连接</span></span><br><span class="line">        get_short_link(cmdlog)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;没有找到ipa文件&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_format_addr</span>(<span class="params">s</span>):</span></span><br><span class="line">    name, addr = parseaddr(s)</span><br><span class="line">    <span class="keyword">return</span> formataddr((Header(name, <span class="string">&#x27;utf-8&#x27;</span>).encode(), addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发邮件</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_mail</span>():</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;send mail&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> short_link == result_not_found:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment"># 技术参考：https://docs.python.org/2/library/email-examples.html</span></span><br><span class="line">    msg = MIMEMultipart(<span class="string">&#x27;alternative&#x27;</span>)</span><br><span class="line">    <span class="comment"># 邮件标题</span></span><br><span class="line">    msg[<span class="string">&#x27;Subject&#x27;</span>] = Header(<span class="string">&#x27;%siPhone%s版打包程序&#x27;</span> % (app_name,build_version), <span class="string">&#x27;utf-8&#x27;</span>).encode()</span><br><span class="line">    <span class="comment"># 发件人</span></span><br><span class="line">    msg[<span class="string">&#x27;From&#x27;</span>] = _format_addr(<span class="string">&#x27;开发人员（%s）&lt;%s&gt;&#x27;</span> % (dev_name,from_addr))</span><br><span class="line">    <span class="comment"># 收件人</span></span><br><span class="line">    msg[<span class="string">&#x27;To&#x27;</span>] = _format_addr(<span class="string">&#x27;测试人员（%s）&lt;%s&gt;&#x27;</span> % (tester_name,to_addr))</span><br><span class="line">    <span class="comment"># 正文</span></span><br><span class="line">    <span class="comment"># Create the body of the message (a plain-text and an HTML version).</span></span><br><span class="line">    html = <span class="string">&quot;&quot;&quot;\</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">          &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">          &lt;body&gt;</span></span><br><span class="line"><span class="string">            &lt;p&gt;Hi!&lt;br&gt;</span></span><br><span class="line"><span class="string">              &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;%siPhone%s版本已经打包完毕，请前往&lt;a href=%s&gt;%s&lt;/a&gt;下载测试！&lt;br&gt;</span></span><br><span class="line"><span class="string">              &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;或扫描下方二维码：</span></span><br><span class="line"><span class="string">            &lt;/p&gt;</span></span><br><span class="line"><span class="string">            &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;img src=&quot;%s&quot;&gt;</span></span><br><span class="line"><span class="string">          &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span> % (app_name,build_version,short_link,short_link,qrcode_url)</span><br><span class="line">    <span class="comment"># Record the MIME types of both parts - text/plain and text/html.</span></span><br><span class="line">    part = MIMEText(html, <span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Attach parts into message container.</span></span><br><span class="line">    <span class="comment"># According to RFC 2046, the last part of a multipart message, in this case</span></span><br><span class="line">    <span class="comment"># the HTML message, is best and preferred.</span></span><br><span class="line">    msg.attach(part)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 其它设置</span></span><br><span class="line">    server = smtplib.SMTP(smtp_server, <span class="number">25</span>)</span><br><span class="line">    server.set_debuglevel(<span class="number">1</span>)</span><br><span class="line">    server.login(from_addr, password)</span><br><span class="line">    server.sendmail(from_addr, string.splitfields(to_addr, <span class="string">&quot;,&quot;</span>), msg.as_string())</span><br><span class="line">    server.quit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 清理归档文件</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clear_archive_file</span>():</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;清理归档文件...&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;rm -rf %s/build/*.xcarchive&#x27;</span> % project_path)</span><br><span class="line">    <span class="keyword">if</span> clear_ipa == <span class="literal">True</span>:</span><br><span class="line">        os.system(<span class="string">&#x27;rm -rf %s/build/*.ipa&#x27;</span> % project_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    begin_time = time.strftime(<span class="string">&#x27;%Y%m%d%H%M%S&#x27;</span>,time.localtime(time.time()))</span><br><span class="line">    <span class="comment"># 清理缓存</span></span><br><span class="line">    xcb_clean()</span><br><span class="line">    <span class="comment"># 归档为.xcarchive格式</span></span><br><span class="line">    xcb_archive()</span><br><span class="line">    <span class="comment"># 导出ipa</span></span><br><span class="line">    xcb_exportArchive()</span><br><span class="line">    <span class="comment"># 上传pgyer</span></span><br><span class="line">    upload_pgyer()</span><br><span class="line">    <span class="comment"># 发邮件</span></span><br><span class="line">    send_mail()</span><br><span class="line">    <span class="comment"># 清理归档文件</span></span><br><span class="line">    clear_archive_file()</span><br><span class="line">    end_time = time.strftime(<span class="string">&#x27;%Y%m%d%H%M%S&#x27;</span>,time.localtime(time.time()))</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;开始时间：%s \n结束时间：%s&#x27;</span> % (begin_time,end_time))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行</span></span><br><span class="line">main()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># change log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2017.04.11 v1.0.1</span></span><br><span class="line"><span class="comment"># 新增删除 .xcarchive 和 ipa 文件功能，ipa 文件可通过设置 clear_ipa 标记来删除</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 2017.04.11 release v1.0</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ipa打包、上传至fir.im</title>
      <link href="/AutomaticDeploymentToFir.html"/>
      <url>/AutomaticDeploymentToFir.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="安装-fir-cli"><a href="#安装-fir-cli" class="headerlink" title="安装 fir-cli"></a>安装 fir-cli</h2><p>参考官方文档：<a href="https://github.com/FIRHQ/fir-cli/blob/master/doc/install.md">https://github.com/FIRHQ/fir-cli/blob/master/doc/install.md</a></p><p>fir-cli 使用 Ruby 构建, 无需编译, 只要安装相应 gem 即可.</p><pre><code>$ ruby -v$ gem install fir-cli</code></pre><h3 id="安装错误"><a href="#安装错误" class="headerlink" title="安装错误"></a>安装错误</h3><ul><li><p>出现 <code>You don&#39;t have write permissions</code> ：</p><pre><code>  Fetching: thor-0.19.4.gem (100%)  ERROR:  While executing gem ... (Gem::FilePermissionError)      You don&#39;t have write permissions for the /Library/Ruby/Gems/2.0.0 directory.      </code></pre><p>  解决：在命令前加上 <code>sudo</code></p></li></ul><span id="more"></span><ul><li><p>出现 <code>Errno::EPERM</code>：</p><pre><code>  ERROR:  While executing gem ... (Errno::EPERM)      Operation not permitted - /usr/bin/thor</code></pre><p>  解决：重写 Ruby Gem 的 bindir, 执行 <code>echo &#39;gem: --bindir /usr/local/bin&#39; &gt;&gt; ~/.gemrc</code></p></li><li><p>其它错误参考官方文档</p></li></ul><h2 id="编译打包ipa文件"><a href="#编译打包ipa文件" class="headerlink" title="编译打包ipa文件"></a>编译打包ipa文件</h2><p>参考官方文档：<a href="https://github.com/FIRHQ/fir-cli/blob/master/doc/build_ipa.md">https://github.com/FIRHQ/fir-cli/blob/master/doc/build_ipa.md</a></p><p>用 CocoaPods 做依赖管理，打包使用 </p><p><code>fir build_ipa path/to/workspace -w -S &lt;scheme name&gt;</code></p><ul><li>其它方法参考官方文档，也可使用Apple 官方的<code>xcodebuild</code>命令操作，查看文章<a href="./AutomaticDeploymentToPgyer.html">ipa打包、上传至pgyer.com</a></li></ul><h2 id="上传-发布"><a href="#上传-发布" class="headerlink" title="上传(发布)"></a>上传(发布)</h2><p>参考官方文档：<a href="https://github.com/FIRHQ/fir-cli/blob/master/doc/publish.md">https://github.com/FIRHQ/fir-cli/blob/master/doc/publish.md</a> </p><h2 id="Python-自动部署"><a href="#Python-自动部署" class="headerlink" title="Python 自动部署"></a>Python 自动部署</h2><blockquote><p>脚本集成实现打包、上传、发邮件通知功能，注意阅读<strong>使用说明</strong></p><p>以下代码有用拿走，有优化请 <a href="mailto:hertz@hertzwang.com"><strong>反馈</strong></a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> email <span class="keyword">import</span> encoders</span><br><span class="line"><span class="keyword">from</span> email.header <span class="keyword">import</span> Header</span><br><span class="line"><span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText</span><br><span class="line"><span class="keyword">from</span> email.utils <span class="keyword">import</span> parseaddr, formataddr</span><br><span class="line"><span class="keyword">import</span> smtplib</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用说明：</span></span><br><span class="line"><span class="comment">## 0.修改开发人员名称和测试人员名称，会在邮件中使用</span></span><br><span class="line"><span class="comment">## 1.将该文件放置工程根目录（与.xcworkspace同级）</span></span><br><span class="line"><span class="comment">## 2.修改以下相关信息：项目名称、scheme名称、fir token和email相关</span></span><br><span class="line"><span class="comment">## 3.build 版本号必需是四段，否则查不出来（也可修改正则）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 项目相关设置</span></span><br><span class="line"><span class="comment">## 开发人员</span></span><br><span class="line">dev_name = <span class="string">&#x27;-&#x27;</span></span><br><span class="line"><span class="comment">## 测试人员</span></span><br><span class="line">tester_name = <span class="string">&#x27;-&#x27;</span></span><br><span class="line"><span class="comment">## 项目名称</span></span><br><span class="line">project_name = <span class="string">&quot;-&quot;</span></span><br><span class="line"><span class="comment">## 项目根目录,结尾不带 &quot;/&quot;，目前使用的是相对路径（可不修改）</span></span><br><span class="line">project_path = <span class="string">&quot;.&quot;</span></span><br><span class="line"><span class="comment">## scheme名称（终端进入工程根目录，执行 xcodebuild -list）</span></span><br><span class="line">scheme_name = <span class="string">&quot;-&quot;</span></span><br><span class="line"><span class="comment">## App 名称（邮件中使用）</span></span><br><span class="line">app_name = <span class="string">&quot;-&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># fir token</span></span><br><span class="line">fir_api_token = <span class="string">&quot;-&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># email</span></span><br><span class="line"><span class="comment">## 发件人邮箱账号</span></span><br><span class="line">from_addr = <span class="string">&quot;-&quot;</span></span><br><span class="line"><span class="comment">## 发件人邮箱密码</span></span><br><span class="line">password = <span class="string">&quot;-&quot;</span></span><br><span class="line"><span class="comment">## 邮箱服务地址，使用 smtp</span></span><br><span class="line">smtp_server = <span class="string">&quot;smtp.-&quot;</span></span><br><span class="line"><span class="comment">## 收件人，多个用&quot;,&quot;分开</span></span><br><span class="line">to_addr = <span class="string">&#x27;-&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行返回结果</span></span><br><span class="line">result_not_exist = <span class="number">256</span></span><br><span class="line">result_not_found = <span class="string">&quot;Not found&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打包ipa</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_ipa</span>():</span></span><br><span class="line">    <span class="keyword">global</span> ipa_filename</span><br><span class="line">    <span class="comment"># ipa包名，之后会重命名</span></span><br><span class="line">    ipa_filename = <span class="string">&quot;%s&quot;</span> % (project_name)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;building...&#x27;</span>)</span><br><span class="line">    os.system (<span class="string">&#x27;/usr/local/bin/fir build_ipa %s -w -S %s -n %s&#x27;</span> % (project_path,scheme_name,ipa_filename))</span><br><span class="line">    <span class="comment"># 获取build版本</span></span><br><span class="line">    get_build_version()</span><br><span class="line">    <span class="comment"># ipa包重命名</span></span><br><span class="line">    ipa_filename = <span class="string">&quot;%siPhone%s版本&quot;</span> % (app_name, build_version)</span><br><span class="line">    os.system (<span class="string">&#x27;mv %s/fir_build/%s.ipa %s/fir_build/%s.ipa&#x27;</span> % (project_path,project_name,project_path,ipa_filename))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 上传至 fir.im</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload_fir</span>():</span></span><br><span class="line">    filePath = <span class="string">&quot;%s/fir_build/%s.ipa&quot;</span> % (project_path, ipa_filename)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;filePath:%s&#x27;</span> % filePath)</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(filePath):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;uploading...&#x27;</span>)</span><br><span class="line">        <span class="comment"># 直接使用fir 有问题 这里使用了绝对地址 在终端通过 which fir 获得</span></span><br><span class="line">        cmd = <span class="string">&quot;/usr/local/bin/fir publish &#x27;%s&#x27; -T &#x27;%s&#x27;&quot;</span> % (filePath,fir_api_token)</span><br><span class="line">        <span class="comment"># 获取终端打印信息</span></span><br><span class="line">        cmdlog = execCmd(cmd)</span><br><span class="line">        <span class="comment"># 过滤信息，查找短连接</span></span><br><span class="line">        ret = get_short_link(cmdlog)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;没有找到ipa文件&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> result_not_found</span><br><span class="line"></span><br><span class="line"><span class="comment"># execute command, and return the output</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">execCmd</span>(<span class="params">cmd</span>):</span></span><br><span class="line">    r = os.popen(cmd)</span><br><span class="line">    text = r.read()</span><br><span class="line">    r.close()</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_format_addr</span>(<span class="params">s</span>):</span></span><br><span class="line">    name, addr = parseaddr(s)</span><br><span class="line">    <span class="keyword">return</span> formataddr((Header(name, <span class="string">&#x27;utf-8&#x27;</span>).encode(), addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 发邮件</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_mail</span>(<span class="params">short_link</span>):</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 邮件内容</span></span><br><span class="line">    msg = MIMEText(<span class="string">&#x27;Hi:\n    %siPhone%s版本已经打包完毕，请前往%s下载测试！&#x27;</span> % (app_name, build_version, short_link), <span class="string">&#x27;plain&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="comment"># 邮件标题</span></span><br><span class="line">    msg[<span class="string">&#x27;Subject&#x27;</span>] = Header(<span class="string">&#x27;%siPhone%s版打包程序&#x27;</span> % (app_name,build_version), <span class="string">&#x27;utf-8&#x27;</span>).encode()</span><br><span class="line">    <span class="comment"># 发件人</span></span><br><span class="line">    msg[<span class="string">&#x27;From&#x27;</span>] = _format_addr(<span class="string">&#x27;开发人员（%s）&lt;%s&gt;&#x27;</span> % (dev_name,from_addr))</span><br><span class="line">    <span class="comment"># 收件人</span></span><br><span class="line">    msg[<span class="string">&#x27;To&#x27;</span>] = _format_addr(<span class="string">&#x27;测试人员（%s）&lt;%s&gt;&#x27;</span> % (tester_name,to_addr))</span><br><span class="line">    <span class="comment"># 其它设置</span></span><br><span class="line">    server = smtplib.SMTP(smtp_server, <span class="number">25</span>)</span><br><span class="line">    server.set_debuglevel(<span class="number">1</span>)</span><br><span class="line">    server.login(from_addr, password)</span><br><span class="line">    server.sendmail(from_addr, string.splitfields(to_addr, <span class="string">&quot;,&quot;</span>), msg.as_string())</span><br><span class="line">    server.quit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取短连接</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_short_link</span>(<span class="params">text</span>):</span></span><br><span class="line">    urls = re.findall(<span class="string">r&quot;http://fir.im/+\w+&quot;</span>, text)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(urls) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(urls)</span><br><span class="line">        <span class="keyword">return</span> urls[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(result_not_found)</span><br><span class="line">        <span class="keyword">return</span> result_not_found</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取build版本号：使用正则</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_build_version</span>():</span></span><br><span class="line">    <span class="keyword">global</span> build_version</span><br><span class="line">    <span class="comment"># 查询build版本, fir_build 文件夹是 fir 打包生成的</span></span><br><span class="line">    cmd = <span class="string">&quot;fir i ./fir_build/%s.ipa&quot;</span> % (project_name)</span><br><span class="line">    cmdlog = execCmd(cmd)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;cmdlog:%s&#x27;</span> % cmdlog)</span><br><span class="line">    regex = re.<span class="built_in">compile</span>(<span class="string">r&quot;\d+\.\d+\.\d+\.\d&quot;</span>)</span><br><span class="line">    build_version = regex.findall(cmdlog)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    begin_time = time.strftime(<span class="string">&#x27;%Y%m%d%H%M%S&#x27;</span>,time.localtime(time.time()))</span><br><span class="line">    <span class="comment"># 使用fir-cli打包ipa</span></span><br><span class="line">    build_ipa()</span><br><span class="line">    <span class="comment"># 上传fir</span></span><br><span class="line">    short_link = upload_fir()</span><br><span class="line">    <span class="comment"># 发邮件</span></span><br><span class="line">    <span class="keyword">if</span> short_link &gt; result_not_found:</span><br><span class="line">        send_mail(short_link)</span><br><span class="line">    end_time = time.strftime(<span class="string">&#x27;%Y%m%d%H%M%S&#x27;</span>,time.localtime(time.time()))</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;开始时间：%s \n结束时间：%s&#x27;</span> % (begin_time,end_time))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行</span></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CocoaPods周边</title>
      <link href="/AboutCocoaPodsCMD.html"/>
      <url>/AboutCocoaPodsCMD.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="Ruby相关"><a href="#Ruby相关" class="headerlink" title="Ruby相关"></a>Ruby相关</h2><ol start="0"><li>下载安装Ruby <a href="https://www.ruby-lang.org/en/">https://www.ruby-lang.org/en/</a></li><li>升级Ruby环境 <code>$ sudo gem update</code></li><li>查看Ruby镜像 <code>$ gem sources -l</code></li><li>移除Ruby镜像 <code>$ gem sources --remove 镜像地址</code></li><li>添加Ruby镜像 <code>$ gem sources --add 镜像地址</code></li><li>查看Ruby安装的包 <code>$ gem list</code> 或 <code>$ /usr/bin/gem list</code> </li><li>移除Ruby安装的包 <code>$ sudo gem uninstall PACKAGENAME -v xx.xx.xx</code></li></ol><p>注：</p><ol><li>RubyGems 镜像参考<a href="https://gems.ruby-china.com/">https://gems.ruby-china.com</a></li><li>Ruby环境分 <code>system</code> 和 <code>local</code>，路径分别是 <code>/usr/bin/gem</code> 和 <code>/usr/local/bin/gem</code></li><li>系统自带没有权限时需要下载Ruby，<code>brew install ruby</code></li></ol><span id="more"></span><h2 id="CocoaPods相关"><a href="#CocoaPods相关" class="headerlink" title="CocoaPods相关"></a>CocoaPods相关</h2><ol start="0"><li><p>安装CocoaPods <code>$ sudo gem install cocoapods</code></p></li><li><p>卸载CocoaPods <code>$ sudo gem uninstall cocoapods</code></p></li><li><p>查询三方版本信息 <code>$ pod search 项目名</code></p></li><li><p>根据Podfile集成 <code>$ pod install</code></p></li><li><p>Podfile 模板</p> <figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">platform :ios, &#x27;<span class="number">8.0</span>&#x27;</span><br><span class="line">use_frameworks<span class="operator">!</span></span><br><span class="line"></span><br><span class="line">target &#x27;<span class="type">MyApp</span>&#x27; <span class="keyword">do</span></span><br><span class="line">  pod &#x27;<span class="type">AFNetworking</span>&#x27;, &#x27;<span class="operator">~&gt;</span> <span class="number">3.0</span>&#x27;</span><br><span class="line">end</span><br></pre></td></tr></table></figure></li><li><p>注册CocoaPods <code>$ pod trunk register 邮箱地址 &#39;用户名&#39; --verbose</code>,注册后需要邮件确认</p></li><li><p>查看CocoaPods信息 <code>$ pod trunk me</code></p></li><li><p>创建共享库 <code>$ pod lib create 库名</code></p></li><li><p>更新CocoaPods库（需要等待）</p><pre><code> $ sudo gem install cocoapods $ pod repo $ pod setup  </code></pre></li><li><p>查看本地库大小</p><pre><code> $ cd ~/.cocoapods/ $ du -sh * </code></pre></li><li><p>清理 Cocoapods</p><p> * </p></li></ol><p>注：参考 <a href="https://guides.cocoapods.org/">https://guides.cocoapods.org</a></p><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><h3 id="brew-install-xxx-提示”ERROR-No-formulae-found-in-taps-”"><a href="#brew-install-xxx-提示”ERROR-No-formulae-found-in-taps-”" class="headerlink" title="brew install xxx 提示”ERROR: No formulae found in taps.”"></a>brew install xxx 提示”ERROR: No formulae found in taps.”</h3><blockquote><p>解决方案【转载：<a href="https://blog.csdn.net/hypergeek/article/details/115735562">Homebrew执行命令时出错的解决方案</a>】</p></blockquote><p>1.删除taps：<code>rm -rf /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core</code><br>2.更新brew：<code>brew update</code></p><h3 id="升级-Mac-OS-导致-bash-pod-command-not-found"><a href="#升级-Mac-OS-导致-bash-pod-command-not-found" class="headerlink" title="升级 Mac OS 导致 -bash: pod: command not found"></a>升级 Mac OS 导致 <code>-bash: pod: command not found</code></h3><blockquote><p>解决方案【转载：<a href="http://www.jianshu.com/p/6ff1903c3f11">解决升级EI Capiton CocoaPods “pod: command not found”</a>】</p></blockquote><p>1.为了安全起见，执行命令”sudo gem uninstall cocoapods”，卸载原有的CocoaPod</p><p>2.执行命令”sudo gem install -n /usr/local/bin cocoapods”来重新安装cocoapod</p><p>3.如果没有权限执行pod，执行命令”sudo chmod +rx /usr/local/bin/“，赋予/usr/local/bin给予执行与读取权限</p><p>参考链接：<a href="https://github.com/CocoaPods/CocoaPods/issues/3736">https://github.com/CocoaPods/CocoaPods/issues/3736</a></p><h3 id="升级-MacOS-High-Sierra-导致-bad-interpreter-No-such-file-or-directory"><a href="#升级-MacOS-High-Sierra-导致-bad-interpreter-No-such-file-or-directory" class="headerlink" title="升级 MacOS High Sierra 导致 bad interpreter: No such file or directory"></a>升级 MacOS High Sierra 导致 <code>bad interpreter: No such file or directory</code></h3><pre><code>$ sudo gem update --system$ sudo gem install cocoapods -n/usr/local/bin</code></pre><p>参考链接：<a href="http://www.cocoachina.com/bbs/read.php?tid-1727144-page-e.html">http://www.cocoachina.com/bbs/read.php?tid-1727144-page-e.html</a></p>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>获取App Id 和 URL Schemes</title>
      <link href="/GetAppId.html"/>
      <url>/GetAppId.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>由于工作需要应用跳转到其它App，那么问题来，怎么知道目标应用的App Id 和 URL Schemes 呢 ？</p></blockquote><p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h1 id="App-Id"><a href="#App-Id" class="headerlink" title="App Id"></a>App Id</h1><ol><li><p>打开 <code>iTunes</code>，在 <strong>iTunes Store</strong> 中搜索目标应用；</p></li><li><p>在搜索结果中点击<code>v</code>按钮，选择<strong>复制链接</strong>；</p><pre><code> https://itunes.apple.com/cn/app/%E7%88%B1%E7%9C%8B%E5%84%BF%E7%AB%A5%E4%B9%90%E5%9B%AD/id480099078?mt=8</code></pre></li><li><p><code>.../id480099078?mt=8</code>中的 <code>480099078</code>就是目标应用的App Id.</p></li></ol><h1 id="URL-Schemes"><a href="#URL-Schemes" class="headerlink" title="URL Schemes"></a>URL Schemes</h1><h2 id="拿到ipa"><a href="#拿到ipa" class="headerlink" title="拿到ipa"></a>拿到ipa</h2><ul><li>通过 iTunes 下载应用</li><li>通过助手下载应用<ul><li>PP助手</li><li>爱思助手</li><li>91助手</li><li>等……</li></ul></li></ul><h2 id="查看-URL-Schemes"><a href="#查看-URL-Schemes" class="headerlink" title="查看 URL Schemes"></a>查看 URL Schemes</h2><blockquote><p>其思路是通过应用 <code>Info.plist</code> 中的 <code>URL types</code>设置，来分析该应用的 URL Schemes</p></blockquote><span id="more"></span><ol><li>解压ipa包(生成同名的文件夹)<ul><li>选中ipa包，右角打开方式选择<strong>归档实用工具</strong></li><li>将ipa包扩展名改为 <code>.zip</code>，然后双击</li></ul></li></ol><ol start="2"><li><p>显示包内容</p><p> 打开 <em>同名文件夹/Payload</em>，选中应用程序–&gt;右键–&gt;显示包内容</p></li><li><p>查看 URL Schemes</p><p> 打开文件夹中的 <em>Info.plist</em> 文件，搜索关键字 <code>schemes</code>，查看 <code>URL types</code> 各个 <code>item</code> 中的  <code>URL Schemes</code></p><ul><li>同应用名或相似</li><li>同 <strong>Bundle identifier</strong>或相似</li></ul></li></ol><h2 id="进一步分析"><a href="#进一步分析" class="headerlink" title="进一步分析"></a>进一步分析</h2><blockquote><p>有些在 Info.plist 中的不能直接看出来，进一步分析</p></blockquote><ul><li><code>Item</code>中没有<code>URL identifier</code>，有可能以 <code>wx</code>、<code>wb</code> 开头并加上字符、数字来假装成微信、微博之类，需要尝试</li><li>依次尝试 <code>URL Schemes</code></li></ul><p>注：prefs 是跳转到<strong>设置</strong></p><h2 id="束手无策"><a href="#束手无策" class="headerlink" title="束手无策"></a>束手无策</h2><p>Info.plist中没有 <code>URL types</code>，这是个问题，<a href="mailto:hertz@hertzwang.com">欢迎讨论</a></p>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>健身私教日记-小明第二节</title>
      <link href="/WorkoutLessonWXM02.html"/>
      <url>/WorkoutLessonWXM02.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p>2017年02月27日下午8点，本次主要练腿</p><p>时间之长，已记不太清具体，记录有过此事！</p><ol><li>躺着蹬腿</li><li>健身球下蹲</li><li>坐着夹腿</li><li>坐着双腿张开</li></ol>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>异地公积金贷款购二手房</title>
      <link href="/BuyAHouse.html"/>
      <url>/BuyAHouse.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>前言：羊毛出在羊身上，买房坑大水深！！！以下是我用异地公积金贷款买二手房的经历，有地区差异。</p></blockquote><h1 id="前期"><a href="#前期" class="headerlink" title="前期"></a>前期</h1><h2 id="找房源"><a href="#找房源" class="headerlink" title="找房源"></a>找房源</h2><p>自己在网上看，同时也委托同学（高中，地产中介上班）看</p><h2 id="看房"><a href="#看房" class="headerlink" title="看房"></a>看房</h2><blockquote><p>2017年3月份休了年假（周一到周五，加上两个周末共九天），周六收拾屋子，周日回的家，周二、三看了两天</p></blockquote><h3 id="第一天看房"><a href="#第一天看房" class="headerlink" title="第一天看房"></a>第一天看房</h3><p>第一天看了两套，第一套一眼就相中了，第二套交通不便就没在考虑，当前的问题是第一套超出预算4万，然后同学说他跟房东压价</p><span id="more"></span><h3 id="第二天看房"><a href="#第二天看房" class="headerlink" title="第二天看房"></a>第二天看房</h3><p>为了寻找更合适的房子，看了一套二手毛坯房，感觉也不错变交了<strong>意向金</strong>，说是该房源他们就不会带其他客户看了。</p><p>事与愿违，当晚同学联系我说有同事抢单，交了定金的话别人就抢不走了，当时也没多想就转帐过去了，过了一阵又打电话说房主要带着车库一起卖，我不能接受就把转过去的钱退了回来。</p><p>这个时候我对他们公司的制度产生了怀疑，没有当面戳穿！</p><h2 id="约谈"><a href="#约谈" class="headerlink" title="约谈"></a>约谈</h2><blockquote><p>2017.03.10 约谈，其实就是甲方（房主）、乙方（购房人）和丙方（中介）谈判，达成共识后就签<strong>合同</strong>！没错，签合同！！！是要交定金的！！！</p></blockquote><p>约的周五下午，在此之前还跟家里商量怎么跟房主谈，出门的时候还在想拿不拿钱包。</p><p>到了中介那儿才知道，约谈达成共识是要<strong>交定金、签合同、交中介费（合同没细看，要求签完合同当场交）</strong>的，如果违约还有<strong>违约费</strong>！！！</p><p>房产证（以后会叫不动产证）交给中介</p><p>总结：所谓的约谈、交定金，就是签合同、交定金和中介费，一旦签了合同就没回头路了，毁约的成本是<strong>定金+中介费+违约金</strong>。</p><h2 id="资质审核（准备）"><a href="#资质审核（准备）" class="headerlink" title="资质审核（准备）"></a>资质审核（准备）</h2><blockquote><p>准备材料然后面签（材料提交给银行审核，查看贷款额度，需工作日办理）</p></blockquote><h3 id="准备材料"><a href="#准备材料" class="headerlink" title="准备材料"></a>准备材料</h3><ol><li>贷款申请表（当地贷款申请表，3份，中介出）</li><li>身份证复印件一张</li><li>银行半年流水（工资卡）</li><li>户口本本人复印件一张</li><li>公积金缴存明细</li><li>异地公积金缴存证明</li><li>公积金第三方缴存证明（可选，如果是三方代缴）</li></ol><blockquote><p>更新于 2017年04月02日</p></blockquote><p>准备材料，异地需要准备好三块（公积金由公司缴）：</p><ol><li>贷款申请表上盖公章</li><li>异地公积金缴存证明</li><li>公积金缴存明细</li></ol><ul><li>注：正确流程是 落宗(老房主办理) –&gt; 查询 –&gt; 缴税 –&gt; 资金监管 –&gt; 面签（资质审核），到购房地后按照<em><strong>贷款经理</strong></em>要求办理相应的银行卡（资金监管和贷款用）</li></ul><h1 id="更名"><a href="#更名" class="headerlink" title="更名"></a>更名</h1><h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><blockquote><p> 2017.03.27</p></blockquote><p>房管局办理，需要排号，查询买家名下有几套房产</p><p>排队取号，这个相对快一些</p><h2 id="缴税"><a href="#缴税" class="headerlink" title="缴税"></a>缴税</h2><blockquote><p> 2017.03.27</p></blockquote><p>房管局办理，需要排号，买卖双方必需在，分三次缴纳（契税、印花税和个税），可刷信用卡</p><p>排队取号，这个就有些慢了，可能一天办不完</p><h2 id="资金监管"><a href="#资金监管" class="headerlink" title="资金监管"></a>资金监管</h2><blockquote><p>2017.03.28</p></blockquote><p>房管局先办理，需要排号，买卖双方必需在</p><p>完事儿后去银行开据办理监管</p><h2 id="面签（资质审核）"><a href="#面签（资质审核）" class="headerlink" title="面签（资质审核）"></a>面签（资质审核）</h2><blockquote><p>2017.03.29</p></blockquote><p>住房公积金管理中心：带着担保人去</p><p>这个阶段又叫<em><strong>资质审核</strong></em>，办理时间较长，完事儿后等结果</p><h2 id="申请贷款（签贷款合同）"><a href="#申请贷款（签贷款合同）" class="headerlink" title="申请贷款（签贷款合同）"></a>申请贷款（签贷款合同）</h2><blockquote><p>2017.04.13，更新于 2017年04月13日</p></blockquote><p><em><strong>资质审核</strong></em>通过，继续以下流程：</p><ol><li>带着<strong>担保人</strong>去<strong>住房公积金管理中心</strong>签<strong>贷款申请合同</strong>，共六份</li><li>带着其中三份合同去<strong>房管局</strong>开据一个<strong>证明</strong>（抵押1）</li><li>带着<strong>证明</strong>再回到<strong>住房公积金管理中心</strong>，交给工作人员</li></ol><p>等放款通知，继续办理</p><h2 id="放款"><a href="#放款" class="headerlink" title="放款"></a>放款</h2><blockquote><p>2017.04.27，更新于 2017年05月01日</p></blockquote><p>银行放款，自己在银行办理</p><h2 id="资金确认"><a href="#资金确认" class="headerlink" title="资金确认"></a>资金确认</h2><blockquote><p>2017.04.27</p></blockquote><p>在房管局办理，不用排号，主要是<strong>资金监管票</strong>和<strong>放款票</strong></p><p>注：<strong>票据丢失</strong>可以去银行处理，打印银行存联并加盖公章。</p><h2 id="交易确认"><a href="#交易确认" class="headerlink" title="交易确认"></a>交易确认</h2><blockquote><p>2017.04.27</p></blockquote><p>房管局办理，需要排号，最后得到一个《房屋交易（转让）确认单》，可加急！</p><h2 id="过户"><a href="#过户" class="headerlink" title="过户"></a>过户</h2><blockquote><p>2017.05.02，4月28日系统故障全天无办理</p></blockquote><p>房管局办理，需要排号（一号难求，早上4点排队），需要卖家在</p><p>过完户后去缴80块的房本费，然后去换票（可代办），等出本</p><p>注：正常10个工作日出，可加急至3、4天。</p><h2 id="领房本（不动产权证）"><a href="#领房本（不动产权证）" class="headerlink" title="领房本（不动产权证）"></a>领房本（不动产权证）</h2><blockquote><p>2017.05.08</p></blockquote><p>房管局办理，不用排号，上班前半小时到</p><h2 id="抵押2（公积金担保人最后一次）"><a href="#抵押2（公积金担保人最后一次）" class="headerlink" title="抵押2（公积金担保人最后一次）"></a>抵押2（公积金担保人最后一次）</h2><blockquote><p>2017.05.09，更新于 2017年05月09日</p></blockquote><p>房管局办理，需要排号，需要担保人带着材料（身份证和户口本），办完后等3个工作日领取《房屋交易（抵押）确认单》，可加急！</p><h2 id="抵押3（他项权证）"><a href="#抵押3（他项权证）" class="headerlink" title="抵押3（他项权证）"></a>抵押3（他项权证）</h2><blockquote><p>2017.05.09</p></blockquote><p>房管局办理，综合窗口</p><ol><li>排号：需要《房屋交易（抵押）确认单》、房本和身份证</li><li>办理：办理完成后<strong>房本会被收回</strong>，并给《不动产登记回执》和《收费明细单》</li><li>缴费：拿着《收费明细单》缴费（￥80）</li><li>换票：拿着《收费明细单》和《不动产登记回执》去换税票（收费明细单会被收回）</li></ol><p>然后就是10个工作日的等待，至少10个工作日，可加急！</p><h2 id="领取他项权证"><a href="#领取他项权证" class="headerlink" title="领取他项权证"></a>领取他项权证</h2><blockquote><p>2017.05.15，更新于 2017年05月27日（15日就已办完）</p></blockquote><p>房管局办理</p><p>窗口排队，需要银行的担保人（建行贷的款，为建行工作人员）</p><p>领取后得到房本和他项权证</p><ul><li>注：他项权证是要抵押到银行的，以前是房本，这样一来房本就能在房主手里了。</li></ul><h2 id="划款"><a href="#划款" class="headerlink" title="划款"></a>划款</h2><blockquote><p>2017.05.15</p></blockquote><p>房管局办理</p><p>买卖双方在并出示身份证，办理完事儿后会拿到<strong>《放款单》</strong>（好像是这么叫的）</p><h2 id="抵押4（抵押他项权证至银行）"><a href="#抵押4（抵押他项权证至银行）" class="headerlink" title="抵押4（抵押他项权证至银行）"></a>抵押4（抵押他项权证至银行）</h2><blockquote><p>2017.05.15</p></blockquote><p>房管局办理</p><p>买卖双方在并出示身份证</p><p>材料复印：</p><ul><li>他项权证复印两份</li><li>不动产证一、二、三页各一份</li></ul><p>办理完事儿后手里会一张签章的他项权证，这个需要保管好！！！</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>办完抵押（四）房屋交易流程就办完了，下面就是房屋交接。</p><p>自2017年03月10日交定金至2017年05月15日抵押他项权证至银行，历时两个月多，来回数次。</p><p>时间轴：</p><table><thead><tr><th>日期</th><th>办理事项</th></tr></thead><tbody><tr><td>2017.03.10之前</td><td>观望、看房</td></tr><tr><td>2017.03.10</td><td>与房主约谈、交定金、签三方合同（中介）</td></tr><tr><td>2017.03.27</td><td>查询、缴税</td></tr><tr><td>2017.03.28</td><td>资金监管</td></tr><tr><td>2017.03.29</td><td>面签（资质审核）</td></tr><tr><td>2017.04.13</td><td>申请贷款（签贷款合同）</td></tr><tr><td>2017.04.27</td><td>放款、资金确认、交易确认</td></tr><tr><td>2017.05.02</td><td>过户</td></tr><tr><td>2017.05.08</td><td>领房本（不动产权证）</td></tr><tr><td>2017.05.09</td><td>抵押2（公积金担保人最后一次）、抵押3（他项权证）</td></tr><tr><td>2017.05.15</td><td>领取他项权证、划款、抵押4（抵押他项权证至银行）</td></tr></tbody></table><p><img src="./images/BuyAHouse-process.png" alt="流程附图" title="流程附图"></p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Print </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>健身私教日记-小明第一节</title>
      <link href="/WorkoutLessonWXM01.html"/>
      <url>/WorkoutLessonWXM01.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p>2017年02月24日下午7点，本次课程共3个动作</p><h2 id="动作一"><a href="#动作一" class="headerlink" title="动作一"></a>动作一</h2><h3 id="夹臂哑玲——肱二头肌"><a href="#夹臂哑玲——肱二头肌" class="headerlink" title="夹臂哑玲——肱二头肌"></a>夹臂哑玲——肱二头肌</h3><p>预备：双手持哑玲、掌心朝前，双脚分开同肩宽，上身挺直微前倾，双臂伸直微弯曲，大臂微夹，目视前方</p><p>动作：以手肘为轴心，大臂不动手臂弯曲到极点，慢慢恢复，上呼下吸</p><p>强度：2.5kg 20个 -&gt; 5kg 15个 -&gt; 7.5kg 7个 -&gt;  10kg 4个，两个循环</p><span id="more"></span><h2 id="动作二"><a href="#动作二" class="headerlink" title="动作二"></a>动作二</h2><h3 id="杠铃——肱二头肌"><a href="#杠铃——肱二头肌" class="headerlink" title="杠铃——肱二头肌"></a>杠铃——肱二头肌</h3><p>预备：杠铃放在脚前，双臂自然下垂，下蹲握杠铃、掌心朝前并站起，双脚分开同肩宽，上身挺直微前倾，双臂伸直微弯曲，大臂微夹，目视前方</p><p>动作：</p><ul><li><p>第一阶段：以手肘为轴心，大臂不动，手臂弯曲至小臂平行地面，慢慢恢复，上呼下吸</p></li><li><p>第二阶段：小臂与地面平行，手臂弯曲到极限，慢慢恢复至小臂平行地面，上呼下吸</p></li><li><p>第三阶段：手臂自然下垂，弯曲到极限，慢慢打开手臂至微弯曲，上呼下吸</p></li></ul><p>强度：每个阶段次数一样，第一个循环3个、第二个循环4个、第三个循环废了</p><p>*注：保持杠杆与地面平行，发现偏移后应立即自我矫正。起不来时可保持僵持。</p><h2 id="动作三"><a href="#动作三" class="headerlink" title="动作三"></a>动作三</h2><p>###平行下拉 ——肱三头肌</p><p>预备：双腿分开与肩宽、微弯曲，上身挺直、微前倾，拉起器械、掌心朝下、夹大臂、小臂与地面平行</p><p>动作：以手肘为轴心，大臂不动手臂伸至微弯曲，慢慢恢复，拉呼松吸</p><p>强度：15kg 20个，20kg 15个，25kg 8个</p><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><h3 id="新式仰卧起坐组合——腹（健身私教日记-小明预热动作六）"><a href="#新式仰卧起坐组合——腹（健身私教日记-小明预热动作六）" class="headerlink" title="新式仰卧起坐组合——腹（健身私教日记-小明预热动作六）"></a>新式仰卧起坐组合——腹（健身私教日记-小明预热动作六）</h3><h3 id="跑步机"><a href="#跑步机" class="headerlink" title="跑步机"></a>跑步机</h3><ul><li>热身：时速4km、时长2min</li><li>跑步：时速11km、时长1min</li><li>慢走：坡度12、时速4km、时长5min</li><li>慢跑：时速10km、时长5min</li><li>快走：时速6km、时长10min</li></ul>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>健身私教日记-小明预热</title>
      <link href="/WorkoutLessonWXM00.html"/>
      <url>/WorkoutLessonWXM00.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p>前言：换了私教…依然教练各有各的教学方法，第一次这么晚上课</p><p>2017年02月21日下午8点，本次课程共6个动作</p><h2 id="动作一"><a href="#动作一" class="headerlink" title="动作一"></a>动作一</h2><h3 id="坐着腿双曲上抬——练腿（股四头肌，膝盖上边）"><a href="#坐着腿双曲上抬——练腿（股四头肌，膝盖上边）" class="headerlink" title="坐着腿双曲上抬——练腿（股四头肌，膝盖上边）"></a>坐着腿双曲上抬——练腿（股四头肌，膝盖上边）</h3><p>预备：坐在机械上，膝盖间距与肩同宽、小腿自然下垂，上身向后依靠、下呗镂空，双臂自然下垂</p><p>动作：保持上身不变，腿部法力使其尽可能伸直，伸直后保持2秒再慢慢收回，申呼收吸，动作要慢</p><p>强度：15kg，20个 x 3次</p><p>*注： 座椅前后距离可调节，距离越大发力点越靠上，注意适量！</p><span id="more"></span><h2 id="动作二"><a href="#动作二" class="headerlink" title="动作二"></a>动作二</h2><h3 id="腿弯曲相夹——练腿"><a href="#腿弯曲相夹——练腿" class="headerlink" title="腿弯曲相夹——练腿"></a>腿弯曲相夹——练腿</h3><p>预备：坐在机械上，脚跟放在器械踩踏中间，身体前倾</p><p>动作：上身保持不变，双腿相夹，夹呼展吸，动作要慢</p><p>强度：15kg，20个 x 3次</p><p>*注：前倾是为了增加训练部位</p><h2 id="动作三"><a href="#动作三" class="headerlink" title="动作三"></a>动作三</h2><h3 id="腿弯曲展开——练腿"><a href="#腿弯曲展开——练腿" class="headerlink" title="腿弯曲展开——练腿"></a>腿弯曲展开——练腿</h3><p>预备：坐在机械上，脚跟放在器械踩踏中间，身体前倾</p><p>动作：上身保持不变，双腿左右展开，展呼合吸，动作要慢</p><p>强度：15kg，20个 x 3次</p><p>*注：前倾是为了增加训练部位</p><h2 id="动作四"><a href="#动作四" class="headerlink" title="动作四"></a>动作四</h2><h3 id="趴着双腿回收——练腿"><a href="#趴着双腿回收——练腿" class="headerlink" title="趴着双腿回收——练腿"></a>趴着双腿回收——练腿</h3><p>预备：趴在器械上，目视前方，双腿打开至膝盖分开同肩同宽</p><p>动作：只用腿部力量弯举，弯举时呼气、恢复时吸气，动作要慢</p><p>强度：15kg，20个</p><h2 id="动作五"><a href="#动作五" class="headerlink" title="动作五"></a>动作五</h2><h3 id="健身球半蹲——练腿"><a href="#健身球半蹲——练腿" class="headerlink" title="健身球半蹲——练腿"></a>健身球半蹲——练腿</h3><p>预备：拿一健身球放在背部（偏下）靠在墙上，双脚打开同肩宽，双腿微弯曲使眼、膝盖、脚尖在一条直线</p><p>动作：缓慢向下蹲至大腿与地面平行，保持1秒后恢复，下呼上吸</p><p>强度：15个 x 3</p><p>*注：也可加大强度，做到最后一个时保持蹲姿</p><h2 id="动作六"><a href="#动作六" class="headerlink" title="动作六"></a>动作六</h2><h3 id="新式仰卧起坐组合——腹"><a href="#新式仰卧起坐组合——腹" class="headerlink" title="新式仰卧起坐组合——腹"></a>新式仰卧起坐组合——腹</h3><p>预备：</p><ul><li><p>上身：趟在垫子上，双腿弯曲，双手交叉放在胸前</p></li><li><p>下身：双腿微分开抬起，大腿垂直地面、小腿平行地面，左腿向前伸直，脚尖高度不超过右腿脚尖，右腿向头部方向抬</p></li></ul><p>动作：</p><ul><li><p>上身：上身缓慢向上起约30度，使用腹式呼吸，起来时将气吐完，呼吸保持均速</p></li><li><p>下身：双腿缓慢交替，保持均速呼吸</p></li></ul><p>强度：上身20个x3，下身25个x3</p>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2017年02月份健身日志</title>
      <link href="/Workout201702.html"/>
      <url>/Workout201702.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p><strong>2017-02-27 周一</strong></p><ul><li><a href="https://hertzwang.github.io/WorkoutLessonWXM02.html">健身私教日记-小明第二节</a></li></ul><p><strong>2017-02-24 周五</strong></p><ul><li><a href="https://hertzwang.github.io/WorkoutLessonWXM01.html">健身私教日记-小明第一节</a></li></ul><p><strong>2017-02-21 周二</strong></p><ul><li><a href="https://hertzwang.github.io/WorkoutLessonWXM00.html">健身私教日记-小明预热</a></li></ul><p><strong>2017-02-19 周日</strong></p><ul><li>跑步机<ul><li>快走：时速6km、时长60min</li></ul></li></ul><span id="more"></span><p><strong>2017-02-16 周四</strong></p><ul><li><p>下拉练背（私教体验课）：</p><ul><li>20kg 四组 </li></ul></li><li><p>跑步机</p><ul><li>跑步：时速9km、时长10min + 13min</li><li>快走：时速6km、时长5min</li><li>倒走：时速2km、时长5min</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutLog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据库设计文档模板</title>
      <link href="/DataBaseDesignTemplate.html"/>
      <url>/DataBaseDesignTemplate.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="表"><a href="#表" class="headerlink" title="表"></a>表</h2><h3 id="中文表名1（English-Name）"><a href="#中文表名1（English-Name）" class="headerlink" title="中文表名1（English Name）"></a>中文表名1（English Name）</h3><table><thead><tr><th>字段名</th><th>数据类型</th><th>数据长度</th><th>说明</th><th>允许空</th><th>备注</th></tr></thead><tbody><tr><td>column_name</td><td>Int</td><td>11</td><td>列名</td><td>N</td><td></td></tr><tr><td>column_name</td><td>Int</td><td>11</td><td>列名</td><td>N</td><td></td></tr><tr><td>column_name</td><td>Int</td><td>11</td><td>列名</td><td>N</td><td></td></tr></tbody></table><span id="more"></span><h3 id="中文表名2（English-Name）"><a href="#中文表名2（English-Name）" class="headerlink" title="中文表名2（English Name）"></a>中文表名2（English Name）</h3><table><thead><tr><th>字段名</th><th>数据类型</th><th>数据长度</th><th>说明</th><th>允许空</th><th>备注</th></tr></thead><tbody><tr><td>column_name</td><td>Int</td><td>11</td><td>列名</td><td>N</td><td></td></tr><tr><td>column_name</td><td>Int</td><td>11</td><td>列名</td><td>N</td><td></td></tr><tr><td>column_name</td><td>Int</td><td>11</td><td>列名</td><td>N</td><td></td></tr></tbody></table><h2 id="实体关系"><a href="#实体关系" class="headerlink" title="实体关系"></a>实体关系</h2><p>ER图显示</p>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Print </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>API文档模板</title>
      <link href="/APITemplate.html"/>
      <url>/APITemplate.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><h2 id="统一请求头参数"><a href="#统一请求头参数" class="headerlink" title="统一请求头参数"></a>统一请求头参数</h2><table><thead><tr><th>参数名称</th><th>参数说明</th></tr></thead><tbody><tr><td>sessionId</td><td>请求后必选参数，回话id</td></tr><tr><td>account</td><td>登录后必选参数，用户注册成功后生成的账号</td></tr><tr><td>deviceId</td><td>必选参数，设备号</td></tr><tr><td>appVersion</td><td>必选参数，应用版本号</td></tr><tr><td>apiVersion</td><td>请求后必选参数，接口版本号</td></tr></tbody></table><span id="more"></span><h2 id="业务模块一"><a href="#业务模块一" class="headerlink" title="业务模块一"></a>业务模块一</h2><h3 id="业务1"><a href="#业务1" class="headerlink" title="业务1"></a>业务1</h3><h4 id="请求方式"><a href="#请求方式" class="headerlink" title="请求方式"></a>请求方式</h4><blockquote><p>POST</p></blockquote><h4 id="请求路径"><a href="#请求路径" class="headerlink" title="请求路径"></a>请求路径</h4><blockquote><p>api/project/function</p></blockquote><h4 id="请求参数"><a href="#请求参数" class="headerlink" title="请求参数"></a>请求参数</h4><blockquote></blockquote><table><thead><tr><th>请求参数</th><th>参数说明</th></tr></thead><tbody><tr><td>arg1</td><td>必选参数，参数1说明</td></tr><tr><td>arg2</td><td>可选参数，参数2说明</td></tr></tbody></table><h4 id="返回参数"><a href="#返回参数" class="headerlink" title="返回参数"></a>返回参数</h4><blockquote></blockquote><table><thead><tr><th>返回参数</th><th>参数说明</th></tr></thead><tbody><tr><td>success</td><td>请求成功标记</td></tr><tr><td>code</td><td>执行结果code</td></tr><tr><td>message</td><td>执行结果消息</td></tr><tr><td>results</td><td>数据集合</td></tr></tbody></table><h4 id="返回示例"><a href="#返回示例" class="headerlink" title="返回示例"></a>返回示例</h4><blockquote></blockquote><pre><code>&#123;    &quot;success&quot;: true,    &quot;code&quot;: 200,    &quot;message&quot;: &quot;创建成功&quot;,    &quot;results&quot;: [        &quot;xx&quot;: &quot;xxx&quot;,        &quot;yy&quot;: &#123;            &quot;zz&quot;: &quot;zz&quot;        &#125;    ]&#125;</code></pre><h3 id="业务2"><a href="#业务2" class="headerlink" title="业务2"></a>业务2</h3><p>……</p><h2 id="错误代码（Link）"><a href="#错误代码（Link）" class="headerlink" title="错误代码（Link）"></a>错误代码（<a href="https://tools.ietf.org/html/rfc7231#section-6.2.1">Link</a>）</h2><pre><code>   +------+-------------------------------+--------------------------+   | Code | Reason-Phrase                 | Defined in...            |   +------+-------------------------------+--------------------------+   | 100  | Continue                      | Section 6.2.1            |   | 101  | Switching Protocols           | Section 6.2.2            |   | 200  | OK                            | Section 6.3.1            |   | 201  | Created                       | Section 6.3.2            |   | 202  | Accepted                      | Section 6.3.3            |   | 203  | Non-Authoritative Information | Section 6.3.4            |   | 204  | No Content                    | Section 6.3.5            |   | 205  | Reset Content                 | Section 6.3.6            |   | 206  | Partial Content               | Section 4.1 of [RFC7233] |   | 300  | Multiple Choices              | Section 6.4.1            |   | 301  | Moved Permanently             | Section 6.4.2            |   | 302  | Found                         | Section 6.4.3            |   | 303  | See Other                     | Section 6.4.4            |   | 304  | Not Modified                  | Section 4.1 of [RFC7232] |   | 305  | Use Proxy                     | Section 6.4.5            |   | 307  | Temporary Redirect            | Section 6.4.7            |   | 400  | Bad Request                   | Section 6.5.1            |   | 401  | Unauthorized                  | Section 3.1 of [RFC7235] |   | 402  | Payment Required              | Section 6.5.2            |   | 403  | Forbidden                     | Section 6.5.3            |   | 404  | Not Found                     | Section 6.5.4            |   | 405  | Method Not Allowed            | Section 6.5.5            |   | 406  | Not Acceptable                | Section 6.5.6            |   | 407  | Proxy Authentication Required | Section 3.2 of [RFC7235] |   | 408  | Request Timeout               | Section 6.5.7            |   | 409  | Conflict                      | Section 6.5.8            |   | 410  | Gone                          | Section 6.5.9            |   | 411  | Length Required               | Section 6.5.10           |   | 412  | Precondition Failed           | Section 4.2 of [RFC7232] |   | 413  | Payload Too Large             | Section 6.5.11           |   | 414  | URI Too Long                  | Section 6.5.12           |   | 415  | Unsupported Media Type        | Section 6.5.13           |   | 416  | Range Not Satisfiable         | Section 4.4 of [RFC7233] |   | 417  | Expectation Failed            | Section 6.5.14           |   | 426  | Upgrade Required              | Section 6.5.15           |   | 500  | Internal Server Error         | Section 6.6.1            |   | 501  | Not Implemented               | Section 6.6.2            |   | 502  | Bad Gateway                   | Section 6.6.3            |   | 503  | Service Unavailable           | Section 6.6.4            |   | 504  | Gateway Timeout               | Section 6.6.5            |   | 505  | HTTP Version Not Supported    | Section 6.6.6            |   +------+-------------------------------+--------------------------+</code></pre>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Print </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>健身私教日记-第四节</title>
      <link href="/WorkoutLesson04.html"/>
      <url>/WorkoutLesson04.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p>前言：之前的教练离职了，可惜了…教练各有各的教学方法</p><p>2017年01月03日下午七点多，本次课程共4个动作</p><h2 id="动作一"><a href="#动作一" class="headerlink" title="动作一"></a>动作一</h2><h3 id="半蹲——练腿"><a href="#半蹲——练腿" class="headerlink" title="半蹲——练腿"></a>半蹲——练腿</h3><p>预备：双腿分开比肩宽10cm、脚尖朝内，双手向前伸直抬与肩高，挺胸、臀部身后</p><p>动作：躺下蹲，膝盖与脚尖在一条线上，从侧面看背部有弧度，慢慢恢复，下呼上吸</p><p>强度：20个一组，一次4组，间歇1分钟</p><h2 id="动作二"><a href="#动作二" class="headerlink" title="动作二"></a>动作二</h2><h3 id="原地箭步蹲——练腿"><a href="#原地箭步蹲——练腿" class="headerlink" title="原地箭步蹲——练腿"></a>原地箭步蹲——练腿</h3><p>预备：一条腿向前迈开约50cm，前腿弯曲90度、膝盖不超过脚尖，后退向后撤最大距离并脚掌着地，上身挺直，双臂自然下垂</p><p>动作：后腿弯曲向下蹲，前腿膝盖不超过脚尖、后腿膝盖不碰与地面，慢慢恢复，下呼上吸</p><p>强度：20个一组，一次4组，间歇1分钟</p><span id="more"></span><h2 id="动作三"><a href="#动作三" class="headerlink" title="动作三"></a>动作三</h2><h3 id="半个波比跳（不做俯卧撑）"><a href="#半个波比跳（不做俯卧撑）" class="headerlink" title="半个波比跳（不做俯卧撑）"></a>半个波比跳（不做俯卧撑）</h3><p>预备：正常站立</p><p>动作：双手扶地做支撑，下肢跳起向后，落地后再跳起复原，站起来跳跃并双手向上击掌，周而复始</p><p>强度：20个一组，一次4组，间歇1分钟</p><h2 id="动作四"><a href="#动作四" class="headerlink" title="动作四"></a>动作四</h2><h3 id="平躺推杠铃——胸"><a href="#平躺推杠铃——胸" class="headerlink" title="平躺推杠铃——胸"></a>平躺推杠铃——胸</h3><p>预备：平躺、全脚掌着地，挺胸、背部镂空，中指对准裂缝（杠铃上），手垫撑着杠铃，双臂打开约45度</p><p>动作：匀速将杠铃撑起，缓慢下落至胸前（中枢），杠铃运动轨迹与地面垂直，上呼下吸</p><p>强度：12个一组，一次4组，间歇1分钟</p><h2 id="外加大黄蜂（大）——练胸（私教第三节动作二）两边各加重10kg"><a href="#外加大黄蜂（大）——练胸（私教第三节动作二）两边各加重10kg" class="headerlink" title="外加大黄蜂（大）——练胸（私教第三节动作二）两边各加重10kg"></a>外加大黄蜂（大）——练胸（私教第三节动作二）两边各加重10kg</h2><h2 id="坐直手臂夹胸（私教第一节动作二）"><a href="#坐直手臂夹胸（私教第一节动作二）" class="headerlink" title="坐直手臂夹胸（私教第一节动作二）"></a>坐直手臂夹胸（私教第一节动作二）</h2>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2017年01月份健身日志</title>
      <link href="/Workout201701.html"/>
      <url>/Workout201701.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p><strong>2017-01-16 周一</strong></p><ul><li>仰卧起坐4组（上下各50次）</li></ul><p><strong>2017-01-14 周六</strong></p><ul><li>仰卧起坐2组（上下各50次）</li></ul><p><strong>2017-01-09 周一</strong></p><ul><li><p>划船机练背（私教体验课）：</p><ul><li>20kg 四组</li></ul></li><li><p>下拉练背（私教体验课）：</p><ul><li>20kg 四组 </li></ul></li><li><p>跑步机</p><ul><li>慢跑：时速9km、时长10min</li><li>快走：时速6km、时长11min</li></ul></li></ul><span id="more"></span><p><strong>2017-01-06 周五</strong></p><ul><li><a href="https://hertzwang.github.io/WorkoutLesson04.html">健身私教日记-第四节</a></li></ul><p><strong>2017-01-03 周二</strong></p><ul><li><p>跑步机</p><ul><li>快走：时速6km、时长20min</li><li>慢跑：时速8km、时长12min</li><li>跑步：时速9km、时长10min</li><li>跑步：时速10km、时长5min</li><li>倒走：时速2km、时长5min</li></ul></li><li><p>练下背（私教第三节）</p><ul><li>加重10kg 四组 </li></ul></li><li><p>划船机练背（私教体验课）：</p><ul><li>25kg 两组</li></ul></li><li><p>下拉练背（私教体验课）：</p><ul><li>25kg 一组 </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutLog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>健身私教日记-第三节</title>
      <link href="/WorkoutLesson03.html"/>
      <url>/WorkoutLesson03.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p>2016年12月25日下午四点，本次课程共6个动作</p><h2 id="动作一"><a href="#动作一" class="headerlink" title="动作一"></a>动作一</h2><h3 id="练下背"><a href="#练下背" class="headerlink" title="练下背"></a>练下背</h3><p>器材：上边有挡板、下边脚可以踩</p><p>运动前拉伸：双手扶器材，胳膊伸直与身体成直线，身体放松、翘臀，感觉背部得到拉伸保持10秒，身体左倾拉伸10秒、右倾拉伸10秒</p><p>预备：站上器材向前趴，挡板顶在腹部（可调解），挺胸、收腹、夹肩、背部挺直，双手交叉贴在胸前</p><p>动作：以腰为轴心向下趴，然后复原（上身与地面平行偏上一点），下呼上吸</p><p>强度：15个一组，一次4组，间歇1分钟并拉伸一次</p><span id="more"></span><h2 id="动作二"><a href="#动作二" class="headerlink" title="动作二"></a>动作二</h2><h3 id="大黄蜂（大）——练胸"><a href="#大黄蜂（大）——练胸" class="headerlink" title="大黄蜂（大）——练胸"></a>大黄蜂（大）——练胸</h3><p>预备：调整好座椅高度，坐直、挺胸，握好、肘略低于肩</p><p>动作：向前推，推呼收吸</p><p>强度：15个一组，一次4组，间歇1分钟</p><h2 id="动作三"><a href="#动作三" class="headerlink" title="动作三"></a>动作三</h2><h3 id="Seated-Straight-Arm-Clip-Chest-坐直单手臂夹胸"><a href="#Seated-Straight-Arm-Clip-Chest-坐直单手臂夹胸" class="headerlink" title="Seated Straight Arm Clip Chest 坐直单手臂夹胸"></a>Seated Straight Arm Clip Chest 坐直单手臂夹胸</h3><p>器材：Seated Straight Arm Clip Chest</p><p>预备：调整好座椅高度，斜坐45度、挺胸，握好、肘略低于肩，手、小臂、大臂和胸在一条直线上</p><p>动作：胳膊保持、胸部发力向前，向前推然后慢慢还原，拉呼放吸</p><p>强度：15个一组，一次4组，间歇1分钟</p><h2 id="动作四"><a href="#动作四" class="headerlink" title="动作四"></a>动作四</h2><p>器材：</p><p>预备：打开双臂拉起、弓步，挺胸、收腹、目视前方</p><p>动作：胳膊保持、胸部发力向前至双手碰到，慢慢还原，拉呼松吸</p><p>强度：15个一组，一次4组，间歇1分钟</p><h2 id="动作五"><a href="#动作五" class="headerlink" title="动作五"></a>动作五</h2><h3 id="哑铃——肱二头肌，夹臂过肩"><a href="#哑铃——肱二头肌，夹臂过肩" class="headerlink" title="哑铃——肱二头肌，夹臂过肩"></a>哑铃——肱二头肌，夹臂过肩</h3><p>预备：手握哑铃站立，掌心朝内，抬头、挺胸、收腹、身体微前倾、大臂夹紧，腿微弯曲、手臂放松</p><p>动作：一边以胳膊肘为轴手向上抬起过肩，同时转腕之掌心朝后，慢慢复原然后换另一边，上呼下吸</p><p>强度：8~12个一组，一次4组，间歇1分钟</p><h2 id="动作六"><a href="#动作六" class="headerlink" title="动作六"></a>动作六</h2><h3 id="哑铃——肱二头肌"><a href="#哑铃——肱二头肌" class="headerlink" title="哑铃——肱二头肌"></a>哑铃——肱二头肌</h3><p>预备：手握哑铃坐着，大臂贴于大腿、掌心朝外</p><p>动作：一边以胳膊肘为轴手向上抬起高于水平面，慢慢复原，做完一组后换另一边，上呼下吸</p><p>强度：8~12个一组，一次4组，间歇1分钟</p><p>注：本次练到废</p><h2 id="外加大黄蜂（小）——练胸-（私教第一节动作三）两边各加重10kg"><a href="#外加大黄蜂（小）——练胸-（私教第一节动作三）两边各加重10kg" class="headerlink" title="外加大黄蜂（小）——练胸 （私教第一节动作三）两边各加重10kg"></a>外加大黄蜂（小）——练胸 （私教第一节动作三）两边各加重10kg</h2>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac平台搭建PHP API开发环境</title>
      <link href="/PHPAPIDevForMac.html"/>
      <url>/PHPAPIDevForMac.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p>前言：本文主要介绍在Mac平台搭建一个PHP API开发环境</p><h3 id="环境及工具"><a href="#环境及工具" class="headerlink" title="环境及工具"></a>环境及工具</h3><ul><li><p>操作系统：Mac OS 10.11.6</p></li><li><p>集成开发环境：PhpStorm <a href="https://www.jetbrains.com/phpstorm/download/">下载</a></p></li><li><p>数据库：MySQL Community Server 8.0.0 dmr <a href="http://dev.mysql.com/downloads/mysql/">下载</a></p></li><li><p>数据库建模工具：MySQL Workbench <a href="http://dev.mysql.com/downloads/workbench/">下载</a></p></li><li><p>PHP框架：CodeIgniter <a href="http://www.codeigniter.com/">下载</a></p></li><li><p>PHP 5.5.38：系统自带的PHP版本</p><p>  在<strong>终端</strong>执行 <code>php -v</code> 查看PHP版本</p><pre><code>  bogon:~ hertzwang$ php -v  PHP 5.5.38 (cli) (built: Aug 21 2016 21:48:49)   Copyright (c) 1997-2015 The PHP Group  Zend Engine v2.5.0, Copyright (c) 1998-2015 Zend Technologies</code></pre></li></ul><span id="more"></span><h3 id="PhpStorm-配置"><a href="#PhpStorm-配置" class="headerlink" title="PhpStorm 配置"></a>PhpStorm 配置</h3><p>安装并运行<strong>PhpStorm</strong></p><h4 id="新建项目（FirstDemo）"><a href="#新建项目（FirstDemo）" class="headerlink" title="新建项目（FirstDemo）"></a>新建项目（FirstDemo）</h4><ol><li><p>欢迎界面点击 <strong>Create New Project</strong> 进入 <em>New Project</em> 界面；</p></li><li><p>选择 <strong>PHP Empty Project</strong></p><ul><li>Location：工程目录，<em>untitled</em> 表示工程名称（可修改），以 <em>FirstDemo</em> 为例</li><li>Development environment<ul><li>PHP language level：选择PHP的版本，我这里使用的是系统自带的，故选择 <em>5.6</em> </li><li>CLI Interpreter：选择解释器，这个在下面设置</li><li>其它略</li></ul></li></ul></li><li><p>点击右下角的 <strong>Create</strong> 创建项目；</p></li><li><p>点击 <em>工具栏</em> 的 **File –&gt; New… –&gt; PHP File–&gt;*<em>，</em>File Name* 输入 <em>Test</em> 并点击 <strong>OK</strong>；</p></li><li><p>编辑 <strong>Test.php</strong>，添加以下代码：</p><pre><code> $output = array(&#39;message&#39; =&gt; &quot;Request Success&quot;); exit(json_encode($output));</code></pre></li></ol><h4 id="配置运行环境"><a href="#配置运行环境" class="headerlink" title="配置运行环境"></a>配置运行环境</h4><ol><li><p>打开 <strong>Configurations</strong> ，点击 <em>工具栏</em> 的 **Run –&gt; Edit Configurations…**；</p></li><li><p>新建 <strong>PHP Built-in Web Server</strong> ，点击左上角 <code>+</code> 并选择 <strong>PHP Built-in Web Server</strong>；</p></li><li><p>详细设置</p><p> <img src="./images/PHPAPIDevForMac-Run-Debug-cfg.png" alt="Run/Debug Configurations" title="Run/Debug Configurations"></p><ul><li>Name：服务名称，输入 <code>PHP Built-in Web Server</code> 或其它</li><li>Server Configuration<ul><li>Host：主机（访问地址），输入 <code>localhost</code> 或其它</li><li>Port：端口号，根据个人情况输入（端口号可能被占用）</li><li>Document root：PHP文档目录，选择 <em>工程目录</em></li></ul></li></ul></li><li><p>添加 <em>CLI Interpreters</em> Fix Error</p><blockquote><p>点击右下角的 <strong>Fix</strong> ，然后再点击新窗口中 <strong>CLI Interpreter</strong> 后面的 <code>...</code> 按钮</p></blockquote><blockquote><p>点击左上角的 <code>+</code>，选择 <code>/usr/bin/php</code> ，点击右下角 <strong>OK</strong></p></blockquote></li><li><p>确认设置，点击右下解 <strong>OK</strong></p></li></ol><h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><ol><li><p>运行：点击 <em>工具栏</em> 的 <strong>Run –&gt; Run…</strong> ，选择 <em>PHP Built-in Web Server</em>  注：由于端口被占用启动失败，故端口改为 <code>8080</code></p></li><li><p>打开浏览器输入 <code>http://localhost:8080/test.php</code></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2016年12月份健身日志</title>
      <link href="/Workout201612.html"/>
      <url>/Workout201612.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p><strong>2016-12-27 周二</strong></p><ul><li>跑步机<ul><li>快走：时速6km、时长10min</li><li>慢跑：时速8km、时长12min</li><li>倒走：时速2km、时长5min</li><li>跑步：时速9km、时长5min</li></ul></li><li>练下背（私教第三节）<ul><li>加重10kg 两组 </li></ul></li></ul><p><strong>2016-12-25 周日</strong></p><ul><li><a href="https://hertzwang.github.io/WorkoutLesson03.html">健身私教日记-第三节</a></li></ul><span id="more"></span><p><strong>2016-12-24 周六</strong></p><ul><li><p>跑步机 时速9km、时长10min</p></li><li><p>坐直手臂夹胸（私教第一节）：</p><ul><li>20kg 四组</li></ul></li><li><p>下拉练背（私教体验课）：</p><ul><li>20kg 四组 </li></ul></li><li><p>划船机练背（私教体验课）：</p><ul><li>20kg 四组</li></ul></li></ul><p><strong>2016-12-23 周五</strong></p><ul><li><p>跑步机</p><ul><li>快走：时速6km、时长5min + 5min</li><li>慢跑：时速8km、时长15min</li><li>跑步：时速10km、时长3min（岔气啦…）    </li><li>倒走：时速2km、时长5min </li></ul></li><li><p>坐直手臂夹胸（私教第一节）：</p><ul><li>15kg 四组</li></ul></li><li><p>下拉练背（私教体验课）：</p><ul><li>15kg 四组 </li></ul></li><li><p>大黄蜂练胸（私教第一节）</p><ul><li>2.5kg 二组</li></ul></li></ul><p><strong>2016-12-20 周二</strong></p><ul><li><p>跑步机</p><ul><li>快走：时速6km、时长5min + 5min</li><li>慢跑：时速8km、时长5min</li><li>跑步：时速10km、时长5min（岔气啦…）    </li><li>倒走：时速2km、时长5min </li><li>慢走：时速4km、时长5min</li></ul></li><li><p>坐直手臂夹胸（私教第一节）：</p><ul><li>20kg 四组</li></ul></li></ul><ul><li>下拉练背（私教体验课）：<ul><li>20kg 四组 </li></ul></li></ul><p><strong>2016-12-19 周一</strong></p><ul><li>仰卧起坐4组</li></ul><p><strong>2016-12-17 周六</strong></p><ul><li><a href="https://hertzwang.github.io/WorkoutLesson02.html">健身私教日记-第二节</a></li></ul><p><strong>2016-12-15 周四</strong></p><ul><li>羽毛球约40min</li></ul><p><strong>2016-12-13 周二</strong></p><ul><li><p>跑步机：</p><ul><li>慢跑：时速 8km、时长 15min + 10min</li><li>快走：时速 5.5km、时长 5min + 5min</li><li>倒走：时速 2km、时长 5min</li></ul></li><li><p>下拉练背（私教体验课）：</p><ul><li>15kg 一组</li><li>20kg 三组</li></ul></li><li><p>划船机练背（私教体验课）：</p><ul><li>15kg 一组</li><li>20kg 三组</li></ul></li><li><p>坐直手臂夹胸（私教第一节）：</p><ul><li>15kg 一组</li><li>20kg 一组    </li></ul></li></ul><p><strong>2016-12-10 周六</strong></p><ul><li><a href="https://hertzwang.github.io/WorkoutLesson01.html">健身私教日记-第一节</a></li></ul><p><strong>2016-12-05 周一</strong></p><ul><li>椭圆仪：Level 3、时长 20min</li><li>跑步机：<ul><li>快走：时速 6km、时长 10min</li><li>倒走 时速 2km、时长 5min</li></ul></li></ul><p><strong>2016-12-03 周六</strong></p><ul><li><a href="https://hertzwang.github.io/WorkoutLesson00.html">私教体验课</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutLog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2016年11月份健身日志</title>
      <link href="/Workout201611.html"/>
      <url>/Workout201611.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p><strong>2016-11-30 周三</strong></p><ul><li>羽毛球一小时</li></ul><p><strong>2016-11-28 周一</strong></p><ul><li>椭圆仪：Level 2、时长 20min</li><li>跑步机：<ul><li>倒走 时速 2km、时长 5min</li><li>跑步：时速 8km、时长 10min</li></ul></li></ul><span id="more"></span><p><strong>2016-11-24 周四</strong></p><ul><li>跑步机：时速 8km、时长 20min</li><li>推胸一组</li></ul><p><strong>2016-11-22 周二</strong></p><ul><li>椭圆仪：Level 1、时长 30min </li></ul><p><strong>2016-11-21 周一</strong></p><ul><li>开卡</li><li>跑步机：坡度 16%、时速 5km、时长 20min</li></ul><p><strong>2016-11-20 周日</strong></p><ul><li>办卡：周年店庆买一年送半年，金蛋又砸出三个月</li></ul>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutLog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单总结申领《北京市居住证》</title>
      <link href="/BJResidence.html"/>
      <url>/BJResidence.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p>更新于：2017年02月05日上午</p><p>再次去当地派出所，带着身份证和回执单取到了北京居住证</p><p><img src="./images/BJResidence-BEIJINGTONG-B.png" alt="居住证反面" title="居住证反面"></p><span id="more"></span><p><img src="./images/BJResidence-BEIJINGTONG-A.png" alt="居住证正面" title="居住证正面"></p><p>更新于：2017年01月14日上午</p><p>去了当地的派出所（不知道的可以问中介或房主），使用<strong>就业</strong>办理居住证，材料如下：</p><ol start="0"><li>身份证原件</li><li>一寸白底免冠彩照1张（申请表上需要一张照片）</li><li>公司营业执照（由公司开据，跟人事说办居住证用）</li><li>《劳动合同书》</li><li>《房屋租赁合同》</li><li>申请表（纸质申请表，到了那儿拿表填写就行）</li><li>半年以上个税（地方税务局持身份证自助打印，添加于2017年2月20日）</li></ol><p>然后就是工作人员信息录入啦，录入完成后工作人员会将 <strong>公司营业执照</strong> 、 <strong>《劳动合同书》</strong>、 <strong>《房屋租赁合同》</strong> 归还，<strong>申请表</strong> 给另外一个工作人员，他（她）给你开具《居住证受理回执单》，签个字等15日后领取（遇法定公休日、节假日顺延）</p><p>注：不是说拿到回执单就等于拿到居住证了，这个有可能审核未通过！！！我感觉这次办理的有点悬，合同时续签的、房屋租赁合同是新签的，意味着未满6个月，这得看看相关部门信息是否互通喽。</p><hr><p>续：“原文”不太准确，找到了官方网站 <a href="https://www.bjjzzpt.com/">北京居住证平台</a>，可在网站上约</p><p>注：以下信息参考价值不大</p><hr><p>原文： <a href="http://www.bjgaj.gov.cn/web/detail_getWsgsInfo_36953_col1351.html">办理暂住登记和申领《北京市居住证》</a></p><p>前言：应根据个人情况做参考，权威说明请参考<strong>原文</strong>，一般15日内制发，首次申领、办理《居住证》免费</p><p><img src="./images/BJResidence-KITAS.png" alt="暂住证" title="暂住证"></p><h2 id="材料"><a href="#材料" class="headerlink" title="材料"></a>材料</h2><ol><li><p>1寸白底彩照1张</p></li><li><p>身份证</p></li><li><p>《暂住证》</p></li><li><p>二选一</p><ul><li><p>合法稳定就业</p><ul><li>劳动合同</li><li>公司营业执照</li></ul></li><li><p>合法稳定住所</p><ul><li>《房屋所有权证》或《不动产权证书》</li><li>租赁合同 </li></ul></li></ul></li></ol><h2 id="办理程序"><a href="#办理程序" class="headerlink" title="办理程序"></a>办理程序</h2><p>到达<em>居住地公安派出所</em> –&gt; 填写<strong>《居住证申领表》、提供以上材料</strong> –&gt; 开具《居住证受理回执单》 –&gt; 等待制发 –&gt; 携带<strong>身份证</strong>和<strong>《居住证受理回执单》</strong>领取</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Beijing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>健身私教日记-第二节</title>
      <link href="/WorkoutLesson02.html"/>
      <url>/WorkoutLesson02.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p>2016年12月17日下午4点，本次课程共5个动作，主要是腿和肩练习</p><h2 id="动作一"><a href="#动作一" class="headerlink" title="动作一"></a>动作一</h2><h3 id="半蹲练大腿"><a href="#半蹲练大腿" class="headerlink" title="半蹲练大腿"></a>半蹲练大腿</h3><p>拉伸：站立右手扶墙，右腿向后抬起、左手握住右脚踝（不可是前脚掌，会给脚踝带来压力）、右脚跟贴紧臀部，保持10s后换侧</p><p>预备：双脚平行、分开与肩同宽，挺胸、身体前倾、目视前方，双手向前伸直同肩高</p><p>动作：向下蹲至大腿与地面平行，膝盖与脚尖在一条直线上，下呼上吸</p><p>强度：20个一组，一次4组，间歇1分钟，感觉酸时做拉伸</p><p>注：可以手拿物体加大重量 </p><span id="more"></span><h2 id="动作二"><a href="#动作二" class="headerlink" title="动作二"></a>动作二</h2><h3 id="箭步走"><a href="#箭步走" class="headerlink" title="箭步走"></a>箭步走</h3><p>拉伸：站立右手扶墙，右腿向后抬起、左手握住右脚踝（不可是前脚掌，会给脚踝带来压力）、右脚跟贴紧臀部，保持10s后换侧</p><p>预备：双脚分开，抬头、挺胸、目视前方</p><p>动作：向前迈一大步，上身保持挺直双腿弯曲向下蹲，前腿大腿平行地面且膝盖不超过脚尖，后腿膝盖接近地面而不碰上，然后起身迈另一条腿，周而复始，下呼上吸</p><p>强度：约24步一组，一次4组，间歇1分钟，感觉酸时做拉伸</p><p>注：本人废材，第3组完事儿后开始冒金星、想吐，这是由于血糖低导致，应立即补充糖分（教练给买的冰红茶）并休息</p><h2 id="动作三"><a href="#动作三" class="headerlink" title="动作三"></a>动作三</h2><h3 id="哑铃——肱三头肌（长头、外侧头）"><a href="#哑铃——肱三头肌（长头、外侧头）" class="headerlink" title="哑铃——肱三头肌（长头、外侧头）"></a>哑铃——肱三头肌（长头、外侧头）</h3><p>预备：手握哑铃站立，掌心朝内，抬头、挺胸、收腹、身体微前倾，腿微弯曲、手臂放松</p><p>动作：手臂向外侧抬起同肩高，上呼下吸</p><p>强度：8~12个一组，一次4组，间歇1分钟</p><p>注：本次使用5kg的哑铃，在教练的辅助下做了8x4</p><h2 id="动作四"><a href="#动作四" class="headerlink" title="动作四"></a>动作四</h2><h3 id="哑铃——肱三头肌（外侧头）和三角肌"><a href="#哑铃——肱三头肌（外侧头）和三角肌" class="headerlink" title="哑铃——肱三头肌（外侧头）和三角肌"></a>哑铃——肱三头肌（外侧头）和三角肌</h3><p>预备：手握哑铃坐好（挺胸、收腹、目视前方），双手抬到头部两侧、掌心朝内，大臂与肩成一直线与地面平行</p><p>动作：肩部发力向上举起至大臂位于耳旁，同时掌心朝前，停下然后复原，上呼下吸</p><p>强度：8~12个一组，一次4组，间歇1分钟</p><p>注：本次使用7.5kg的哑铃，在教练的辅助下做了8x4</p><h2 id="动作五"><a href="#动作五" class="headerlink" title="动作五"></a>动作五</h2><h3 id="哑铃——肱二头肌和三角肌"><a href="#哑铃——肱二头肌和三角肌" class="headerlink" title="哑铃——肱二头肌和三角肌"></a>哑铃——肱二头肌和三角肌</h3><p>预备：手握哑铃站立，掌心朝内，抬头、挺胸、收腹、身体微前倾，腿微弯曲、手臂放松</p><p>动作：手臂向前抬起同肩高，停一下慢速复原，上呼下吸</p><p>强度：8~12个一组，一次4组，间歇1分钟</p><h2 id="外加："><a href="#外加：" class="headerlink" title="外加："></a>外加：</h2><ul><li>4组无器械腹部（体验课动作四）</li><li>跑步机 6km 20min</li><li>跑步机 8km 15min</li><li>跑步机 5.5km 6min</li></ul>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Xcode代码块提高开发效率</title>
      <link href="/XcodeCodeBlock.html"/>
      <url>/XcodeCodeBlock.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p><em>持续更新中…</em>    </p><p>前方：之前在视频中看到，敲几个字母就能生成大段代码，大大提高了效率，于是就开始研究实现。</p><h3 id="代码块效果展示"><a href="#代码块效果展示" class="headerlink" title="代码块效果展示"></a>代码块效果展示</h3><p>使用Xcode开发时，在方法内输入 <code>if</code>会出现提示，如图：</p><p><img src="./images/XcodeCodeBlock-if-01.png" alt="if代码块提示" title="if代码块提示"><br>当然，这个是官方做的，输入 <em>回车</em> 后显示如图：</p><p><img src="./images/XcodeCodeBlock-if-02.png" alt="if代码块显示" title="if代码块显示"></p><span id="more"></span><h3 id="自定义块代码块"><a href="#自定义块代码块" class="headerlink" title="自定义块代码块"></a>自定义块代码块</h3><h4 id="编写代码块"><a href="#编写代码块" class="headerlink" title="编写代码块"></a>编写代码块</h4><p>以单例代码块为例，首先写一段代码：</p><pre><code>@implementation ViewController+ (instancetype)defaultInstance &#123;    static &lt;#Class#&gt; *instance = nil;    static dispatch_once_t onceToken;    dispatch_once(&amp;onceToken, ^&#123;        instance = [[&lt;#Class#&gt; alloc] init];    &#125;);        return instance;&#125;</code></pre><p>注： 使用 <code>&lt;#</code> 和 <code>#&gt;</code> 来实现提示</p><h4 id="存储代码块"><a href="#存储代码块" class="headerlink" title="存储代码块"></a>存储代码块</h4><blockquote><p>Xcode 10</p></blockquote><ol><li><p>选中代码代码块，右击选择 <code>Create Code Snippet</code></p><p> <img src="./images/XcodeCodeBlock-Code-Block-Right-Click.png" alt="选中代码块操作" title="选中代码块操作"></p></li><li><p>设置相关内容</p><p> <img src="./images/XcodeCodeBlock-Code-Block-Settings.png" alt="设置相关内容" title="设置相关内容"></p></li></ol><blockquote><p>Xcode 10 之前</p></blockquote><ol><li><p>打开Xcode中代码块位置</p><p> <img src="./images/XcodeCodeBlock-Code-Block-Position.png" alt="Xcode中代码块位置" title="Xcode中代码块位置"></p></li><li><p>选中代码块，长按鼠标左键使光标变成黑色箭头，然后拖动至 <strong>Xcode中代码块位置</strong></p><p> <img src="./images/XcodeCodeBlock-Code-Block-Move.png" alt="存储代码块" title="存储代码块"></p></li></ol><h3 id="设置代码块"><a href="#设置代码块" class="headerlink" title="设置代码块"></a>设置代码块</h3><p>显示如图：</p><p><img src="./images/XcodeCodeBlock-Code-Block-Setting.png" alt="设置代码块界面" title="设置代码块界面"></p><ul><li>Title 显示的标题</li><li>Summary 概要描述信息</li><li>Platform 平台，包括 All、iOS、macOS、tvOS、watchOS</li><li>Language 语言，包括 Objective-C、Swift、Java、HTML 等</li><li><strong>Completion Shortcut</strong> 快捷键，输入的字符（如：<code>if</code>），一般加上前缀与系统的分开，我用的是 <code>hw</code></li><li><strong>Completion Scopes</strong> 代码块作用域，只有在设置的域中可用</li></ul><p>设置完成后就可以使用啦</p><h3 id="编辑代码块"><a href="#编辑代码块" class="headerlink" title="编辑代码块"></a>编辑代码块</h3><p>打开Xcode中代码块位置，选中需要编辑的代码块等上几秒（也可以双击），点击 <code>Edit</code> 开发编辑</p><h3 id="删除代码块"><a href="#删除代码块" class="headerlink" title="删除代码块"></a>删除代码块</h3><p>打开Xcode中代码块位置，选中需要删除的代码块，按钮键盘上的 <code>delete</code> 键</p><h3 id="代码块本地存放路径"><a href="#代码块本地存放路径" class="headerlink" title="代码块本地存放路径"></a>代码块本地存放路径</h3><p>存放路径 <code>~/Library/Developer/Xcode/UserData/CodeSnippets</code>，每一个<code>.codesnippet</code>文件都是一个代码块</p><h3 id="Objective-C-常用代码块"><a href="#Objective-C-常用代码块" class="headerlink" title="Objective-C 常用代码块"></a>Objective-C 常用代码块</h3><h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><p><code>@property (nonatomic, assign) &lt;#Object#&gt; &lt;#name#&gt;;</code><br><code>@property (nonatomic, strong) &lt;#Object#&gt; *&lt;#name#&gt;;</code><br><code>@property (nonatomic, copy) &lt;#Object#&gt; *&lt;#name#&gt;;</code><br><code>__weak typeof(self) weakSelf = self;</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (weakSelf) &#123;</span><br><span class="line">typeof(self) strongSelf = weakSelf;</span><br><span class="line">    </span><br><span class="line">&lt;<span class="meta">#statements#&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="单例"><a href="#单例" class="headerlink" title="单例"></a>单例</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+ (instancetype)defaultInstance &#123;</span><br><span class="line">    <span class="keyword">static</span> &lt;#Class#&gt; *instance = nil;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">dispatch_once_t</span> onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        instance = [[&lt;#Class#&gt; alloc] init];</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="初始化UIWindow"><a href="#初始化UIWindow" class="headerlink" title="初始化UIWindow"></a>初始化UIWindow</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];</span><br><span class="line">[_window setAutoresizesSubviews:NO];</span><br><span class="line">[_window makeKeyAndVisible];</span><br><span class="line">[_window setRootViewController:&lt;#RootViewController#&gt;];</span><br></pre></td></tr></table></figure><h4 id="Mark"><a href="#Mark" class="headerlink" title="Mark"></a>Mark</h4><p><code>#pragma mark - &lt;#Name#&gt;</code>    </p><h4 id="Unit-Test"><a href="#Unit-Test" class="headerlink" title="Unit Test"></a>Unit Test</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> &lt;#Description#&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)test&lt;#Name#&gt; &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 使用预期：预期的作用在于执行网络请求后可等待请求返回结果 */</span></span><br><span class="line">    XCTestExpectation *expectation = [self expectationWithDescription:@<span class="string">&quot;expectationWithDescription&quot;</span>]; <span class="comment">//获取预期</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 执行网络请求代码，在 block 中执行 [expectation fulfill] 结束预期 */</span></span><br><span class="line">    &lt;#执行网络请求代码#&gt;</span><br><span class="line">    [expectation fulfill]; <span class="comment">//结束预期</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 设置预期时长及预期失败处理 */</span></span><br><span class="line">    [self waitForExpectationsWithTimeout:<span class="number">10</span> handler:^(NSError * _Nullable error) &#123;</span><br><span class="line">        <span class="keyword">if</span> (error) &#123;</span><br><span class="line">            <span class="comment">//预期失败处理</span></span><br><span class="line">            NSLog(@<span class="string">&quot;%@&quot;</span>, error);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Swift-常用代码块"><a href="#Swift-常用代码块" class="headerlink" title="Swift 常用代码块"></a>Swift 常用代码块</h3><h4 id="Mark-1"><a href="#Mark-1" class="headerlink" title="Mark"></a>Mark</h4><p><code>//MARK: - &lt;#Name#&gt; Protocol Method</code></p><h4 id="类方法"><a href="#类方法" class="headerlink" title="类方法"></a>类方法</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> &lt;#<span class="title">name</span>#&gt;(&lt;#<span class="title">parameters</span>#&gt;) -&gt; &lt;#<span class="title">return</span> <span class="title">type</span>#&gt; </span>&#123;</span><br><span class="line">        <span class="operator">&lt;</span><span class="keyword">#function</span> body#<span class="operator">&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Xcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>健身私教日记-第一节</title>
      <link href="/WorkoutLesson01.html"/>
      <url>/WorkoutLesson01.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p>2016年12月10日下午4点，本次课程共5个动作，主要是胸部练习</p><h2 id="动作一"><a href="#动作一" class="headerlink" title="动作一"></a>动作一</h2><h3 id="向上推杠铃"><a href="#向上推杠铃" class="headerlink" title="向上推杠铃"></a>向上推杠铃</h3><p>热身：护胸运动、活动肩</p><p>预备：躺在垫子上，背部镂空、杠铃垂直于胸二头，握杠胳膊成90度、肘肩平行后微收肘、手软肉部分撑杠铃、四指并拢握杠</p><p>动作：加速向上推至胳膊不伸直最大程度，缓慢收回，推呼收吸</p><p>强度：15个一组，一次4组，间歇1分钟</p><p>注：该动作有一定危险性，另杠铃上有保护，撑起后记得转一下，确认放好之后再卸力</p><span id="more"></span><h2 id="动作二"><a href="#动作二" class="headerlink" title="动作二"></a>动作二</h2><h3 id="Seated-Straight-Arm-Clip-Chest-坐直手臂夹胸"><a href="#Seated-Straight-Arm-Clip-Chest-坐直手臂夹胸" class="headerlink" title="Seated Straight Arm Clip Chest 坐直手臂夹胸"></a>Seated Straight Arm Clip Chest 坐直手臂夹胸</h3><p>器材：Seated Straight Arm Clip Chest</p><p>预备：调整好座椅高度，坐直、挺胸，握好、肘略低于肩，手、小臂、大臂和胸在一条直线上</p><p>动作：胳膊保持、胸部发力向前，向前推然后慢慢还原，推呼收吸</p><p>强度：15个一组，一次4组，间歇1分钟</p><h2 id="动作三"><a href="#动作三" class="headerlink" title="动作三"></a>动作三</h2><h3 id="大黄蜂（小）——练胸"><a href="#大黄蜂（小）——练胸" class="headerlink" title="大黄蜂（小）——练胸"></a>大黄蜂（小）——练胸</h3><p>预备：调整好座椅高度，坐直、挺胸，握好、肘略低于肩</p><p>动作：向前推，推呼收吸</p><p>强度：15个一组，一次4组，间歇1分钟</p><p>注：由于个人体质原因未加重</p><h2 id="动作四"><a href="#动作四" class="headerlink" title="动作四"></a>动作四</h2><h3 id="双绳下拉后分开"><a href="#双绳下拉后分开" class="headerlink" title="双绳下拉后分开"></a>双绳下拉后分开</h3><p>预备：双脚分开、腿微弯曲、身体前倾，保持平衡</p><p>动作：手各握一头间隔约拳宽，向下拉至腹部后双手分开约肩宽，然后还原，拉呼收吸</p><p>强度：15个一组，一次4组，间歇1分钟</p><p>注：由于个人体质原因一个也未做完…</p><h2 id="动作五"><a href="#动作五" class="headerlink" title="动作五"></a>动作五</h2><h3 id="哑铃——肱三头肌（内侧头）"><a href="#哑铃——肱三头肌（内侧头）" class="headerlink" title="哑铃——肱三头肌（内侧头）"></a>哑铃——肱三头肌（内侧头）</h3><p>预备：双脚分开、腿微弯曲、双臂向后伸直、身体前倾至双臂平行地面，保持平衡</p><p>动作：手握哑铃掌心朝内，大臂保持不动、小臂与地面垂直，伸直胳膊、转动手腕至掌心朝下，然后还原，伸呼收吸</p><p>强度：15个一组，一次4组</p><h2 id="外加3组无器械腹部（体验课动作四）"><a href="#外加3组无器械腹部（体验课动作四）" class="headerlink" title="外加3组无器械腹部（体验课动作四）"></a>外加3组无器械腹部（体验课动作四）</h2>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP for Mac</title>
      <link href="/PHPForMac.html"/>
      <url>/PHPForMac.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p>前言：在Mac上运行PHP文件，因Mac自带Apache服务和PHP，只需简单配置即可运行静态PHP文件</p><h3 id="两个文件夹路径"><a href="#两个文件夹路径" class="headerlink" title="两个文件夹路径"></a>两个文件夹路径</h3><ol><li>Apache 配置文件目录 <code>/etc/apache2</code></li><li>部署目录 <code>/Library/WebServer/Documents</code></li></ol><h3 id="两个命令"><a href="#两个命令" class="headerlink" title="两个命令"></a>两个命令</h3><ol><li>启动 Apache 服务 <code>sudo apachectl start</code></li><li>停止 Apache 服务 <code>sudo apachectl stop</code></li></ol><h3 id="一个配置文件"><a href="#一个配置文件" class="headerlink" title="一个配置文件"></a>一个配置文件</h3><p>修改 Apache 配置文件目录下的 <code>httpd.conf</code> ，将 <code>LoadModule php5_module libexec/apache2/libphp5.so</code> 打开（将前面的<code>#</code>去掉，修改需要 <em>root</em>权限）</p>]]></content>
      
      
      <categories>
          
          <category> IT </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>健身私教日记-体验课</title>
      <link href="/WorkoutLesson00.html"/>
      <url>/WorkoutLesson00.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p>2016年12月3日下午4点，本次课程共5个动作（含一个组合动作），主要是背部练习</p><h2 id="动作一"><a href="#动作一" class="headerlink" title="动作一"></a>动作一</h2><h3 id="类似小燕子飞"><a href="#类似小燕子飞" class="headerlink" title="类似小燕子飞"></a>类似小燕子飞</h3><p>预备：趴在垫子上</p><p>动作：胳膊前伸，用背部力量使胳膊和腿离开地面，努力向上起（越高越好），停顿一下然后还原（手和下身不落地），上呼下吸</p><p>强度：15个一组，一次4组，间歇1分钟</p><span id="more"></span><h2 id="动作二"><a href="#动作二" class="headerlink" title="动作二"></a>动作二</h2><h3 id="Seated-Horizontal-Pully（划船机）练背"><a href="#Seated-Horizontal-Pully（划船机）练背" class="headerlink" title="Seated Horizontal Pully（划船机）练背"></a>Seated Horizontal Pully（划船机）练背</h3><p>器材：Seated Horizontal Pully（划船机）</p><p>预备：坐直、夹肩膀、胳膊肘向下、拉起</p><p>动作：用背部力量快速向后拉至腹部，停顿一下后缓慢还原，拉呼放吸</p><p>强度：15个一组，一次4组，间歇1分钟</p><h2 id="动作三"><a href="#动作三" class="headerlink" title="动作三"></a>动作三</h2><h3 id="High-Pully-下拉练背"><a href="#High-Pully-下拉练背" class="headerlink" title="High Pully 下拉练背"></a>High Pully 下拉练背</h3><p>器材：High Pully</p><p>运动前拉伸：双手扶器材，胳膊伸直与身体成直线，身体放松、翘臀，感觉背部得到拉伸保持10秒，身体左倾拉伸10秒、右倾拉伸10秒</p><p>预备：下拉，坐直、夹肩</p><p>动作：使用背部力量快速向下拉与肩同高，停顿一下后缓慢还原，拉呼放吸</p><p>强度：20个一组，一次4组，间歇1分钟并拉伸一次</p><h2 id="动作四（组合动作）"><a href="#动作四（组合动作）" class="headerlink" title="动作四（组合动作）"></a>动作四（组合动作）</h2><h3 id="无器械腹部"><a href="#无器械腹部" class="headerlink" title="无器械腹部"></a>无器械腹部</h3><p>上身：躺在垫子上，双脚弯曲90度，双手交叉放在胸前，向上起约30度、下来时不落地，上呼下吸</p><p>下身：躺在垫子上，上身不支，双腿抬起蹬自行车，尽量向前蹬（不是向上），匀速呼吸</p><p>强度：上身50个、下身30个算一组，一次4组，间歇1分钟</p>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>健身日志</title>
      <link href="/Workout.html"/>
      <url>/Workout.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p><mark>本文停止更新，请查看相应年份的日志，或进入 <a href="/tags/Workout/">Workout标签</a></mark></p><p><strong>2016-12-24 周六</strong></p><ul><li><p>跑步机 时速9km、时长10min</p></li><li></li><li><p>坐直手臂夹胸（私教第一节）：</p><ul><li>20kg 四组</li></ul></li><li><p>下拉练背（私教体验课）：</p><ul><li>20kg 四组 </li></ul></li><li><p>划船机练背（私教体验课）：</p><ul><li>20kg 四组</li></ul></li></ul><span id="more"></span><p><strong>2016-12-23 周五</strong></p><ul><li><p>跑步机</p><ul><li>快走：时速6km、时长5min + 5min</li><li>慢跑：时速8km、时长15min</li><li>跑步：时速10km、时长3min（岔气啦…）    </li><li>倒走：时速2km、时长5min </li></ul></li><li><p>坐直手臂夹胸（私教第一节）：</p><ul><li>15kg 四组</li></ul></li><li><p>下拉练背（私教体验课）：</p><ul><li>15kg 四组 </li></ul></li><li><p>大黄蜂练胸（私教第一节）</p><ul><li>2.5kg 二组</li></ul></li></ul><p><strong>2016-12-20 周二</strong></p><ul><li><p>跑步机</p><ul><li>快走：时速6km、时长5min + 5min</li><li>慢跑：时速8km、时长5min</li><li>跑步：时速10km、时长5min（岔气啦…）    </li><li>倒走：时速2km、时长5min </li><li>慢走：时速4km、时长5min</li></ul></li><li><p>坐直手臂夹胸（私教第一节）：</p><ul><li>20kg 四组</li></ul></li></ul><ul><li>下拉练背（私教体验课）：<ul><li>20kg 四组 </li></ul></li></ul><p><strong>2016-12-19 周一</strong></p><ul><li>仰卧起坐4组</li></ul><p><strong>2016-12-17 周六</strong></p><ul><li><a href="https://hertzwang.github.io/WorkoutLesson02.html">健身私教日记-第二节</a></li></ul><p><strong>2016-12-15 周四</strong></p><ul><li>羽毛球约40min</li></ul><p><strong>2016-12-13 周二</strong></p><ul><li><p>跑步机：</p><ul><li>慢跑：时速 8km、时长 15min + 10min</li><li>快走：时速 5.5km、时长 5min + 5min</li><li>倒走：时速 2km、时长 5min</li></ul></li><li><p>下拉练背（私教体验课）：</p><ul><li>15kg 一组</li><li>20kg 三组</li></ul></li><li><p>划船机练背（私教体验课）：</p><ul><li>15kg 一组</li><li>20kg 三组</li></ul></li><li><p>坐直手臂夹胸（私教第一节）：</p><ul><li>15kg 一组</li><li>20kg 一组    </li></ul></li></ul><p><strong>2016-12-10 周六</strong></p><ul><li><a href="https://hertzwang.github.io/WorkoutLesson01.html">健身私教日记-第一节</a></li></ul><p><strong>2016-12-05 周一</strong></p><ul><li>椭圆仪：Level 3、时长 20min</li><li>跑步机：<ul><li>快走：时速 6km、时长 10min</li><li>倒走 时速 2km、时长 5min</li></ul></li></ul><p><strong>2016-12-03 周六</strong></p><ul><li><a href="https://hertzwang.github.io/WorkoutLesson00.html">私教体验课</a></li></ul><p><strong>2016-11-30 周三</strong></p><ul><li>羽毛球一小时</li></ul><p><strong>2016-11-28 周一</strong></p><ul><li>椭圆仪：Level 2、时长 20min</li><li>跑步机：<ul><li>倒走 时速 2km、时长 5min</li><li>跑步：时速 8km、时长 10min</li></ul></li></ul><p><strong>2016-11-24 周四</strong></p><ul><li>跑步机：时速 8km、时长 20min</li><li>推胸一组</li></ul><p><strong>2016-11-22 周二</strong></p><ul><li>椭圆仪：Level 1、时长 30min </li></ul><p><strong>2016-11-21 周一</strong></p><ul><li>开卡</li><li>跑步机：坡度 16%、时速 5km、时长 20min</li></ul><p><strong>2016-11-20 周日</strong></p><ul><li>办卡：周年店庆买一年送半年，金蛋又砸出三个月</li></ul>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Workout </tag>
            
            <tag> WorkoutLog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用工具及网址</title>
      <link href="/Bookmarks.html"/>
      <url>/Bookmarks.html</url>
      
        <content type="html"><![CDATA[<p>若有链接失效请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><p><em>持续更新中…</em> </p><h3 id="App托管类"><a href="#App托管类" class="headerlink" title="App托管类"></a>App托管类</h3><ul><li><p><a href="http://fir.im/">fir.im</a> </p><p>  北京风起云飞科技有限公司，旗下产品 <strong>fir.im</strong> 为开发者提供测试应用极速发布，应用崩溃实时分析、用户反馈收集等一系列开发测试效率工具服务，帮助开发者将更多精力放在产品的开发与应用的优化上</p></li><li><p><a href="https://www.pgyer.com/">蒲公英</a> </p><p>  西安点测网络科技有限公司旗下的『蒲公英』品牌，是专为 <strong>iOS</strong>、<strong>Android</strong> 开发者提供的免费用应用内测、托管的平台，旨在解决开发者将应用分发给内测用户时的繁杂、低效的问题</p></li></ul><h3 id="IT相关"><a href="#IT相关" class="headerlink" title="IT相关"></a>IT相关</h3><ul><li><p><a href="https://developer.apple.com/">Apple Developer</a></p><p>  Apple 开发者官网</p></li><li><p><a href="https://developer.apple.com/news/">Apple Developer 动态</a></p></li><li><p><a href="https://developer.android.com/">Android Developer</a></p><p>  Android 开发者官网</p></li><li><p><a href="http://www.asciiwwdc.com/">历年WWDC会议记录（英文）</a></p></li></ul><span id="more"></span><ul><li><p><a href="http://www.allitebooks.com/">英文IT书籍</a></p></li><li><p><a href="http://stackoverflow.com/">StackOverflow</a></p><p>  问题解决平台</p></li><li><p><a href="http://security.stackexchange.com/">StackExchange</a></p><p>  信息安全交流平台，关于https、TLS/SSL等</p></li><li><p><a href="https://github.com/">Github</a></p><p>  代码托管平台</p></li><li><p><a href="http://www.bejson.com/">BeJson</a></p><p>  在线JSON校验格式化工具</p></li><li><p><a href="https://fbinfer.com/">Infer</a></p><p>  Infer is a static analysis tool - if you give Infer some Java or C/C++/Objective-C code it produces a list of potential bugs.</p></li></ul><h3 id="工具类"><a href="#工具类" class="headerlink" title="工具类"></a>工具类</h3><ul><li><p><a href="http://www.axure.com/">Axure</a></p><p>  产品原型设计工具，可扩展类库，支持 <strong>Mac</strong> 和 <strong>Windows</strong></p></li><li><p><a href="https://www.mockplus.cn/">Mockplus</a></p><p>  更快、更简单的原型设计，支持 <strong>Mac</strong>、<strong>Windows</strong>、<strong>iOS</strong> 和 <strong>Android</strong></p></li><li><p><a href="https://www.sketchapp.com/">Sketch</a></p><p>  <strong>Mac</strong>平台上一款轻量、易用的矢量设计工具，让<em>UI设计更简单、更高效</em></p></li><li><p><a href="http://getmarkman.com/">马克鳗(MarkMan)</a></p><p>  高效的设计稿标注、测量工具，支持 <strong>Mac</strong> 和 <strong>Windows</strong></p></li><li><p><a href="https://itunes.apple.com/cn/app/simple-svn-server/id1040404148?mt=12">Simple SVN Server</a></p><p>  <strong>Mac</strong> 上不错的 <strong>SVN</strong> 服务工具</p></li><li><p><a href="http://www.zennaware.com/cornerstone/">Cornerstone</a></p><p>  一款不错的<strong>Mac</strong>平台<em>SVN管理工具</em></p></li><li><p><a href="https://www.omnigroup.com/omnigraffle">Omnigraffle</a></p><p>  <strong>Mac</strong>、<strong>iOS</strong>平台上效率工具，类似<strong>Microsoft</strong>的<a href="https://products.office.com/zh-cn/visio/flowchart-software"><strong>Visio</strong></a>，用于<em>创建 IT 网络图、构建组织结构图、记录业务流程、绘制平面布置图等</em></p></li><li><p><a href="https://itaskx.com/en/index.aspx">iTaskX</a><br>  <strong>Mac</strong>平台上效率工具，类似<strong>Microsoft</strong>的<a href="https://products.office.com/zh-cn/project/project-and-portfolio-management-software"><strong>Visio</strong></a>，用于<em>简化项目、资源和项目组合管理，保持工作井然有序</em></p></li><li><p><a href="http://macdown.uranusjr.com/">Macdown</a></p><p>  <strong>Mac</strong> 平台上不错的 <strong>MarkDown</strong> 语言工具</p></li><li><p><a href="http://www.mdcharm.com/">Mdcharm</a></p><p>  功能完备、长相一般，隐藏菜单栏后也算简约，目前已开源，不再更新。支持 <strong>Windows</strong> 和 <strong>Linux</strong></p></li><li><p><a href="http://www.parallels.com/cn/products/desktop/">Parallels Desktop</a></p><p>  <strong>Mac</strong> 平台上不错的虚拟机软件</p></li><li><p><a href="http://www.scootersoftware.com/download.php">Beyond Compare</a></p><p>  一款不错的文件差异比较、内容合并的软件，支持文本、表格、图片、二进制文件、注册表等，支持平台 <strong>Mac</strong> 、 <strong>Linux</strong> 和 <strong>Windows</strong></p></li><li><p><a href="https://www.teamviewer.com/en/">Teamviewer</a></p><p>  远程控制（桌面）软件，支持 <strong>Mac</strong> 、 <strong>Windows</strong> 、 <strong>Linux</strong> 、 <strong>Chrome OS</strong> 、 <strong>iOS</strong> 、 <strong>Android</strong> 、 <strong>Windows App</strong> 、 <strong>BlackBerry</strong> </p></li><li><p><a href="https://www.charlesproxy.com/">Charles</a></p><p>  一款不错的 <strong>数据抓包</strong> 软件，支持 <strong>Mac</strong> 、 <strong>Windows</strong> 和 <strong>Linux</strong> </p></li><li><p><a href="https://itunes.apple.com/cn/app/easy-apns-provider-tui-song/id989622350?mt=12">Easy APNs Provider</a></p><p>  一款不错的为 <strong>iOS</strong> 、<strong>Mac App</strong> 提供推送测试的小工具</p></li><li><p><a href="https://mediaarea.net/zh/MediaInfo">MediaInfo</a></p><p>  一款不错的多媒体参数显示软件，支持<strong>Mac、Windows、Debian、Ubuntu、Linux Mint、RedHat Entreprise Linux、CentOS、Fedora、openSUSE、Mandriva、ArchLinux</strong></p></li><li><p><a href="http://dbwrench.com/">DbWrench</a></p><p>  数据库设计和同步软件，支持<strong>Mac、Windows、Linux</strong></p></li><li><p><a href="https://www.navicat.com/download">Navicat系列</a></p><p>  数据库建模、连接等工具，全平台</p></li><li><p><a href="https://todoist.com/">Todoist</a></p><p>  Todoist比其他待办事项管理服务提供更多有用功能。而您将能定制您的体验, 管理您的任务和项目同时提升您的效率。</p></li></ul><ul><li><p><a href="http://sqlitebrowser.org/">DB Browser for SQLite</a></p><p>  一款不错的 <strong>SQLite3</strong> 文件查看软件，支持平台 <strong>Mac</strong> 和 <strong>Windows</strong></p></li></ul><h3 id="iOS第三方库"><a href="#iOS第三方库" class="headerlink" title="iOS第三方库"></a>iOS第三方库</h3><ul><li><p><a href="http://www.mob.com/">Mob</a></p><p>  掌淘科技本着一切以开发者需求为上的原则，倾力打造Mob（原ShareSDK）移动开发者服务平台，致力于帮助移动开发者解决实际需求，构建了社交分享服务平台、手游视频录制服务平台、App统计服务平台和短信验证服务平台等四大分平台，一系列其他的开发者服务还将陆续推出，力图为开发者打造最贴心的一站式服务平台。</p></li><li><p><a href="http://www.lecloud.com/zh-cn/help">乐视云</a></p><p>  乐视云计算有限公司出的视频管理平台，含有点播、直播等视频服务</p></li><li><p>网络封装 </p><ul><li>Objective-C <a href="https://github.com/AFNetworking/AFNetworking">AFNetworking</a> </li><li>Swift <a href="https://github.com/Alamofire/Alamofire">Alamofire</a></li></ul></li><li><p>原生播放器 <a href="https://github.com/renzifeng/ZFPlayer">ZFPlayer</a></p></li><li><p>HUD提示 <a href="https://github.com/jdg/MBProgressHUD">MBProgressHUD</a></p></li><li><p>加载网络图片 <a href="https://github.com/rs/SDWebImage">SDWebImage</a></p></li><li><p>文件压缩、解压 <a href="https://github.com/ZipArchive/ZipArchive">ZipArchive</a></p></li><li><p>键盘遮挡 <a href="https://github.com/michaeltyson/TPKeyboardAvoiding">TPKeyboardAvoiding</a></p></li><li><p>下拉刷新、上拉加载 <a href="https://github.com/CoderMJLee/MJRefresh">MJRefresh</a></p></li><li><p>HTTP Server <a href="https://github.com/robbiehanson/CocoaHTTPServer">CocoaHTTPServer</a></p></li><li><p>UI测试 <a href="https://github.com/kif-framework/KIF">KIF</a></p></li></ul><h3 id="PHP相关"><a href="#PHP相关" class="headerlink" title="PHP相关"></a>PHP相关</h3><ul><li><p><a href="http://php.net/">PHP官网</a>，下载、文档等</p></li><li><p>PHP基本语法</p><ul><li><a href="http://www.w3schools.com/php/">英文</a></li><li><a href="http://w3school.com.cn/php/index.asp">中文</a></li></ul></li><li><p>IDE <a href="https://www.jetbrains.com/phpstorm/download/">PhpStorm</a></p></li><li><p>CI框架 </p><ul><li><a href="https://www.codeigniter.com/">CodeIgniter</a></li><li><a href="http://codeigniter.org.cn/">CodeIgniter 中国</a></li><li><a href="https://github.com/bcit-ci/CodeIgniter/">Github</a></li></ul></li></ul><h3 id="其它链接"><a href="#其它链接" class="headerlink" title="其它链接"></a>其它链接</h3><ul><li><p><a href="https://fast.com/">网速测试</a></p><p>  测算当前的互联网下载速度</p></li><li><p><a href="http://www.tiobe.com/tiobe-index/">TIOBE</a></p><p>  编程语言排行</p></li><li><p><a href="https://www.mantisbt.org/">MantisBT</a></p><p>  MantisBT是一个流行的开源Web Bug跟踪系统，使用PHP编写，根据发布的GNU通用公共许可证(GPL)，支持<strong>Linux、Windows和Mac OS X</strong>，兼容<strong>Chrome、Firefox、Safari、Opera和IE 7 +</strong></p></li><li><p><a href="http://www.jirou.com/html/qixie.html">健身器械</a></p><p>  机械使用相关</p></li><li><p><a href="http://charts.udpwork.com/">JS 在线统计图表制作工具</a></p><p>  JS在线统计图表制作工具，支持曲线图、折线图、条形图（竖柱）<br>  、条形图（横条）、饼图、面积图、XY散点图。</p></li><li><p><a href="http://tool.chinaz.com/tools/urlencode.aspx">常见编码转换</a></p><p>  站长工具，支持 Unicode编码、UTF-8编码、URL编码/解码、Unix时间戳、Ascii/Native编码互转、base64图片在线转换工具。</p></li><li><p><a href="https://www.macx.cn/thread-2069838-1-1.html?mod=viewthread&tid=2069838&extra=page%253D1&page=1">Mac 打开软件错误解决</a></p><p>  提示“不明的开发者”或”文件损坏“，在终端执行 <code>sudo spctl --master-disable</code> 并重启</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Bookmarks </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tools </tag>
            
            <tag> Bookmarks </tag>
            
            <tag> Links </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unity与iOS原生02</title>
      <link href="/Unity-iOS-02.html"/>
      <url>/Unity-iOS-02.html</url>
      
        <content type="html"><![CDATA[<h1 id="Unity调用iOS方法"><a href="#Unity调用iOS方法" class="headerlink" title="Unity调用iOS方法"></a>Unity调用iOS方法</h1><p><strong>参考文章:<a href="http://dev.arinchina.com/unity3dwz/ar966/966/1">如何通过unity调用ios原生代码</a></strong> ，不吝赐教<a href="mailto:hertz@hertzwang.com">hertz@hertzwang.com</a></p><h3 id="一、Unity部分"><a href="#一、Unity部分" class="headerlink" title="一、Unity部分"></a>一、Unity部分</h3><p>1.在Unity工程中新建一个<code>Assets</code>:</p><p><img src="./images/Unity-iOS-02-New-Assets.png" alt="新建一个Assets" title="新建一个Assets">    </p><span id="more"></span><p>2.将<code>Square</code>拖动至<code>Hierarchy</code>:</p><p><img src="./images/Unity-iOS-02-Move-Square.png" alt="将Square拖动至Hierarchy" title="将Square拖动至Hierarchy">    </p><p>3.给<code>Square</code>添加一个脚本，输入名字<code>UnitySendMessageToiOS</code>，语言使用默认的 <code>C Sharp</code>：</p><p><img src="./images/Unity-iOS-02-Square-Script.png" alt="给Square添加一个脚本" title="给Square添加一个脚本">    </p><p>4.打开<code>UnitySendMessageToiOS</code>脚本添加按钮及点击事件：            </p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.InteropServices; <span class="comment">//1.添加InteropServices</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UnitySendMessageToiOS</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.声名外部方法（iOS方法）</span></span><br><span class="line">[<span class="meta">DllImport(<span class="meta-string">&quot;__Internal&quot;</span>)</span>] <span class="comment">//注意没有分号</span></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unitySendMessageWithString</span>(<span class="params"> <span class="built_in">string</span> str </span>)</span>;</span><br><span class="line"><span class="comment">//more...</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Use this for initialization</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>)</span> &#123;</span><br><span class="line">print ( <span class="string">&quot;UnitySendMessageToiOS start&quot;</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Update is called once per frame</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.添加一个按钮调用外部方法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OnGUI</span> (<span class="params"></span>)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> ( GUI.Button( <span class="keyword">new</span> Rect( Screen.width - <span class="number">200</span>, <span class="number">0</span>, <span class="number">200</span>, <span class="number">100</span> ), <span class="string">&quot;Back&quot;</span> )) &#123;</span><br><span class="line">print ( <span class="string">&quot;Unity Button Clicked&quot;</span> ); <span class="comment">//控制台打印</span></span><br><span class="line"></span><br><span class="line">unitySendMessageWithString ( <span class="string">&quot;Unity Button Clicked&quot;</span> ); <span class="comment">//调用外部方法</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.生成Xcode工程</p><h3 id="二、iOS部分"><a href="#二、iOS部分" class="headerlink" title="二、iOS部分"></a>二、iOS部分</h3><p>1.在<code>UnityAppController.mm</code>里声名并实现外部方法<code>unitySendMessageWithString </code>：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">unitySendMessageWithString</span><span class="params">(<span class="keyword">char</span> *message)</span> </span>&#123;</span><br><span class="line">        NSString *msg = [[NSString alloc] initWithCString:message encoding:NSUTF8StringEncoding];</span><br><span class="line">        [[[UIAlertView alloc] initWithTitle:@<span class="string">&quot;Alert&quot;</span> message:msg delegate:nil cancelButtonTitle:@<span class="string">&quot;OK&quot;</span> otherButtonTitles:nil, nil] show];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.修改<code>Bundle Identifier</code>用真机运行</p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Unity </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unity与iOS原生01</title>
      <link href="/Unity-iOS-01.html"/>
      <url>/Unity-iOS-01.html</url>
      
        <content type="html"><![CDATA[<h1 id="以原生为主的启动、原生与Unity3D视图Push-Pop切换"><a href="#以原生为主的启动、原生与Unity3D视图Push-Pop切换" class="headerlink" title="以原生为主的启动、原生与Unity3D视图Push/Pop切换"></a>以原生为主的启动、原生与Unity3D视图Push/Pop切换</h1><p><strong>参考文章:<a href="http://www.ceeger.com/forum/read.php?tid=20533">在iOS APP中反复打开和关闭Unity页面</a></strong> ，不吝赐教<a href="mailto:hertz@hertzwang.com">hertz@hertzwang.com</a></p><p><a href="https://store.unity.com/cn">获取Unity</a>    </p><p>使用 <code>Unity Version 5.3.5f1 Personal</code>和<code>Xcode 7.3.1</code></p><p>1、打开<code>Unity</code> New 一个新项目；        </p><p>2、<code>File</code>–&gt;<code>Build Settings...</code>打开<strong>Build Setting</strong>对话框，<code>Platform</code>选择<code>iOS</code>，点击<code>Build</code>按钮生成<code>Xcode工程</code>；        </p><p>3、从<code>Finder</code>打开生成的<code>Xcode项目</code>；            </p><p>4、在<code>Project/Classes/</code>中新建原生视图<code>HomepageViewController</code>，使用XIB：    </p><span id="more"></span><p>4.1、<code>HomepageViewController.h</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  定义推出Unity视图Block</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param isFirst 首次点击</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span><span class="params">(^HomepageViewControllerPushUnityBlock)</span><span class="params">(BOOL isFirst)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  原生主视图</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@interface HomepageViewController : UIViewController</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  按钮点击回调</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@property (nonatomic, copy) HomepageViewControllerPushUnityBlock homepageViewControllerPushUnityBlock;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>4.2、<code>HomepageViewController.m</code>    </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  Push Unity视图</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param sender 按钮</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (IBAction)pushUnity:(UIButton *)sender &#123;</span><br><span class="line">    <span class="keyword">if</span> (_homepageViewControllerPushUnityBlock) &#123;</span><br><span class="line">        _homepageViewControllerPushUnityBlock(!sender.isSelected);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [sender setSelected:YES];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5、在<code>UnityAppController.h</code>中声名<code>HomepageViewController</code>和<code>UINavigationController</code>：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HomepageViewController *homepageViewController; <span class="comment">//原生主视图</span></span><br><span class="line">UINavigationController *homepageNavigationController; <span class="comment">//导航控制器</span></span><br></pre></td></tr></table></figure><p>6、 <code>UnityAppController.mm</code>修改，调整<strong>启动顺序</strong>和<strong>界面切效果</strong>：</p><ul><li><p>6.1、添加一个成员变量<code>homepageEnable</code>，用于防止多次创建原生视图    </p><pre><code>  BOOL homepageEnable = YES; //只启动一次</code></pre></li><li><p>6.2、修改方法<code>applicationDidBecomeActive:</code>，注释Unity的启动、添加调用新启动：    </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)applicationDidBecomeActive:(UIApplication*)application</span><br><span class="line">&#123;</span><br><span class="line">::<span class="built_in">printf</span>(<span class="string">&quot;-&gt; applicationDidBecomeActive()\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//add new code begin</span></span><br><span class="line">    <span class="keyword">if</span> (homepageEnable) &#123;</span><br><span class="line">        homepageEnable = NO;</span><br><span class="line">        [self performSelector:@selector(startHomepage:) withObject:application afterDelay:<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//add new code end</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span>(_snapshotView)</span><br><span class="line">&#123;</span><br><span class="line">[_snapshotView removeFromSuperview];</span><br><span class="line">_snapshotView = nil;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(_unityAppReady)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(UnityIsPaused() &amp;&amp; _wasPausedExternal == <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">UnityPause(<span class="number">0</span>);</span><br><span class="line">UnityWillResume();</span><br><span class="line">&#125;</span><br><span class="line">UnitySetPlayerFocus(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(!_startUnityScheduled)</span><br><span class="line">&#123;</span><br><span class="line">_startUnityScheduled = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">//[self performSelector:@selector(startUnity:) withObject:application afterDelay:0]; //注释Unity启动</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">_didResignActive = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>6.3、实现<code>startHomepage:</code>方法：        </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  启动原生视图</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  @param application 应用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)startHomepage:(UIApplication*)application &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//初始化原生视图</span></span><br><span class="line">    homepageViewController = [[HomepageViewController alloc] initWithNibName:@<span class="string">&quot;HomepageViewController&quot;</span> bundle:[NSBundle mainBundle]];</span><br><span class="line">    __weak UnityAppController *weakSelf = self;</span><br><span class="line">    homepageViewController.homepageViewControllerPushUnityBlock = ^(BOOL isFirst) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isFirst) &#123;</span><br><span class="line">            [weakSelf startUnity:application]; <span class="comment">//首次点击调用启动Unity</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            [weakSelf restartUnity];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//初始化导航控制器</span></span><br><span class="line">    homepageNavigationController = [[UINavigationController alloc] initWithRootViewController:homepageViewController];</span><br><span class="line">[homepageNavigationController setNavigationBarHidden:YES]; <span class="comment">//隐藏导航栏</span></span><br><span class="line">    <span class="comment">//设置为主视图</span></span><br><span class="line">    [_window setRootViewController:homepageNavigationController];</span><br><span class="line">    [UnityGetMainWindow() makeKeyAndVisible];</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></li><li><p>6.4、实现<code>restartUnity</code>方法：            </p>  <figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  重启Unity</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="operator">-</span> (void)restartUnity &#123;</span><br><span class="line">    </span><br><span class="line">    [homepageNavigationController pushViewController:_rootController animated:<span class="type">YES</span>]; <span class="comment">//Push出Unity</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (_didResignActive) &#123;</span><br><span class="line">        <span class="type">UnityPause</span>(<span class="literal">false</span>); <span class="comment">//恢复Unity</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    _didResignActive <span class="operator">=</span> <span class="type">NO</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>7、修改<code>UnityAppController+ViewHandling.mm</code>的<code>showGameUI</code>方法实现Push效果，并添加Pop按钮：        </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)showGameUI</span><br><span class="line">&#123;</span><br><span class="line">HideActivityIndicator();</span><br><span class="line">HideSplashScreen();</span><br><span class="line"></span><br><span class="line"><span class="comment">// make sure that we start up with correctly created/inited rendering surface</span></span><br><span class="line"><span class="comment">// NB: recreateGLESSurface won&#x27;t go into rendering because _unityAppReady is false</span></span><br><span class="line">[_unityView recreateGLESSurface];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//add code begin</span></span><br><span class="line">    <span class="comment">//添加一个按钮，用于返回原生视图</span></span><br><span class="line">    UIButton *popToHomepageBtn = [UIButton buttonWithType:UIButtonTypeCustom];</span><br><span class="line">    [popToHomepageBtn setFrame:CGRectMake(<span class="number">40</span>, <span class="number">84</span>, <span class="number">150</span>, <span class="number">44</span>)];</span><br><span class="line">    [popToHomepageBtn setBackgroundColor:[UIColor redColor]];</span><br><span class="line">    [popToHomepageBtn setTitle:@<span class="string">&quot;Pop to Homepage&quot;</span> forState:UIControlStateNormal];</span><br><span class="line">    [popToHomepageBtn addTarget:self action:@selector(popToHomepageViewController) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">    [_rootView addSubview:popToHomepageBtn];</span><br><span class="line">    <span class="comment">//add code end</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">// UI hierarchy</span></span><br><span class="line"><span class="comment">//[_window addSubview: _rootView]; //注释window添加Unity主视图</span></span><br><span class="line"><span class="comment">//_window.rootViewController = _rootController;//注释window添加Unity主视图</span></span><br><span class="line">[_window bringSubviewToFront:_rootView];</span><br><span class="line">    [homepageNavigationController pushViewController:_rootController animated:YES]; <span class="comment">//add code，Push Unity主视图</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// why we set level ready only now:</span></span><br><span class="line"><span class="comment">// surface recreate will try to repaint if this var is set (poking unity to do it)</span></span><br><span class="line"><span class="comment">// but this frame now is actually the first one we want to process/draw</span></span><br><span class="line"><span class="comment">// so all the recreateSurface before now (triggered by reorientation) should simply change extents</span></span><br><span class="line"></span><br><span class="line">_unityAppReady = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// why we skip present:</span></span><br><span class="line"><span class="comment">// this will be the first frame to draw, so Start methods will be called</span></span><br><span class="line"><span class="comment">// and we want to properly handle resolution request in Start (which might trigger surface recreate)</span></span><br><span class="line"><span class="comment">// NB: we want to draw right after showing window, to avoid black frame creeping in</span></span><br><span class="line"></span><br><span class="line">_skipPresent = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!UnityIsPaused())</span><br><span class="line">UnityRepaint();</span><br><span class="line"></span><br><span class="line">_skipPresent = <span class="literal">false</span>;</span><br><span class="line">[self repaint];</span><br><span class="line"></span><br><span class="line">[UIView setAnimationsEnabled:YES];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>8、<a name="push-pop-crash"></a>修改<code>UnityAppController+ViewHandling.mm</code>的<code>transitionToViewController:</code>方法解决横屏下Push/Pop问题            </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)transitionToViewController:(UIViewController*)vc</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  注释：只保留 layoutSubviews，</span></span><br><span class="line"><span class="comment">     *  </span></span><br><span class="line"><span class="comment">     *  willTransitionToViewController:fromViewController: 或 更新_rootController 导致Push后黑屏</span></span><br><span class="line"><span class="comment">     *  更换rootViewController导致不能Pop</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="comment">//[self willTransitionToViewController:vc fromViewController:_rootController];</span></span><br><span class="line"><span class="comment">//_rootController = vc;</span></span><br><span class="line"><span class="comment">//_window.rootViewController = vc;</span></span><br><span class="line"></span><br><span class="line">[_rootView layoutSubviews];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li>实现原生为主启动通过改变启动顺序实现</li><li>实现Push/Pop效果添加导航栏，并在相应的地方Push/Pop即可        </li></ul><h3 id="目前存在的问题（已解决，参照8）"><a href="#目前存在的问题（已解决，参照8）" class="headerlink" title="目前存在的问题（已解决，参照8）"></a>目前存在的问题（已解决，<a href="#push-pop-crash">参照8</a>）</h3><ul><li>横屏状态Push，Unity界面黑屏</li><li>竖屏Push到Unity界面，Unity界面切换到横屏时点击Pop界面卡死</li></ul><h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><ul><li>去掉Unity启动界面需要使用非个版的Unity，参考<a href="https://store.unity.com/cn">官方说明-订阅详情-启动画面</a> </li></ul>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Unity </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一本正经的胡说八道</title>
      <link href="/Chats.html"/>
      <url>/Chats.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><blockquote><p>事发不分先后</p></blockquote><p><em>持续更新中…</em>    </p><h2 id="2019年05月"><a href="#2019年05月" class="headerlink" title="2019年05月"></a>2019年05月</h2><p><strong>2019-05-12</strong></p><ul><li>想一出是一出，女人的话不可全信。</li></ul><h2 id="2019年04月"><a href="#2019年04月" class="headerlink" title="2019年04月"></a>2019年04月</h2><p><strong>2019-04-24</strong></p><ul><li>剧透的没啥关系，反正也记不住……</li></ul><h2 id="2019年03月"><a href="#2019年03月" class="headerlink" title="2019年03月"></a>2019年03月</h2><p><strong>2019-03-25</strong></p><ul><li>注意饮食、多运动、多休息，少生气。</li></ul><h2 id="2019年02月"><a href="#2019年02月" class="headerlink" title="2019年02月"></a>2019年02月</h2><p><strong>2019-02-07</strong></p><ul><li>冷静思考，分析局势，选择利弊。</li></ul><h2 id="2019年01月"><a href="#2019年01月" class="headerlink" title="2019年01月"></a>2019年01月</h2><p><strong>2019-01-27</strong></p><ul><li>或许，我应该更坚强一点！</li></ul><p><strong>2019-01-26</strong></p><pre><code>一九二九不出手；三九四九缘凌走；五九半，凌碴散；春打六九头，脱袄换个牛；七九六十三，行人把衣宽；八九不犁地，只待三五日；九九杨花开，以后九不来。</code></pre><p><strong>2019-01-24</strong></p><ul><li>这个年有点凶猛，不好过</li></ul><h2 id="2018年11月"><a href="#2018年11月" class="headerlink" title="2018年11月"></a>2018年11月</h2><p><strong>2018-11-13</strong></p><ul><li>多说无益，做人做事</li></ul><h2 id="2018年8月"><a href="#2018年8月" class="headerlink" title="2018年8月"></a>2018年8月</h2><p><strong>2018-08-18</strong></p><ul><li>一知半解的被摆布，不如潜心研究去主宰</li><li>不抽烟、不喝酒、不赌博、不好色</li></ul><p><strong>2018-01-01</strong></p><ul><li>2017干倒两家，可以、可以</li></ul><span id="more"></span><h2 id="2017年5月"><a href="#2017年5月" class="headerlink" title="2017年5月"></a>2017年5月</h2><p><strong>2017-05-01</strong></p><ul><li>做人不能太好，容易受欺负</li></ul><h2 id="2017年2月"><a href="#2017年2月" class="headerlink" title="2017年2月"></a>2017年2月</h2><p><strong>2017-02-09</strong></p><ul><li>我不是怕你骗我，是担心你被骗！</li><li>没有阅读和健身的习惯，这样不好</li><li>有时候当好人就是当恶人</li></ul><p><strong>2017-02-04</strong></p><ul><li>丁酉年正月初八戍时（晚8点10分多）王家再添一人（八斤）</li></ul><h2 id="2017年1月"><a href="#2017年1月" class="headerlink" title="2017年1月"></a>2017年1月</h2><p><strong>2017-01-14</strong></p><ul><li>个人经验的分享，是误导？是打扰？是增强？ </li></ul><p><strong>2017-01-07</strong></p><ul><li>道不同不相为谋</li></ul><p><strong>2017-01-03</strong></p><ul><li>与小伙伴严重脱节，再不努力就没得玩儿了！</li><li>为了工作不得不离开父母，这是个事儿</li><li>现在已被怀疑能力不足，唯有更加努力</li></ul><p><strong>2017-01-01</strong></p><ul><li>2017目标两个本，有个强健的身体、敏捷的思维！</li></ul><h2 id="2016年12月"><a href="#2016年12月" class="headerlink" title="2016年12月"></a>2016年12月</h2><p><strong>2016-12-22</strong></p><ul><li>人要自重、才会尊重</li><li>供不应求，钱多者得之；供过于求，钱少者得之</li></ul><p><strong>2016-12-22</strong></p><ul><li>如何第一时间获得业内动态，这是个值得思考的问题</li></ul><p><strong>2016-12-13</strong></p><ul><li>For Audi、Dior and Oreo.</li></ul><p><strong>2016-12-02</strong></p><ul><li>帮你是情分、不帮是本分</li><li>斗米养恩，担米养仇</li></ul><p><strong>2016-12-01</strong></p><ul><li>不与XX论短长</li></ul><h2 id="2016年11月"><a href="#2016年11月" class="headerlink" title="2016年11月"></a>2016年11月</h2><p><strong>2016-11-21</strong></p><ul><li>健身房是个好地方</li></ul><p><strong>2016-11-20</strong></p><ul><li>虽然很努力，但是看不到进步也会让人失望的</li></ul><p><strong>2016-11-19</strong></p><ul><li>IQ不高可以用EQ来弥补</li></ul><h2 id="2016年8月"><a href="#2016年8月" class="headerlink" title="2016年8月"></a>2016年8月</h2><p><strong>2016-08-07</strong></p><ul><li>就知道你要闯红灯</li><li>只有在买菜的时候不用在乎价钱</li><li>好(hăo)吃不一定好(hào)吃</li></ul><p><strong>2016-08-06</strong></p><ul><li>站在马路上等公交的人通常有种特异功能，能让公交来的快一些</li></ul>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Chats </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HelloWorld</title>
      <link href="/HelloWorld.html"/>
      <url>/HelloWorld.html</url>
      
        <content type="html"><![CDATA[<p>反馈请联系<a href="mailto:hertz@hertzwang.com"><strong>hertz@hertzwang.com</strong></a>,谢谢</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hello Swift&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSLog</span>(@<span class="string">&quot;Hello Objeict-C&quot;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello C&quot;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">&quot;Hello Java&quot;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hello PHP&quot;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Console.log(<span class="string">&#x27;Hello Web&#x27;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Log.i(<span class="string">&quot;Hello Android&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Print </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
